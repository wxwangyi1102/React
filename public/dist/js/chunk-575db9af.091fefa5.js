(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-575db9af"],{"04d5":function(e,t,a){},5530:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("159b"),a("dbb4");function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}},"68e9":function(e,t,a){"use strict";a("04d5")},"6a9e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ec-container",{attrs:{height:"auto"}},[a("ec-container-header",[a("ec-panel-toolbar",[a("ec-panel-item-left",[a("ec-header",{attrs:{title:"交易衔接量推送",icon:"onetomany","color-code":"003"}})],1),a("ec-panel-item-right",[a("div",[e._v("集中交易年度："+e._s(e.busiYear)+"年")])])],1)],1),a("ec-container-body",[a("ec-panel",[a("ec-panel-toolbar",[a("ec-query-panel",{attrs:{defaultFold:!0},on:{query:e.init,reset:e.resetHandle},scopedSlots:e._u([{key:"inner",fn:function(){return[a("ec-query-item",{attrs:{label:"供方单位"}},[a("select-picker",{attrs:{title:"选择会员单位",lazy:!1,search:!1,fetchData:e.getfetchData},on:{ok:function(t){return e.handlerlockTypeChange(t,"supplyOrgCode")}},model:{value:e.supplyOrgCode,callback:function(t){e.supplyOrgCode=t},expression:"supplyOrgCode"}})],1),a("ec-query-item",{attrs:{label:"需方单位"}},[a("select-picker",{attrs:{title:"选择会员单位",lazy:!1,search:!1,fetchData:e.getfetchData},on:{ok:function(t){return e.handlerlockTypeChange(t,"demandOrgCode")}},model:{value:e.demandOrgCode,callback:function(t){e.demandOrgCode=t},expression:"demandOrgCode"}})],1),a("ec-query-item",{attrs:{label:"烟叶类型"}},[a("a-cascader",{attrs:{options:e.statusValOptions,"change-on-select":"",placeholder:""},on:{change:e.selectedStatusList},model:{value:e.leafTypeCode,callback:function(t){e.leafTypeCode=t},expression:"leafTypeCode"}})],1)]},proxy:!0}])},[a("ec-query-item",{attrs:{label:"业务类型"}},[a("a-cascader",{attrs:{options:e.businessTypeOptions,placeholder:"请选择"},model:{value:e.queryItems.apprTypeCode,callback:function(t){e.$set(e.queryItems,"apprTypeCode",t)},expression:"queryItems.apprTypeCode"}})],1),a("ec-query-item",{attrs:{label:"状态"}},[a("a-select",{attrs:{showSearch:"","allow-clear":"",placeholder:"请选择"},model:{value:e.queryItems.transStates,callback:function(t){e.$set(e.queryItems,"transStates",t)},expression:"queryItems.transStates"}},e._l(e.transStateOptions,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.label)+" ")])})),1)],1),a("ec-query-item",{attrs:{label:"计量单位"}},[a("a-select",{attrs:{"allow-clear":"",placeholder:"请选择"},model:{value:e.weightUnit,callback:function(t){e.weightUnit=t},expression:"weightUnit"}},e._l(e.weightUnitOptionsOptions,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("ec-divider")],1),a("ec-panel-item",[e.islock?a("ec-panel-item-left",[e.pushStatus?a("a-button",{attrs:{type:"primary",loading:""},on:{click:e.handlerPush}},[e._v("推送中")]):a("a-button",{attrs:{type:"primary"},on:{click:e.handlerPush}},[e._v("推送")])],1):e._e()],1),a("ec-panel-body",[a("ec-v-layout",[a("ec-v-item",[a("ec-table",{ref:"xTable1",attrs:{"header-align":"center",align:"center","cell-style":e.cellStyle,"show-overflow":"",height:"580",data:e.tableData,pagination:e.pagination},on:{"page-action":e.queryPagination}},[a("ec-table-col",{attrs:{type:"seq",title:"序号",width:"50"}}),a("ec-table-col",{attrs:{field:"apprTypeCode",title:"衔接类型代码"}}),a("ec-table-col",{attrs:{field:"apprTypeCode",title:"衔接类型"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.findlabel(a.apprTypeCode,e.businessTypeOptions))+" ")]}}])}),a("ec-table-col",{attrs:{field:"leafTypeCode",title:"烟叶类型"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.findlabel(a.leafTypeCode,e.statusValOptions))+" ")]}}])}),a("ec-table-col",{attrs:{field:"leafTypeCode",title:"烟叶代码"}}),a("ec-table-col",{attrs:{field:"leafFormName",title:"衔接量总数"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.handlerWeightcalculate(a.finalWeight,e.weightUnit))+" ")]}}])}),a("ec-table-col",{attrs:{field:"finalWeight",title:"推送记录数"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.handlerWeightcalculate(a.finalWeight,e.weightUnit))+" ")]}}])})],1)],1)],1)],1)],1)],1)],1)},r=[],i=a("c7eb"),l=a("1da1"),o=a("5530"),s=(a("6198"),a("6fc0")),c=a.n(s),u=(a("d3b7"),a("7db0"),a("159b"),a("d81d"),a("caad"),a("a9e3"),a("6ea6")),p={name:"Push",components:{SelectPicker:c.a},data:function(){return{supplyOrgCode:"",demandOrgCode:"",bizCode:"",appCode:"",orgCode:"",orgType:"",weightUnit:"50",leafTypeCode:["10"],islock:!0,pushStatus:!1,statusValOptions:[{value:"10",label:"烤烟"},{value:"20",label:"晾晒烟",children:[{value:"2013",label:"雪茄烟叶"}]}],weightUnitOptionsOptions:[{name:"担",id:"50"},{name:"万担",id:"500000"}],transStateOptions:[{id:"",label:"全部",sendState:""},{id:"0",label:"未推送",sendState:"0"},{id:"1",label:"已推送",sendState:"1"}],businessTypeOptions:[{value:"0",label:"业务类型",children:[{value:"1",label:"购销",children:[{value:"1-1",label:"工商购销",children:[{value:"HT1101",label:"工商普通购销"},{value:"HT1104",label:"基地烟"}]},{value:"1-2",label:"出口备货购销",children:[{value:"HT1201",label:"出口备货普通购销"}]}]}]}],treeData:[],tableData:[],queryItems:{transStates:""},rules:{},pagination:{pageNumber:1,pageSize:10,total:0},treeParams:{bizCode:"11000001000000000000",orgTypeEk:"EXPORT,INDUSTRY,TOBACCO",orgLevelEk:"2",paramMap:{isCorporation:"1"}}}},computed:{_apis:function(){return this.$apis.centre.push},_apply:function(){return this.$apis.centre.apply},appConfig:function(){return this.$store.getters.getAppConfig},busiYear:function(){var e,t;return null===(e=this.$store.getters.getAppConfig)||void 0===e||null===(t=e.yearValueMap)||void 0===t?void 0:t.CENTER_YEAR}},created:function(){this.onInfo()},methods:{init:function(){var e=this,t=Object(o["a"])({},this.queryItems);t.pageNumber=this.pagination.pageNumber,t.pageSize=this.pagination.pageSize,t.busiYear=this.busiYear,!t.transStates&&delete t.transStates,this._apis.query(t).then((function(t){e.tableData=t.rows,e.pagination.total=t.totalRows}))},resetHandle:function(){this.queryItems={},this.init()},handlerPush:function(){var e=this;this.pushStatus=!0;var t={busiYear:this.busiYear};this._apis.onPush(t).then((function(t){t.ifSend?(e.$message.success("推送成功"),e.init()):e.$message.error(t.returnMess)})).finally((function(){e.pushStatus=!1}))},queryPagination:function(e,t){this.queryItems.pageNumber=e,this.queryItems.pageSize=t,this.init()},onInfo:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var a,n,r,l;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apis.bpm.executionEnter.getOrgCode({});case 2:a=t.sent,n=a.orgCode,r=a.orgTypeEk,l=a.bizCode,e.orgCode=n,e.bbizCode=l,e.orgType="TOBACCO"===r?"O":"I",e.treeParams.bizYear=e.busiYear,e.treeGetlist(),e.init();case 12:case"end":return t.stop()}}),t)})))()},treeGetlist:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={pkey:"parentBizCode",title:"orgName",key:"bizCode",children:"children"},e.treeParams.bizCode=e.appConfig.bizCode,t.next=4,e._apply.getreeDate(e.treeParams);case 4:n=t.sent,e.treeData=Object(u["treeFormatList"])(null===n||void 0===n?void 0:n.rows,a);case 6:case"end":return t.stop()}}),t)})))()},getfetchData:function(){var e=this;return new Promise((function(t){var a=Object(u["cloneDeep"])(e.treeData);t(a)}))},handlerlockTypeChange:function(e,t){var a=e.selectOption.val;this.queryItems[t]=a},selectedStatusList:function(e){this.queryItems.leafTypeCode=e[0]},useGetname:function(e){var t,a;return(null===(t=this.treeData)||void 0===t||null===(a=t.find((function(t){return t.key===e})))||void 0===a?void 0:a.title)||""},findlabel:function(e,t){var a;function n(e,t){e.forEach((function(e){return e.value===t?(a=e.label,!1):"children"in e&&void n(e.children,t)}))}return n(t,e),a},handlerWeightcalculate:function(e,t){return e/t},footerMethod:function(e){var t=this,a=e.columns,n=e.data;return[a.map((function(e,a){return 1===a?"合计":["state","state1","state2"].includes(e.property)?t.sumNum(n,e.property):null}))]},sumNum:function(e,t){var a=0;return e.forEach((function(e){a+=Number(e[t])})),a},cellStyle:function(e){var t=e.$columnIndex;if(5===t||6===t)return{textAlign:"right"}}}},d=p,f=(a("68e9"),a("2877")),h=Object(f["a"])(d,n,r,!1,null,"29ce7d93",null);t["default"]=h.exports}}]);
//# sourceMappingURL=chunk-575db9af.091fefa5.js.map