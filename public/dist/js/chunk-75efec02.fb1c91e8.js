(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75efec02"],{dd14:function(e,t,n){var a=n("63748").default,r=n("7ec2").default,i=n("448a").default,l=n("c973").default,c=n("278c").default,s=n("9523").default,o=n("ded3").default;n("99af"),n("a15b"),n("ac1f"),n("841c"),n("b0c0"),n("a9e3"),n("466d"),n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("caad"),n("2532"),n("00b4"),n("d81d"),n("4de4"),n("159b"),n("a630"),n("6062"),n("ac16"),n("f8c9"),function(){"use strict";var t={483:function(e,t,n){function a(e,t,n,a,r,i,l,c){var s,o="function"===typeof e?e.options:e;if(t&&(o.render=t,o.staticRenderFns=n,o._compiled=!0),a&&(o.functional=!0),i&&(o._scopeId="data-v-"+i),l?(s=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(l)},o._ssrRegister=s):r&&(s=c?function(){r.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(o.functional){o._injectStyles=s;var u=o.render;o.render=function(e,t){return s.call(t),u(e,t)}}else{var d=o.beforeCreate;o.beforeCreate=d?[].concat(d,s):[s]}return{exports:e,options:o}}n.d(t,{Z:function(){return a}})},51:function(e,t,n){n.d(t,{H_:function(){return i},Qb:function(){return l}});var a="Ecm",r="$ecm",i=function(e){var t;return null!==(t=null===e||void 0===e?void 0:e.componentPrefix)&&void 0!==t?t:a},l=function(e,t){var n,a=e;t&&t.classPrefix&&(a.prototype[r]=o(o({},null!==(n=a.prototype[r])&&void 0!==n?n:{}),{},{classPrefix:t.classPrefix}))}},338:function(e,t,n){var u;n.d(t,{default:function(){return b}});var d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"select-picker"},[t("a-input-group",{staticClass:"picker-wrapper",attrs:{compact:""}},[t("a-select",{staticClass:"picker-wrapper-select",staticStyle:{width:"200px"},attrs:{value:e.selectedValue,"show-search":"","allow-clear":e.allowClear,placeholder:e.placeholder,mode:e.multiple?"multiple":"default",disabled:e.disabled,"show-arrow":!1,"filter-option":!1,maxTagCount:e.maxTagCount,"default-active-first-option":!1,"not-found-content":e.fetching?void 0:null},on:{search:e.onSelectSearch,change:e.onChange}},[e.fetching?t("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):e._e(),e._l(e.selectOption,(function(n){return t("a-select-option",{key:n[e.valueField],attrs:{title:"".concat(n.title),value:n[e.valueField]}},[e._v(" "+e._s(n.title)+" ")])}))],2),t("div",{staticClass:"picker-btn-wrapper"},[t("a-button",{staticClass:"picker-wrapper-btn",attrs:{icon:"more",disabled:e.disabled},on:{click:e.onOpenModal}})],1)],1),t("a-modal",{attrs:{wrapClassName:"select-picker-modal",title:e.title,visible:e.visible,width:e.widthed,height:e.height,bodyStyle:{height:parseInt(e.height,10)-108+"px"},top:e.top,centered:e.centered,keyboard:!1,"mask-closable":!1},on:{cancel:e.onCancel,ok:e.onOk}},[e.visible?t("SelectTree",{ref:"SelectTree",staticClass:"select-picker-tree",attrs:{lazy:e.lazy,searchPadding:e.searchPadding,join:e.join,search:e.search,treeType:e.treeType,initLevel:e.initLevel,multiple:e.multiple,selectedKeys:e.selectedKeys,expandedKeys:e.expandedKeys,fetchData:e.fetchData,fetchDataById:e.fetchDataById,fetchDataByName:e.fetchDataByName,replaceFields:e.replaceFields,valueField:e.valueField,isShowParent:e.isShowParent,params:e.params},on:{select:e.onSelectTreeData}}):e._e(),Array.isArray(e.selectedKeys)&&e.multiple?t("a-divider",{staticStyle:{height:"100%"},attrs:{type:"vertical"}}):e._e(),Array.isArray(e.selectedKeys)&&e.multiple?t("div",{staticClass:"select-picker-wrap"},[t("div",{staticStyle:{height:"30px","line-height":"30px","font-size":"12px","text-align":"right"}},[e._v(" 已选择："),t("strong",[e._v(e._s(e.selectedKeys.length))]),e._v("项 ")]),t("div",{staticClass:"select-picker-list"},[e._l(e.treeSelectOption,(function(n){return t("div",{key:n.key},[t("a-tag",{key:n.key,attrs:{color:"blue",closable:!0,size:"large"},on:{close:function(t){return e.onRemoveOption(n.key)}}},[e._v(e._s(n.title))])],1)})),!e.selectedKeys||Array.isArray(e.selectedKeys)&&0===e.selectedKeys.length?t("a-empty",{staticClass:"spin"}):e._e()],2)]):e._e()],1)],1)},p=[],f=n(657),h=n(142),y=n(632),m={name:"SelectPicker",components:(u={SelectTree:f["default"]},s(u,h.Modal.name,h.Modal),s(u,h.Tag.name,h.Tag),s(u,h.Input.name,h.Input),s(u,h.Button.name,h.Button),s(u,h.Select.name,h.Select),s(u,h.Row.name,h.Row),s(u,h.Col.name,h.Col),s(u,h.Divider.name,h.Divider),s(u,h.Spin.name,h.Spin),s(u,h.Empty.name,h.Empty),s(u,h.Tree.name,h.Tree),u),model:{prop:"value",event:"change"},props:{value:{type:[String,Array],default:null},treeType:{type:String,default:"sp"},maxTagCount:{type:Number,default:1},placeholder:{type:String,default:"请选择关键词搜索"},lazy:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},searchPadding:{type:String,default:"6px 0"},isShowParent:{type:Boolean,default:!0},allowClear:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},title:{type:String,default:"选择器"},width:{type:[String,Number],default:"425px"},height:{type:[String,Number],default:"370px"},top:{type:[String,Number],default:"100px"},centered:{type:Boolean,default:!1},join:{type:[String,Boolean],default:!1},search:{type:Boolean,default:!0},initLevel:{type:Number,default:2},replaceFields:{type:Object,default:function(){return{pkey:"pkey",title:"title",key:"key",children:"children"}}},beforeOk:{type:Function,default:null},valueField:{type:String,default:"key"},fetchData:{type:Function,required:!0},fetchDataById:{type:Function},fetchDataByName:{type:Function},params:{type:Object,default:function(){return{}}}},data:function(){return this.onSelectSearch=(0,y.debounce)(this.onSelectSearch,300),{visible:!1,fetching:!1,treeData:[],selectedValue:[],expandedKeys:[],selectOption:[],joinSelectOption:[],selectedKeys:[],treeSelectOption:[]}},computed:{widthed:function(){var e=String(this.width).match(/[a-z]+|[^a-z]+/gi),t=c(e,2),n=t[0],a=t[1];return this.multiple?Number(n)+140+a:this.width}},watch:{value:{handler:function(e,t){(0,y.isRefEqual)(e,t)||this.handleListByCode(e)},deep:!0,immediate:!0}},methods:{handleTreeByName:function(e){var t=this;return l(r().mark((function n(){var a,l,c;return r().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.fetching=!0,n.prev=1,!t.lazy){n.next=10;break}return n.next=5,t.fetchDataByName(o(o({},t.params),{},{name:e}),e);case 5:a=n.sent,l=(0,y.filterList)(a,(function(t){return String(null===t||void 0===t?void 0:t.title).indexOf(e)>-1}),t.replaceFields),t.selectOption=(0,y.uniqueBy)([].concat(i(t.selectOption),i(l)),"key"),n.next=14;break;case 10:return n.next=12,t.fetchData(o({},t.params));case 12:c=n.sent,t.treeData=(0,y.listFormatTree)(c,t.replaceFields),t.selectOption=(0,y.filterList)(c,(function(t){return String(null===t||void 0===t?void 0:t.title).indexOf(e)>-1}),t.replaceFields);case 14:n.next=18;break;case 16:n.prev=16,n.t0=n["catch"](1);case 18:t.fetching=!1;case 19:case"end":return n.stop()}}),n,null,[[1,16]])})))()},handleListByCode:function(e){var t=this;return l(r().mark((function n(){var l,c,s,u,d,p,f,h,m,v;return r().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(l=[],!e){n.next=25;break}if(l=Array.isArray(e)?e:[e],t.fetching=!0,n.prev=3,!t.lazy){n.next=16;break}c=[],s=a(l);try{for(s.s();!(u=s.n()).done;)d=u.value,d&&c.push(t.fetchDataById(o(o({},t.params),{},{code:d}),e))}catch(r){s.e(r)}finally{s.f()}return n.next=10,Promise.all(c);case 10:p=n.sent,f=(0,y.flattenDeep)(p),h=(0,y.filterList)(f,(function(e){return l.includes(e.key)}),t.replaceFields),t.selectOption=(0,y.uniqueBy)(h),t.treeSelectOption=(0,y.cloneDeep)(t.selectOption),n.next=21;break;case 16:return n.next=18,t.fetchData(o({},t.params));case 18:m=n.sent,v=(0,y.uniqueBy)(m),t.treeData=(0,y.listFormatTree)(v,t.replaceFields),t.selectOption=(0,y.filterList)(v,(function(t){return String(null===t||void 0===t?void 0:t.key).indexOf(e)>-1}),t.replaceFields);case 21:n.next=25;break;case 23:n.prev=23,n.t0=n["catch"](3);case 25:t.selectedValue=i(l),t.selectedKeys=i(l),t.fetching=!1;case 26:case"end":return n.stop()}}),n,null,[[3,23]])})))()},handleReturnValue:function(e){return Array.isArray(e)&&this.multiple?e:Array.isArray(e)&&0!==e.length?e[0]:Array.isArray(e)&&0===e.length?this.multiple?e:null:e},onSelectSearch:function(e){/^\s*$/.test(e)||this.handleTreeByName(e)},onChange:function(e,t){var n=this;if(this.join){var a=this.selectOption.map((function(e){var t={};for(var a in e)a&&(t[a]=(0,y.getSelectedBy)(n.treeData,e.key,a,n.replaceFields).join("string"===typeof n.join?n.join:","));return t}));Object.assign(this,{joinSelectOption:a})}this.$emit("change",e,t)},onOpenModal:function(){this.visible=!0},onScrollIntoView:function(e){var t=this;this.$nextTick((function(){t.$ref.SelectTree.onScrollIntoView(e)}))},onSelectTreeData:function(e){var t=e.treeSelectedKeys,n=e.treeData,a=e.selectOption,r=e.joinSelectOption;Array.isArray(t)?this.selectedKeys=t:this.$set(this.selectedKeys,"0",t),Array.isArray(a)?this.treeSelectOption=a:this.$set(this.treeSelectOption,"0",a),Object.assign(this,{joinSelectOption:r,treeData:n})},onRemoveOption:function(e){this.selectedKeys=this.selectedKeys.filter((function(t){return t!==e})),this.treeSelectOption=this.treeSelectOption.filter((function(t){return t.key!==e})),this.onScrollIntoView(e)},onOk:function(){var e=this;if(null===this.selectedKeys||Array.isArray(this.selectedKeys)&&0===this.selectedKeys.length)return this.$message.info("请先选择单位");Object.assign(this,{selectedValue:this.selectedKeys,selectOption:this.treeSelectOption}),this.$nextTick(l(r().mark((function t(){var n,a;return r().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.handleReturnValue(e.selectOption),a=e.handleReturnValue(e.selectedValue),t.t0=e.beforeOk&&"function"===typeof e.beforeOk,!t.t0){t.next=5;break}return t.next=5,e.beforeOk({selectedValue:a,selectOption:n,joinSelectOption:e.joinSelectOption,treeData:e.treeData});case 5:e.visible=!1,e.$emit("change",a,n),e.$emit("ok",{selectedValue:a,selectOption:n,joinSelectOption:e.joinSelectOption,treeData:e.treeData});case 8:case"end":return t.stop()}}),t)}))))},onCancel:function(){this.visible=!1},onRefreshTree:function(e){this.$ref.SelectTree&&this.$ref.SelectTree.handleTreeData(e)}}},v=m,S=n(483),g=(0,S.Z)(v,d,p,!1,null,null,null),k=g.exports,x=n(51);k.install=function(e,t){(0,x.Qb)(e,t);var n=(0,x.H_)(t);e.component(n+k.name,k)};var b=k},657:function(e,t,n){var c;n.d(t,{default:function(){return k}});var u=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tree-search"},[e._t("title"),e.isSearch?t("div",{staticClass:"tree-search-select",style:{padding:e.searchPadding}},[t("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"",value:e.selectedValue,placeholder:e.placeholder,"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":null},on:{search:e.onSelectSearch,select:e.onSelectChange,rightClick:e.oRightClick}},e._l(e.selectOption,(function(n){return t("a-select-option",{key:n.key,attrs:{value:n.key,title:"".concat(n.title)}},[t("a-row",[t("a-col",{staticClass:"ellipsis",attrs:{span:e.isShowParent?18:24,title:n.title}},[e._v(e._s(n.title))]),t("a-col",{staticClass:"ellipsis",staticStyle:{color:"#ccc","font-size":"12px"},attrs:{span:e.isShowParent?6:0,title:e.getNameBy(e.tmpSearchOption,n.pkey)}},[e._v(e._s(e.getNameBy(e.tmpSearchOption,n.pkey)))])],1)],1)})),1)],1):e._e(),e.isSearch?t("a-divider",{staticStyle:{margin:"8px 0"}}):e._e(),t("div",{staticClass:"tree-search-tree"},[t("a-spin",{staticClass:"spin",attrs:{spinning:e.fetching}}),e.lazy?t("a-tree",e._b({ref:"treeRef",attrs:{blockNode:!0,multiple:e.multiple,checkedKeys:e.treeCheckedKeys,checkable:e.checkable,selectable:e.selectable,expandedKeys:e.treeExpandedKeys,selectedKeys:e.treeSelectedKeys,loadedKeys:e.treeLoadedKeys,"tree-data":e.treeData,loadData:e.handleLoadLazyData},on:{select:e.onSelectTree,check:e.onCheckTree,expand:e.onExpandTree,load:e.onLazyLoad,rightClick:e.oRightClick},scopedSlots:e._u([{key:"title",fn:function(n){return[t("span",{attrs:{id:"".concat(e.treeType,"_").concat(n.key)}},[e._v(e._s(n.title))]),e._t("action",null,{action:n})]}}],null,!0)},"a-tree",e.$attrs,!1)):t("a-tree",e._b({ref:"treeRef",attrs:{blockNode:!0,checkable:e.checkable,selectable:e.selectable,multiple:e.multiple,checkedKeys:e.treeCheckedKeys,expandedKeys:e.treeExpandedKeys,selectedKeys:e.treeSelectedKeys,"tree-data":e.treeData,replaceFields:e.replaceFields},on:{select:e.onSelectTree,check:e.onCheckTree,expand:e.onExpandTree},scopedSlots:e._u([{key:"title",fn:function(n){return[t("span",{attrs:{id:"".concat(e.treeType,"_").concat(n.key)}},[e._v(e._s(n.title))]),e._t("action",null,{action:n})]}}],null,!0)},"a-tree",e.$attrs,!1)),e.fetching||e.treeData&&(!Array.isArray(e.treeData)||0!==e.treeData.length)?e._e():t("a-empty",{staticClass:"spin"})],1)],2)},d=[],p=n(632),f=n(142),h={inheritAttrs:!1,name:"SelectTree",components:(c={},s(c,f.Select.name,f.Select),s(c,f.Row.name,f.Row),s(c,f.Col.name,f.Col),s(c,f.Divider.name,f.Divider),s(c,f.Spin.name,f.Spin),s(c,f.Empty.name,f.Empty),s(c,f.Tree.name,f.Tree),c),props:{treeType:{type:String,default:"st"},selectedKeys:{type:Array,default:null},checkedKeys:{type:Array,default:null},expandedKeys:{type:Array,default:null},lazy:{type:Boolean,default:!0},selectable:{type:Boolean,default:!0},checkable:{type:Boolean,default:!1},searchPadding:{type:String,default:"12px 12px 6px"},placeholder:{type:String,default:"请输入关键词筛选"},multiple:{type:Boolean,default:!1},join:{type:[String,Boolean],default:","},isShowParent:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{pkey:"pkey",title:"title",key:"key",children:"children"}}},search:{type:Boolean,default:!0},activeFirst:{type:Boolean,default:!1},beforeSelect:{type:Function,default:null},beforeCheck:{type:Function,default:null},initLevel:{type:Number,default:2},fetchData:{type:Function,required:!0},fetchDataById:{type:Function},fetchDataByName:{type:Function},valueField:{type:String,default:"key"},params:{type:Object,default:function(){return{}}}},data:function(){return this.onSelectSearch=(0,p.debounce)(this.onSelectSearch,500),{fetching:!1,selectedValue:void 0,treeCheckedKeys:[],treeSelectedKeys:[],treeExpandedKeys:[],treeLoadedKeys:[],treeData:[],selectOption:[],tmpSearchOption:[]}},computed:{isSearch:function(){return this.search&&(this.treeData||Array.isArray(this.treeData)&&0!==this.treeData.length)}},watch:{params:{handler:function(e,t){(0,p.isRefEqual)(e,t)||this.handleTreeData(e)},deep:!0,immediate:!0},checkedKeys:{handler:function(e){this.treeCheckedKeys=e},deep:!0,immediate:!0},selectedKeys:{handler:function(e){this.treeSelectedKeys=e},deep:!0,immediate:!0},expandedKeys:{handler:function(e){this.treeExpandedKeys=e},deep:!0,immediate:!0}},methods:{getNameBy:p.getNameBy,handleTreeData:function(e){var t=this;this.fetching=!0,this.treeLoadedKeys=[],this.treeExpandedKeys=[],this.treeData=[];try{this.fetchData(e).then(function(){var e=l(r().mark((function e(n){var a,i,l;return r().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=(0,p.cloneDeep)(n).filter((function(e){return!e.pkey}))[0],t.treeData=(0,p.listFormatTree)(n,t.replaceFields),i=n.map((function(e){return e.key})).filter((function(e){return e})),l=(t.selectedKeys||[]).filter((function(e){return!i.includes(e)})),Array.isArray(t.treeData)&&0!==t.treeData.length&&(t.treeExpandedKeys=[a.key],t.$emit("expand",t.treeExpandedKeys),t.activeFirst&&t.onSelectTreeFn(a.key)),e.t0=0!==l.length,!e.t0){e.next=8;break}return e.next=8,t.handleTreeByCode(l);case 8:Array.isArray(t.treeSelectedKeys)&&0!==t.treeSelectedKeys.length&&setTimeout((function(){t.onScrollIntoView(t.treeSelectedKeys[0])}),500);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){t.fetching=!1}))}catch(n){this.treeData=[]}},handleTreeByCode:function(e){var t=this;return l(r().mark((function n(){var l,c,s,u,d,f,h,y,m,v,S,g;return r().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(l=Array.isArray(e)?e:[e],t.fetching=!0,n.prev=2,!t.lazy){n.next=20;break}c=[],s=a(l);try{for(s.s();!(u=s.n()).done;)d=u.value,d&&c.push(t.fetchDataById(o(o({},t.params),{},{code:d})))}catch(r){s.e(r)}finally{s.f()}return n.next=9,Promise.all(c);case 9:if(f=n.sent,h=(0,p.treeFormatList)(t.treeData,t.replaceFields),y=(0,p.flattenDeep)(f),m=h.map((function(e){return e.key})).filter((function(e){return e})),v=y.filter((function(e){return!m.includes(e.key)})),S=v.map((function(e){return e.pkey})),g=(0,p.uniqueBy)(S),n.t0=0!==g.length,!n.t0){n.next=20;break}return n.next=20,t.handleLoadMore(g);case 20:l.forEach((function(e){var n=(0,p.getExpandedKeys)(t.treeData,e,t.replaceFields);t.treeExpandedKeys=Array.from(new Set([].concat(i(n),i(t.treeExpandedKeys))))})),n.next=25;break;case 23:n.prev=23,n.t1=n["catch"](2);case 25:t.fetching=!1;case 26:case"end":return n.stop()}}),n,null,[[2,23]])})))()},handleLoadMore:function(e){var t=this;return l(r().mark((function n(){var l,c,s,u,d,f,h,y;return r().wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.fetching=!0,l=[],c=a(e);try{for(c.s();!(s=c.n()).done;)u=s.value,u&&l.push(t.fetchData(o(o({},t.params),{},{code:u})))}catch(r){c.e(r)}finally{c.f()}return n.next=6,Promise.all(l);case 6:d=n.sent,f=(0,p.flattenDeep)(d),h=(0,p.treeFormatList)(t.treeData),y=(0,p.uniqueBy)([].concat(i(h),i(f))),t.treeData=(0,p.listFormatTree)(y,t.replaceFields),t.fetching=!1;case 11:case"end":return n.stop()}}),n)})))()},handleLoadLazyData:function(e){var t=this,n=e;return new Promise((function(e){n.dataRef.children?e():t.fetchData(o(o({},t.params),{},{code:n.dataRef.key})).then((function(a){var r=(0,p.uniqueBy)(a,"key");n.dataRef.children=i(r),t.treeData=i(t.treeData),e(r)})).finally((function(){t.fetching=!1}))}))},onSelectSearch:function(e){/^\s*$/.test(e)||(this.handlerSearch(e),this.$emit("search",e))},handlerSearch:function(e){var t=this;return l(r().mark((function n(){var a,i;return r().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.lazy){n.next=8;break}return n.next=3,t.fetchDataByName(o(o({},t.params),{},{name:e})).catch((function(e){}));case 3:a=n.sent,i=(0,p.uniqueBy)(a,"key"),t.tmpSearchOption=(0,p.cloneDeep)(i)||[],t.selectOption=i.filter((function(t){return String(null===t||void 0===t?void 0:t.title).indexOf(e)>-1})),n.next=9;break;case 8:t.selectOption=(0,p.filterList)(t.treeData,(function(t){return String(null===t||void 0===t?void 0:t.title).indexOf(e)>-1}),t.replaceFields);case 9:case"end":return n.stop()}}),n)})))()},handleReturnValue:function(e){return Array.isArray(e)&&this.multiple?e:Array.isArray(e)&&0!==e.length?e[0]:Array.isArray(e)&&0===e.length?this.multiple?e:null:e},onSelectChange:function(e){var t=this;return l(r().mark((function n(){var a,l,c,s,o,u,d,f;return r().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(l=Array.isArray(e)?e:[e],c=(0,p.cloneDeep)(t.selectOption).filter((function(e){return l.includes(e.key)})),!t.lazy){n.next=7;break}if(s=(0,p.treeFormatList)(t.treeData,t.replaceFields),o=s.map((function(e){return e.key})).filter((function(e){return e})),u=t.tmpSearchOption.filter((function(e){return!o.includes(e.key)})),d=u.map((function(e){return e.pkey})),n.t0=0!==d.length,!n.t0){n.next=7;break}return n.next=7,t.handleLoadMore(d);case 7:f=(0,p.getExpandedKeys)(t.treeData,Array.isArray(e)&&0!==e.length?e[0]:e,t.replaceFields),t.multiple?!t.treeSelectedKeys.includes(l)&&(a=t.treeSelectedKeys).push.apply(a,i(l)):t.treeSelectedKeys=l,Object.assign(t,{selectedValue:l,treeExpandedKeys:f,selectOption:c,fetching:!1}),t.onSelectTreeFn(e);case 9:case"end":return n.stop()}}),n)})))()},onExpandTree:function(e,t){this.treeExpandedKeys=Array.isArray(e)?e:[e],this.$emit("expand",this.treeExpandedKeys,t)},onSelectTreeFn:function(e){var t=this;return l(r().mark((function n(){var a,l,c,s,o,u,d,f,h;return r().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=Array.isArray(e)?e:[e],l=Array.isArray(e)&&0!==e.length?e[0]:e,c=(0,p.treeFormatList)(t.treeData,t.replaceFields),s=c.map((function(e){return e.key})).filter((function(e){return e})),s.includes(l)){n.next=11;break}return n.next=4,t.fetchDataById({code:l});case 4:return o=n.sent,n.next=7,(0,p.uniqueBy)([].concat(i(c),i(o)));case 7:return u=n.sent,n.next=10,(0,p.listFormatTree)(u);case 10:t.treeData=n.sent;case 11:d=(0,p.getNodeBy)(t.treeData,l),f=(0,p.getExpandedKeys)(t.treeData,l),h=Array.from(new Set(t.multiple?[].concat(i(t.treeSelectedKeys),i(a)):a)),t.expandedKeys=[].concat(i(t.expandedKeys),i(f)),t.onSelectTree(h,{event:"select",selected:!0,node:{dataRef:d}});case 13:case"end":return n.stop()}}),n)})))()},onScrollIntoView:function(e){var t=this;this.$nextTick((function(){var n,a,r=document.querySelector(".select-picker-modal");r?null===(n=document.querySelector(".select-picker-modal #".concat(t.treeType,"_").concat(e)))||void 0===n||n.scrollIntoView({behavior:"smooth",block:"center"}):null===(a=document.getElementById("".concat(t.treeType,"_").concat(e)))||void 0===a||a.scrollIntoView({behavior:"smooth",block:"center"})}))},onSelectTree:function(e,t){var n=this;return l(r().mark((function a(){var i,l,c,s,o,u,d,f;return r().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.t0=n.beforeSelect,!a.t0){a.next=4;break}return a.next=4,n.beforeSelect(e,t);case 4:i=Array.isArray(e)?e:[e],l=t.node.dataRef.key,Object.assign(n,{treeSelectedKeys:i}),c=(0,p.uniqueBy)((0,p.filterList)(n.treeData,(function(e){return n.treeSelectedKeys.includes(e.key)}),n.replaceFields)),s=[],n.join&&(s=c.map((function(e){var t={};for(var a in e)a&&(t[a]=(0,p.getSelectedBy)(n.treeData,l,a,n.replaceFields).join("string"===typeof n.join?n.join:","));return t}))),o=c.map((function(e){return e[n.valueField]})),u=n.handleReturnValue(o),d=n.handleReturnValue(c),f=n.handleReturnValue(s),n.$emit("select",{treeSelectedKeys:u,selectOption:d,joinSelectOption:f,treeData:(0,p.cloneDeep)(n.treeData)},t),Array.isArray(n.selectedValue)&&0!==n.selectedValue.length&&n.selectedValue[0]!==l&&(n.selectedValue=void 0,n.selectOption=[]),n.onScrollIntoView(l);case 11:case"end":return a.stop()}}),a)})))()},onCheckTree:function(e,t){var n=this;return l(r().mark((function a(){var i,l,c,s;return r().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.t0=n.beforeCheck,!a.t0){a.next=4;break}return a.next=4,n.beforeCheck(e,t);case 4:i=Array.isArray(e)?e:[e],l=t.node.dataRef.key,Object.assign(n,{treeCheckedKeys:i}),c=(0,p.uniqueBy)((0,p.filterList)(n.treeData,(function(e){return n.treeCheckedKeys.includes(e.key)}),n.replaceFields)),s=c.map((function(e){return e[n.valueField]})),n.$emit("check",{treeCheckedKeys:s,checkOption:c,treeData:(0,p.cloneDeep)(n.treeData)},t),Array.isArray(n.selectedValue)&&0!==n.selectedValue.length&&n.selectedValue[0]!==l&&(n.selectedValue=void 0,n.selectOption=[]),n.onScrollIntoView(l);case 8:case"end":return a.stop()}}),a)})))()},oRightClick:function(e){this.$emit("rightClick",e)},onLazyLoad:function(e){this.treeLoadedKeys=e}}},y=h,m=n(483),v=(0,m.Z)(y,u,d,!1,null,null,null),S=v.exports,g=n(51);S.install=function(e,t){(0,g.Qb)(e,t);var n=(0,g.H_)(t);e.component(n+S.name,S)};var k=S},632:function(e){e.exports=n("6ea6")},142:function(e){e.exports=n("f23d")}},u={};function d(e){var n=u[e];if(void 0!==n)return n.exports;var a=u[e]={exports:{}};return t[e](a,a.exports,d),a.exports}!function(){d.d=function(e,t){for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){d.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}();var p={};!function(){d.d(p,{default:function(){return f}});var e=function(){var e=this,t=e._self._c;return t("SelectPicker",e._g(e._b({attrs:{treeType:"orp",title:e.title,value:e.value,search:e.search,"allow-clear":e.allowClear,placeholder:e.placeholder,multiple:e.multiple,join:e.join,disabled:e.disabled,valueField:e.valueField,fetchData:e.fetchGetTree,fetchDataById:e.fetchGetTreeById,fetchDataByName:e.fetchGetTreeByName,params:e.params}},"SelectPicker",e.$attrs,!1),e.$listeners))},t=[],n=d(338),a=d(632),r={inheritAttrs:!1,name:"OrgPicker",components:{SelectPicker:n["default"]},model:{prop:"value",event:"change"},props:{value:{type:[String,Array,null],default:null},baseUrl:{type:String,default:"/dts/bim"},treeApi:{type:String,default:"/q/cmTOrgMain/getCmTOrgMainTreeDataList/v1"},treeApiById:{type:String,default:"/q/cmTOrgMain/getCmTOrgMainTreeParentByOrgUniqueCode/v1"},treeApiByName:{type:String,default:"/q/cmTOrgMain/getCmTOrgMainTreeParentByOrgName/v1"},placeholder:{type:String,default:"请选择关键词搜索"},multiple:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},title:{type:String,default:"组织机构选择器"},search:{type:Boolean,default:!0},width:{type:[String,Number],default:"425px"},height:{type:[String,Number],default:"370px"},top:{type:[String,Number],default:"100px"},centered:{type:Boolean,default:!1},initLevel:{type:[Number,null],default:2},limitLevel:{type:[Number,String,null],validator:function(e){return[1,2,3,4,5,6].includes(Number(e))},default:null},replaceFields:{type:Object,default:function(){return{pkey:"pkey",title:"title",key:"key",children:"children"}}},valueField:{type:String,default:"key"},join:{type:[String,Boolean],default:!1},lazy:{type:Boolean,default:!0},params:{type:Object,default:function(){}}},methods:{fetchGetTree:function(e){var t=this;return new Promise((function(n,r){var i=null===e||void 0===e?void 0:e.code;i&&Reflect.deleteProperty(e,"code"),$ec.http.send(t.baseUrl+t.treeApi,o({orgLevelNum:t.limitLevel,bizCode:i},e)).then((function(e){var r=e.rows,i=(0,a.treeFormatList)(r,t.replaceFields);n(i)})).catch((function(e){r(e)})).finally((function(){}))}))},fetchGetTreeById:function(e){var t=this;return new Promise((function(n,r){var i=null===e||void 0===e?void 0:e.code;i&&Reflect.deleteProperty(e,"code"),$ec.http.send(t.baseUrl+t.treeApiById,o({orgLevelNum:t.limitLevel,bizCode:i},e)).then((function(e){var r=e.rows,i=(0,a.treeFormatList)(r,t.replaceFields);n(i)})).catch((function(e){r(e)})).finally((function(){}))}))},fetchGetTreeByName:function(e){var t=this;return new Promise((function(n,r){var i=null===e||void 0===e?void 0:e.name;i&&Reflect.deleteProperty(e,"name"),$ec.http.send(t.baseUrl+t.treeApiByName,o({orgLevelNum:t.limitLevel,orgName:i},e)).then((function(e){var r=e.rows,i=(0,a.treeFormatList)(r,t.replaceFields);n(i)})).catch((function(e){r(e)})).finally((function(){}))}))}}},i=r,l=d(483),c=(0,l.Z)(i,e,t,!1,null,null,null),s=c.exports,u=d(51);s.install=function(e,t){(0,u.Qb)(e,t);var n=(0,u.H_)(t);e.component(n+s.name,s)};var f=s}(),e.exports=p["default"]}()},e906:function(e,t,n){}}]);
//# sourceMappingURL=chunk-75efec02.fb1c91e8.js.map