(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b61cc472"],{"1ebe":function(e,t,a){},"370e":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ec-container",{staticClass:"info",attrs:{height:"100%","color-code":"001",title:"基地单元衔接","show-title":""}},[a("ec-container-body",[a("ec-panel",{attrs:{auto:!1}},[a("ec-panel-toolbar",[a("ec-query-panel",{attrs:{defaultFold:!0},on:{query:e.onQuery,reset:e.resetHandle}},[a("ec-query-item",{attrs:{label:"单元属性"}},[a("ec-select",{attrs:{showSearch:"",allowClear:"",placeholder:"请选择单元属性"},model:{value:e.query.unitProp,callback:function(t){e.$set(e.query,"unitProp","string"===typeof t?t.trim():t)},expression:"query.unitProp"}},e._l(e.unitPropList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("ec-query-item",{attrs:{label:"状态"}},[a("ec-select",{attrs:{showSearch:"",allowClear:"",placeholder:"请选择状态"},model:{value:e.query.billState,callback:function(t){e.$set(e.query,"billState","string"===typeof t?t.trim():t)},expression:"query.billState"}},e._l(e.billStateList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("ec-query-item",{attrs:{label:"基地单元名称"}},[a("a-input",{attrs:{placeholder:"请输入基地单元名称"},model:{value:e.query.baseCellName,callback:function(t){e.$set(e.query,"baseCellName","string"===typeof t?t.trim():t)},expression:"query.baseCellName"}})],1)],1),a("ec-divider")],1),a("ec-panel-body",[a("ec-v-layout",{attrs:{auto:!1}},[a("ec-v-item",{attrs:{height:"auto"}},[a("ec-panel-toolbar",[a("ec-panel-item-left",[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleUpdate("ADD")}}},[e._v("新建单元")]),a("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(t){return e.handleUpdate("EXISTING")}}},[e._v(" 已有单元 ")]),a("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.onDelete}},[e._v(" 删除 ")])],1),a("ec-panel-item-right",[a("div",{staticClass:"unit-box"},[a("span",[e._v("集中交易年度："+e._s(e.busiYear)+"年")]),a("div",{staticClass:"select"},[e._v(" 重量单位： "),a("ec-select",{attrs:{showSearch:""},model:{value:e.weightUnit,callback:function(t){e.weightUnit="string"===typeof t?t.trim():t},expression:"weightUnit"}},e._l(e.weightUnitList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("div",{staticClass:"select"},[e._v(" 面积单位： "),a("ec-select",{attrs:{showSearch:""},model:{value:e.areaUnit,callback:function(t){e.areaUnit="string"===typeof t?t.trim():t},expression:"areaUnit"}},e._l(e.areaUnitList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1)])])],1)],1),a("ec-v-item",{attrs:{height:"auto"}},[a("div",{staticClass:"side-info"},[a("p",[a("strong",[e._v("辅助信息")]),e._v("国家局设置新建单元数据为："),a("strong",[e._v(e._s(e.auxiliaryInfo.baseUnitCnt))]),e._v("个，已增加："),a("strong",[e._v(e._s(e.auxiliaryInfo.baseUnitCntSet))]),e._v("个，剩余："),a("strong",[e._v(e._s(e.auxiliaryInfo.baseUnitCntUnSet))]),e._v("个。 ")])])]),a("ec-v-item",[a("ec-table",{ref:"tableRef",attrs:{loading:e.loading,"show-overflow":"",height:"100%",auto:!1,pagination:e.pagination,data:e.tableData},on:{"page-action":e.queryHandle,"checkbox-all":e.onSelAllTableData,"checkbox-change":e.onSelTableData}},[a("ec-table-col",{attrs:{type:"checkbox",width:"60",align:"center"}}),a("ec-table-col",{attrs:{type:"seq",title:"序号",width:"50",align:"center"}}),a("ec-table-col",{attrs:{field:"linkInduProvOrgName",title:"省级工业公司","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"linkInduOrgName",title:"对口工业企业","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"provOrgName",title:"省公司","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"cityOrgName",title:"市公司","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"provDivisionName",title:"省","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"cityDivisionName",title:"地(州、市)","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"counDivisionName",title:"县(区、市)","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"baseCellCode",title:"基地单元编码","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"baseCellName",title:"基地单元名称","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"brandName",title:"品牌","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"leafTypeCode",title:"烟叶类型","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(" "+e._s(e._f("getNameBy")(i.leafTypeCode,e.leafTypeObj))+" ")])]}}])}),a("ec-table-col",{attrs:{field:"leafVarietyCode",title:"烟叶品种","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(" "+e._s(e._f("getNameBy")(i.leafVarietyCode,e.leftVarietyObj))+" ")])]}}])}),a("ec-table-col",{attrs:{field:"fieldArea",title:"基本烟田面积","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.fieldArea,e.areaUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"plantArea",title:"种植面积","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.plantArea,e.areaUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"buyWeight",title:"收购量","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.buyWeight,e.weightUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"techSuppOrg",title:"技术依托单位","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"unitProp",title:"单元属性","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(" "+e._s(e._f("getNameBy")(i.unitProp,e.unitPropList,{key:"enumKey",label:"name"}))+" ")])]}}])}),a("ec-table-col",{attrs:{field:"linkUpState",title:"衔接状态",width:"100",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(" "+e._s(e._f("getNameBy")(i.linkUpState,e.linkUpStateObj))+" ")])]}}])}),a("ec-table-col",{attrs:{field:"billState",title:"状态",width:"100",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(" "+e._s(e._f("getNameBy")(i.billState,e.billStateObj))+" ")])]}}])}),a("ec-table-col",{attrs:{title:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("a-button",{attrs:{type:"link"},on:{click:function(t){return e.handleDetail(i)}}},[e._v("详情")])]}}])})],1)],1)],1)],1)],1),a("business-org-manage-edit",{ref:"editRef",attrs:{busiYear:e.busiYear,auxiliaryInfo:e.auxiliaryInfo,weightUnitList:e.weightUnitList,areaUnitList:e.areaUnitList,weightUnit:e.weightUnit,areaUnit:e.areaUnit,leafTypeList:e.leafTypeList,linkUpStateList:e.linkUpStateList,userInfo:e.appConfig,businessOrgList:e.businessOrgList},on:{saved:e.onQuery}}),a("detail-modal",{ref:"detailModalRef",attrs:{busiYear:e.busiYear,leafTypeList:e.leafTypeList,userInfo:e.appConfig}})],1)],1)},r=[],l=a("c7eb"),n=a("1da1"),o=a("5530"),s=(a("d81d"),a("b0c0"),a("d3b7"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ec-drawer",{attrs:{title:e.title,visible:e.visible,size:"large","is-confirm":!0},on:{close:e.handleCancel}},[a("div",{staticClass:"unit-box"},[a("div",[e._v(" 重量单位: "),a("ec-select",{attrs:{showSearch:""},model:{value:e.weightUnit,callback:function(t){e.weightUnit="string"===typeof t?t.trim():t},expression:"weightUnit"}},e._l(e.weightUnitList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("div",[e._v(" 面积单位: "),a("ec-select",{attrs:{showSearch:""},model:{value:e.areaUnit,callback:function(t){e.areaUnit="string"===typeof t?t.trim():t},expression:"areaUnit"}},e._l(e.areaUnitList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1)]),a("ec-container",{directives:[{name:"show",rawName:"v-show",value:0===e.steps,expression:"steps === 0"}],attrs:{height:"100%"}},[a("ec-container-body",[a("ec-panel",{attrs:{auto:!1}},[a("ec-panel-toolbar",[a("ec-query-panel",{attrs:{defaultFold:!0},on:{query:e.onQuery,reset:e.resetHandle},scopedSlots:e._u([{key:"inner",fn:function(){return["EXISTING"===e.type?a("ec-query-item",{attrs:{label:"合作关系"}},[a("ec-select",{attrs:{showSearch:"",placeholder:"请选择合作关系"},model:{value:e.query.linkUpState,callback:function(t){e.$set(e.query,"linkUpState","string"===typeof t?t.trim():t)},expression:"query.linkUpState"}},e._l(e.linkUpStateList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1):e._e(),"EXISTING"===e.type?a("ec-query-item",{attrs:{label:"创建年度"}},[a("a-input-number",{attrs:{precision:1,max:e.busiYear,placeholder:"请输入创建年度"},model:{value:e.query.createYear,callback:function(t){e.$set(e.query,"createYear","string"===typeof t?t.trim():t)},expression:"query.createYear"}})],1):e._e()]},proxy:!0}])},[a("ec-query-item",{attrs:{label:"集中交易年度"}},[a("a-input-number",{attrs:{placeholder:"请输入集中交易年度",disabled:""},model:{value:e.query.busiYear,callback:function(t){e.$set(e.query,"busiYear","string"===typeof t?t.trim():t)},expression:"query.busiYear"}})],1),a("ec-query-item",{attrs:{label:"商业单位"}},[a("select-picker",{attrs:{title:"选择商业单位",placeholder:"请输入商业单位",lazy:!1,search:!1,fetchData:e.onFetchBusinessOrgList},model:{value:e.query.businesOrgCode,callback:function(t){e.$set(e.query,"businesOrgCode",t)},expression:"query.businesOrgCode"}})],1),a("ec-query-item",{attrs:{label:"基地单元名称"}},[a("a-input",{attrs:{placeholder:"请输入基地单元名称"},model:{value:e.query.baseCellName,callback:function(t){e.$set(e.query,"baseCellName","string"===typeof t?t.trim():t)},expression:"query.baseCellName"}})],1)],1),a("ec-divider")],1),a("ec-panel-body",[a("ec-v-layout",{attrs:{auto:!1}},[a("ec-v-item",{attrs:{height:"auto"}},[a("div",{staticClass:"side-info"},[a("p",[a("strong",[e._v("辅助信息")]),e._v("国家局设置新建单元数据为："),a("strong",[e._v(e._s(e.auxiliaryInfo.baseUnitCnt))]),e._v("个，已增加："),a("strong",[e._v(e._s(e.auxiliaryInfo.baseUnitCntSet))]),e._v("个，剩余："),a("strong",[e._v(e._s(e.auxiliaryInfo.baseUnitCntUnSet))]),e._v("个。 ")])])]),a("ec-v-item",[a("ec-table",{ref:"tableRef",attrs:{loading:e.loading,height:"100%",auto:!1,"show-overflow":"",pagination:e.pagination,data:e.tableData,"highlight-current-row":""},on:{"page-action":e.queryHandle,"current-change":e.currentChangeEvent}},[a("ec-table-col",{attrs:{type:"seq",title:"序号",width:"50",align:"center"}}),a("ec-table-col",{attrs:{field:"provOrgName",title:"省公司","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"cityOrgName",title:"市公司","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"provDivisionName",title:"省","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"cityDivisionName",title:"地(州、市)","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"counDivisionName",title:"县(区、市)","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"baseCellCode",title:"基地单元编码","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"baseCellName",title:"基地单元名称","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"leafTypeCode",title:"烟叶类型","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(" "+e._s(e._f("getNameBy")(i.leafTypeCode,e.leafTypeList,{key:"leafTypeCode",label:"leafTypeName"}))+" ")])]}}])}),a("ec-table-col",{attrs:{field:"fieldArea",title:"基本烟田面积","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.fieldArea,e.areaUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"plantArea",title:"种植面积","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.plantArea,e.areaUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"buyWeight",title:"收购量","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.buyWeight,e.weightUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"techSuppOrg",title:"技术依托单位","min-width":"150",align:"left"}}),a("ec-table-col",{attrs:{field:"linkUpState",title:"衔接状态",width:"100",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s("0"===a.linkUpState?"未衔接":"1"===a.linkUpState?"已衔接":"")+" ")]}}])})],1)],1)],1)],1)],1)],1),a("ec-container-footer",[a("a-button",{attrs:{disabled:!e.selRow.bmUnitLinkRecId&&!e.selRow.bmUnitId,type:"primary"},on:{click:function(t){return e.handleNext(1)}}},[e._v("下一步")]),a("a-button",{on:{click:e.handleCancel}},[e._v("关闭")])],1)],1),a("ec-container",{directives:[{name:"show",rawName:"v-show",value:1===e.steps,expression:"steps === 1"}],attrs:{height:"100%"}},[a("ec-container-body",[a("ec-panel",{attrs:{title:"基地单元基本信息","color-code":"001"}},[a("ec-panel-item",[a("ec-form",{ref:"ruleForm",attrs:{model:e.formData,rules:e.rules}},[a("a-row",{attrs:{type:"flex",gutter:12}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"省公司"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.formData.provOrgName,callback:function(t){e.$set(e.formData,"provOrgName",t)},expression:"formData.provOrgName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"所在行政区域"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.formData.counOrgName,callback:function(t){e.$set(e.formData,"counOrgName",t)},expression:"formData.counOrgName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"省"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.formData.provDivisionName,callback:function(t){e.$set(e.formData,"provDivisionName",t)},expression:"formData.provDivisionName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"地(州、市)"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.formData.cityDivisionName,callback:function(t){e.$set(e.formData,"cityDivisionName",t)},expression:"formData.cityDivisionName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"县(区、市)"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.formData.counDivisionName,callback:function(t){e.$set(e.formData,"counDivisionName",t)},expression:"formData.counDivisionName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"基地单元名称"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.formData.baseCellName,callback:function(t){e.$set(e.formData,"baseCellName",t)},expression:"formData.baseCellName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"烟叶类型"}},[a("ec-select",{attrs:{disabled:"",placeholder:"请选择烟叶类型"},model:{value:e.formData.leafTypeCode,callback:function(t){e.$set(e.formData,"leafTypeCode",t)},expression:"formData.leafTypeCode"}},e._l(e.leafTypeList,(function(t){return a("a-select-option",{key:t.leafTypeCode},[e._v(" "+e._s(t.leafTypeName)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"技术依托单位"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.formData.techSuppOrg,callback:function(t){e.$set(e.formData,"techSuppOrg",t)},expression:"formData.techSuppOrg"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"基本烟田面积"}},[a("a-input",{attrs:{disabled:"",value:(Number(e.formData.fieldArea)/Number(e.areaUnit)).toFixed(2),placeholder:"",autocomplete:"off"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"种植面积"}},[a("a-input",{attrs:{disabled:"",value:(Number(e.formData.plantArea)/Number(e.areaUnit)).toFixed(2),placeholder:"",autocomplete:"off"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"收购量"}},[a("a-input",{attrs:{disabled:"",value:(Number(e.formData.buyWeight)/Number(e.weightUnit)).toFixed(2),placeholder:"",autocomplete:"off"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"创建年度"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.formData.busiYear,callback:function(t){e.$set(e.formData,"busiYear",t)},expression:"formData.busiYear"}})],1)],1)],1)],1)],1)],1),a("ec-panel",{attrs:{title:"衔接信息","color-code":"001"}},[a("ec-panel-item",[a("ec-form",{ref:"ruleForm",attrs:{model:e.formData,rules:e.rules}},[a("a-row",{attrs:{type:"flex",gutter:12}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"单位名称"}},[a("a-input",{attrs:{disabled:"",placeholder:"",autocomplete:"off"},model:{value:e.userInfo.orgName,callback:function(t){e.$set(e.userInfo,"orgName",t)},expression:"userInfo.orgName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"品牌",prop:"brandCode"}},[a("ec-select",{attrs:{allowClear:"",placeholder:"请选择品牌"},model:{value:e.formData.brandCode,callback:function(t){e.$set(e.formData,"brandCode",t)},expression:"formData.brandCode"}},e._l(e.brandList,(function(t){return a("a-select-option",{key:t.brandCode},[e._v(" "+e._s(t.brandName)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"烟叶品种",prop:"leafVarietyCode"}},[a("ec-select",{attrs:{allowClear:"",placeholder:"请选择烟叶品种"},model:{value:e.formData.leafVarietyCode,callback:function(t){e.$set(e.formData,"leafVarietyCode",t)},expression:"formData.leafVarietyCode"}},e._l(e.leftVarietyList,(function(t){return a("a-select-option",{key:t.leafVarietyCode},[e._v(" "+e._s(t.leafVarietyName)+" ")])})),1)],1)],1)],1)],1)],1)],1)],1),a("ec-container-footer",[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handlePre(0)}}},[e._v("上一步")]),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleUpdate()}}},[e._v("保存")]),a("a-button",{on:{click:e.handleCancel}},[e._v("关闭")])],1)],1)],1)],1)}),c=[],u=(a("6198"),a("6fc0")),f=a.n(u),d=(a("a9e3"),a("7db0"),a("6ea6")),m={name:"BusinessOrgManageEdit",components:{SelectPicker:f.a},props:{busiYear:{type:Number,default:0},auxiliaryInfo:{type:Object,default:function(){}},userInfo:{type:Object,default:function(){}},weightUnitList:{type:Array,default:function(){return[]}},areaUnitList:{type:Array,default:function(){return[]}},leafTypeList:{type:Array,default:function(){return[]}},linkUpStateList:{type:Array,default:function(){return[]}},businessOrgList:{type:Array,default:function(){return[]}},weightUnit:{type:String,default:""},areaUnit:{type:String,default:""}},data:function(){return{visible:!1,loading:!1,query:{},formData:{},rules:{brandCode:{required:!0,message:"请选择品牌",trigger:"change"},leafVarietyCode:{required:!0,message:"请选择烟叶瓶子",trigger:"change"}},tableData:[],pagination:{pageNumber:1,pageSize:10,total:0},steps:0,type:"",selRow:{},brandList:[],leftVarietyList:[],replaceFields:{pkey:"parentBizCode",title:"orgName",key:"bizCode",children:"children"}}},computed:{title:function(){return"新增基地单元衔接(".concat("ADD"===this.type?"新建单元":"已有单元",")")}},methods:{show:function(e){this.type=e,this.visible=!0,this.$set(this.query,"busiYear",this.busiYear),"EXISTING"===this.type&&this.$set(this.query,"linkUpState","0"),this.onQuery()},onFetchBusinessOrgList:function(){var e=this;return new Promise((function(t){var a=Object(d["treeFormatList"])(e.businessOrgList,e.replaceFields);t(a)}))},resetHandle:function(){this.query={busiYear:this.busiYear}},handleQueryLeafVarietyList:function(){var e=this,t={leafTypeCode:this.formData.leafTypeCode};this.$apis.bim.leftVariety.query(t).then((function(t){e.leftVarietyList=(null===t||void 0===t?void 0:t.rows)||[]}))},handleQueryBrandList:function(){var e=this,t={induOrgCode:this.userInfo.orgCode};this.$apis.apm.baseConnect.brandQuery(t).then((function(t){e.brandList=(null===t||void 0===t?void 0:t.rows)||[]}))},onQuery:function(){var e,t;null===(e=this.$refs)||void 0===e||null===(t=e.tableRef)||void 0===t||t.pageAction(1,10)},queryHandle:function(e,t){var a=this,i=Object(o["a"])({pageNo:e,pageSize:t},this.query);this.loading=!0,"ADD"===this.type?this.$apis.apm.baseConnect.addQuery(i).then((function(e){a.loading=!1,a.tableData=(null===e||void 0===e?void 0:e.rows)||[],a.pagination.total=null===e||void 0===e?void 0:e.totalRows})).catch((function(){a.loading=!1})):this.$apis.apm.baseConnect.existingQuery(i).then((function(e){a.loading=!1,a.tableData=(null===e||void 0===e?void 0:e.rows)||[],a.pagination.total=null===e||void 0===e?void 0:e.totalRows})).catch((function(){a.loading=!1}))},currentChangeEvent:function(e){var t=e.row;this.selRow=t},handleNext:function(e){this.steps=e,this.formData=this.selRow,this.handleQueryLeafVarietyList(),this.handleQueryBrandList(),this.$set(this.formData,"brandCode",void 0),this.$set(this.formData,"leafVarietyCode",void 0)},handlePre:function(e){this.steps=e},handleUpdate:function(){var e=this;this.$refs.ruleForm.validate((function(t){var a;t?(e.formData.brandName=null===(a=e.brandList.find((function(t){return t.brandCode===e.formData.brandCode})))||void 0===a?void 0:a.brandName,"ADD"===e.type?e.$apis.apm.baseConnect.addSave(e.formData).then((function(){e.$message.success("保存成功！"),e.handleCancel(),e.$emit("saved")})):e.$apis.apm.baseConnect.existingSave(e.formData).then((function(){e.$message.success("保存成功！"),e.handleCancel(),e.$emit("saved")}))):e.$message.error("验证不通过")}))},handleCancel:function(){this.visible=!1,this.steps=0,this.resetHandle(),this.formData={},this.$refs.ruleForm.resetFields(),this.tableData=[]}}},p=m,b=(a("f930"),a("2877")),y=Object(b["a"])(p,s,c,!1,null,"5c6a2208",null),h=y.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ec-modal",{attrs:{title:"详细",width:"1000px","is-confirm":!0},scopedSlots:e._u([{key:"footer",fn:function(){return[a("a-button",{on:{click:e.onClose}},[e._v("关闭")])]},proxy:!0}]),model:{value:e.visibile,callback:function(t){e.visibile=t},expression:"visibile"}},[a("ec-form",{attrs:{model:e.formData,rules:e.rules}},[a("ec-panel",{attrs:{title:"基地单元基本信息","color-code":"001"}},[a("ec-panel-item",[a("a-row",{attrs:{type:"flex",gutter:12}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"省公司"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.provOrgName,callback:function(t){e.$set(e.formData,"provOrgName",t)},expression:"formData.provOrgName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"所在行政区域"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.counOrgName,callback:function(t){e.$set(e.formData,"counOrgName",t)},expression:"formData.counOrgName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"省"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.provDivisionName,callback:function(t){e.$set(e.formData,"provDivisionName",t)},expression:"formData.provDivisionName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"地(州、市)"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.cityDivisionName,callback:function(t){e.$set(e.formData,"cityDivisionName",t)},expression:"formData.cityDivisionName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"县(区、市)"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.counDivisionName,callback:function(t){e.$set(e.formData,"counDivisionName",t)},expression:"formData.counDivisionName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"基地单元名称"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.baseCellName,callback:function(t){e.$set(e.formData,"baseCellName",t)},expression:"formData.baseCellName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"烟叶类型"}},[a("ec-select",{attrs:{disabled:""},model:{value:e.formData.leafTypeCode,callback:function(t){e.$set(e.formData,"leafTypeCode",t)},expression:"formData.leafTypeCode"}},e._l(e.leafTypeList,(function(t){return a("a-select-option",{key:t.leafTypeCode},[e._v(" "+e._s(t.leafTypeName)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"技术依托单位"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.techSuppOrg,callback:function(t){e.$set(e.formData,"techSuppOrg",t)},expression:"formData.techSuppOrg"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"基本烟田面积"}},[a("a-input",{attrs:{disabled:"",value:(Number(e.formData.fieldArea)/Number(1e4)).toFixed(2)}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"种植面积"}},[a("a-input",{attrs:{disabled:"",value:(Number(e.formData.plantArea)/Number(1e4)).toFixed(2)}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"收购量"}},[a("a-input",{attrs:{disabled:"",value:(Number(e.formData.buyWeight)/Number(5e5)).toFixed(2)}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"创建年度"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.busiYear,callback:function(t){e.$set(e.formData,"busiYear",t)},expression:"formData.busiYear"}})],1)],1)],1)],1)],1),a("ec-panel",{attrs:{title:"衔接信息","color-code":"001"}},[a("ec-panel-item",[a("a-row",{attrs:{type:"flex",gutter:12}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"单位名称"}},[a("a-input",{attrs:{disabled:""},model:{value:e.userInfo.orgName,callback:function(t){e.$set(e.userInfo,"orgName",t)},expression:"userInfo.orgName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"品牌"}},[a("a-input",{attrs:{disabled:""},model:{value:e.formData.brandName,callback:function(t){e.$set(e.formData,"brandName",t)},expression:"formData.brandName"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"烟叶品种"}},[a("ec-select",{attrs:{disabled:""},model:{value:e.formData.leafVarietyCode,callback:function(t){e.$set(e.formData,"leafVarietyCode",t)},expression:"formData.leafVarietyCode"}},e._l(e.leftVarietyList,(function(t){return a("a-select-option",{key:t.leafVarietyCode},[e._v(" "+e._s(t.leafVarietyName)+" ")])})),1)],1)],1)],1)],1)],1)],1)],1)},g=[],_={name:"DetailModal",props:{leafTypeList:{type:Array,default:function(){return[]}},busiYear:{type:Number,default:0},userInfo:{type:Object,default:function(){}}},data:function(){return{visibile:!1,formData:{},rules:{},leftVarietyList:[],brandList:[]}},methods:{show:function(e){this.visibile=!0,this.formData=e,this.handleQueryLeafVarietyList(),this.handleQueryBrandList()},onClose:function(){this.visibile=!1},handleQueryLeafVarietyList:function(){var e=this,t={leafTypeCode:this.formData.leafTypeCode};this.$apis.bim.leftVariety.query(t).then((function(t){e.leftVarietyList=(null===t||void 0===t?void 0:t.rows)||[]}))}}},D=_,w=Object(b["a"])(D,v,g,!1,null,null,null),k=w.exports,N={name:"PanelSupple",components:{BusinessOrgManageEdit:h,DetailModal:k},data:function(){return{loading:!1,query:{},weightUnitList:[],areaUnitList:[],weightUnit:"500000",areaUnit:"10000",unitPropList:[],billStateList:[],auxiliaryInfo:{},tableData:[],pagination:{pageNumber:1,pageSize:10,total:0},leafTypeList:[],leafVarietyList:[],linkUpStateList:[],selTableData:[],businessOrgList:[]}},computed:{appConfig:function(){return this.$store.getters.getAppConfig},leafTypeObj:function(){return this.leafTypeList.map((function(e){return{key:e.leafTypeCode,title:e.leafTypeName}}))},leftVarietyObj:function(){return this.leafVarietyList.map((function(e){return{key:e.leafVarietyCode,title:e.leafVarietyName}}))},linkUpStateObj:function(){return this.linkUpStateList.map((function(e){return{key:e.enumKey,title:e.name}}))},billStateObj:function(){return this.billStateList.map((function(e){return{key:e.enumKey,title:e.name}}))},busiYear:function(){var e,t;return null===(e=this.$store.getters.getAppConfig)||void 0===e||null===(t=e.yearValueMap)||void 0===t?void 0:t.CENTER_YEAR},bizCode:function(){var e;return null===(e=this.$store.getters.getAppConfig)||void 0===e?void 0:e.bizCode}},created:function(){var e=this.$router.history.current.query.appCode;this.appCode=e||"CM",this.query.busiYear=this.busiYear,this.handleGetEnum(),this.onGet(),this.handleQueryLeafTypeList(),this.handleQueryLeafVarietyList(),this.handleQueryBusinessOrgList()},methods:{handleGetEnum:function(){var e=this,t={enumTypeCodes:["WEIGHT_UNIT","AREA_UNIT","BASE_UNIT_NATURE","LINK_UP_STATE","BILL_STATE"]};this.$apis.bim.enumType.query(t).then((function(t){var a=(null===t||void 0===t?void 0:t.enumMap)||{};e.weightUnitList=a.WEIGHT_UNIT||[],e.areaUnitList=a.AREA_UNIT||[],e.unitPropList=a.BASE_UNIT_NATURE||[],e.linkUpStateList=a.LINK_UP_STATE||[],e.billStateList=a.BILL_STATE||[]}))},handleQueryLeafTypeList:function(){var e=this;this.$apis.bim.leafType.query({}).then((function(t){e.leafTypeList=(null===t||void 0===t?void 0:t.rows)||[]}))},handleQueryLeafVarietyList:function(){var e=this;this.$apis.bim.leftVariety.query({}).then((function(t){e.leafVarietyList=(null===t||void 0===t?void 0:t.rows)||[]}))},onGet:function(){var e=this;this.$apis.apm.baseConnect.get().then((function(t){e.auxiliaryInfo=t||{}}))},resetHandle:function(){this.query={busiYear:this.busiYear},this.onQuery()},onQuery:function(){this.$refs.tableRef.pageAction(1,10)},queryHandle:function(e,t){var a=this,i=Object(o["a"])({pageNo:e,pageSize:t},this.query);this.loading=!0,this.$apis.apm.baseConnect.query(i).then((function(e){a.loading=!1,a.tableData=(null===e||void 0===e?void 0:e.rows)||[],a.pagination.total=null===e||void 0===e?void 0:e.totalRows})).catch((function(){a.loading=!1}))},handleUpdate:function(e){this.$refs.editRef.show(e)},editRowEvent:function(){var e=this.$refs.xTable;e.setActiveRow()},handleDetail:function(e){this.$refs.detailModalRef.show(e)},onDelete:function(){var e=this,t=this.$createElement;if(this.selTableData.length){var a=this.selTableData.some((function(e){return"1"!==e.billState&&"3"!==e.billState&&"5"!==e.billState}));a?this.$message.error("只有退回状态才能删除,请重新选择！"):this.$confirm({title:"是否执行该操作?",content:function(){return t("div",{style:"color:red;"},["是否确认删除选中的数据，确认请点击'确认'按钮，取消点击'取消'按钮。"])},onOk:function(){var t={bmUnitLinkRecIds:e.selTableData.map((function(e){return e.bmUnitLinkRecId}))};e.loading=!0,e.$apis.apm.baseConnect.delete(t).then((function(){e.loading=!1,e.$message.error("删除成功"),e.onQuery()}))}})}else this.$message.error("请选择一条数据再删除")},onSelTableData:function(e){var t=e.records;this.selTableData=t},onSelAllTableData:function(e){var t=e.records;this.selTableData=t},handleQueryBusinessOrgList:function(){var e=this;return Object(n["a"])(Object(l["a"])().mark((function t(){var a,i;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={busiYear:e.busiYear,orgTypeEk:"TOBACCO",orgLevelEk:"2",parentBizCode:e.bizCode},t.next=3,e.$apis.bim.org.queryBy(a);case 3:i=t.sent,e.businessOrgList=i.rows||[];case 5:case"end":return t.stop()}}),t)})))()}}},C=N,L=(a("4aba"),Object(b["a"])(C,i,r,!1,null,"37e66337",null));t["default"]=L.exports},"4aba":function(e,t,a){"use strict";a("5138")},5138:function(e,t,a){},5530:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("159b"),a("dbb4");function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}},f930:function(e,t,a){"use strict";a("1ebe")}}]);
//# sourceMappingURL=chunk-b61cc472.1280a733.js.map