(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0466bf0a"],{"0621":function(e,t,r){var n=r("9e69"),a=r("d370"),i=r("6747"),c=n?n.isConcatSpreadable:void 0;function l(e){return i(e)||a(e)||!!(c&&e&&e[c])}e.exports=l},"166a":function(e,t,r){},"24f1":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"tree-search"},[e._t("title"),e.isSearch?r("div",{staticClass:"tree-search-select"},[r("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"",value:e.selectedValue,placeholder:e.placeholder,"default-active-first-option":!1,"show-arrow":!1,"filter-option":!1,"not-found-content":null},on:{search:e.onSelectSearch,select:e.onSelectChange}},e._l(e.selectOption,(function(t){return r("a-select-option",{key:t.key,attrs:{value:t.key,title:""+t.title}},[r("a-row",[r("a-col",{staticClass:"ellipsis",attrs:{span:e.isShowParent?18:24,title:t.title}},[e._v(e._s(t.title))]),r("a-col",{staticClass:"ellipsis",staticStyle:{color:"#ccc","font-size":"12px"},attrs:{span:e.isShowParent?6:0,title:e.getNameBy(e.tmpSearchOption,t.pkey)}},[e._v(e._s(e._f("getNameBy")(t.pkey,e.tmpSearchOption)))])],1)],1)})),1)],1):e._e(),e.isSearch?r("a-divider",{staticStyle:{margin:"8px 0"}}):e._e(),r("div",{staticClass:"tree-search-tree"},[r("a-spin",{attrs:{spinning:e.fetching}},[e.lazy?r("a-tree",{ref:"treeRef",attrs:{blockNode:!0,multiple:e.multiple,expandedKeys:e.treeExpandedKeys,selectedKeys:e.treeSelectedKeys,loadedKeys:e.treeLoadedKeys,"tree-data":e.treeData,loadData:e.handleLoadLazyData},on:{select:e.onSelectTree,expand:e.onExpandTree,load:e.onLazyLoad},scopedSlots:e._u([{key:"title",fn:function(t){var n=t.title,a=t.key;return[r("span",{attrs:{id:"c_"+a}},[e._v(e._s(n))])]}}],null,!1,364953554)}):r("a-tree",{ref:"treeRef",attrs:{blockNode:!0,multiple:e.multiple,expandedKeys:e.treeExpandedKeys,selectedKeys:e.treeSelectedKeys,"tree-data":e.treeData,replaceFields:e.replaceFields},on:{select:e.onSelectTree,expand:e.onExpandTree},scopedSlots:e._u([{key:"title",fn:function(t){var n=t.title,a=t.key;return[r("span",{attrs:{id:"c_"+a}},[e._v(e._s(n))])]}}])})],1),!e.treeData||Array.isArray(e.treeData)&&0===e.treeData.length?r("a-empty",{staticClass:"spin"}):e._e()],1)],2)},a=[],i=r("2909"),c=r("b85c"),l=r("c7eb"),o=r("1da1"),s=(r("a9e3"),r("ac1f"),r("841c"),r("d3b7"),r("4de4"),r("d81d"),r("caad"),r("2532"),r("3ca3"),r("ddb0"),r("159b"),r("a630"),r("6062"),r("99af"),r("00b4"),r("a15b"),r("0644")),u=r.n(s),d=r("991b"),f=r.n(d),p=r("f2be"),y=r("b047"),h=r.n(y),v={name:"TreeSearch",props:{selectedKeys:{type:Array,default:null},expandedKeys:{type:Array,default:null},lazy:{type:Boolean,default:!0},defaultValue:{type:Array,default:null},placeholder:{type:String,default:"请输入关键词筛选"},multiple:{type:Boolean,default:!1},join:{type:Boolean,default:!1},isShowParent:{type:Boolean,default:!1},replaceFields:{type:Object,default:function(){return{pkey:"pkey",title:"title",key:"key",children:"children"}}},search:{type:Boolean,default:!0},activeFirst:{type:Boolean,default:!1},initLevel:{type:Number,default:2},fetchData:{type:Function},fetchDataById:{type:Function},fetchDataByName:{type:Function},valueField:{type:String,default:"key"}},data:function(){return this.onSelectSearch=h()(this.onSelectSearch,500),{fetching:!1,selectedValue:[],treeSelectedKeys:[],treeExpandedKeys:[],treeLoadedKeys:[],treeData:[],selectOption:[],tmpSearchOption:[]}},computed:{isSearch:function(){return this.search&&(this.treeData||Array.isArray(this.treeData)&&0!==this.treeData.length)}},watch:{selectedKeys:{handler:function(e){this.treeSelectedKeys=e},deep:!0,immediate:!0},expandedKeys:{handler:function(e){this.treeExpandedKeys=e},deep:!0,immediate:!0}},mounted:function(){this.handleTreeData(this.params)},methods:{getNameBy:p["c"],handleTreeData:function(e){var t=this;this.fetching=!0,this.treeLoadedKeys=[],this.treeExpandedKeys=[];try{this.fetchData(e).then(function(){var e=Object(o["a"])(Object(l["a"])().mark((function e(r){var n,a,i;return Object(l["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=u()(r).filter((function(e){return!e.pkey}))[0],t.treeData=Object(p["f"])(r,t.replaceFields),a=r.map((function(e){return e.key})).filter((function(e){return e})),i=(t.selectedKeys||[]).filter((function(e){return!a.includes(e)})),Array.isArray(t.treeData)&&0!==t.treeData.length&&(t.treeExpandedKeys=[n.key],t.$emit("expand",t.treeExpandedKeys),t.activeFirst&&t.onSelectTreeFn(n.key)),0===i.length){e.next=8;break}return e.next=8,t.handleTreeByCode(i);case 8:Array.isArray(t.treeSelectedKeys)&&0!==t.treeSelectedKeys.length&&setTimeout((function(){t.onScrollIntoView(t.treeSelectedKeys[0])}),500);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){t.fetching=!1}))}catch(r){console.error("fetchData请求错误，请检查httpUrl是否正确！")}this.fetching=!1},handleTreeByCode:function(e){var t=this;return Object(o["a"])(Object(l["a"])().mark((function r(){var n,a,o,s,u,d,y,h,v,b,m;return Object(l["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=Array.isArray(e)?e:[e],t.fetching=!0,r.prev=2,!t.lazy){r.next=18;break}a=[],o=Object(c["a"])(n);try{for(o.s();!(s=o.n()).done;)u=s.value,u&&a.push(t.fetchDataById({code:u}))}catch(l){o.e(l)}finally{o.f()}return r.next=9,Promise.all(a);case 9:if(d=r.sent,y=Object(p["g"])(t.treeData,t.replaceFields),h=f()(d),v=y.map((function(e){return e.key})).filter((function(e){return e})),b=h.filter((function(e){return!v.includes(e.key)})),m=b.map((function(e){return e.pkey})),0===m.length){r.next=18;break}return r.next=18,t.handleLoadMore(m);case 18:n.forEach((function(e){var r=Object(p["b"])(t.treeData,e,t.replaceFields);t.treeExpandedKeys=Array.from(new Set([].concat(Object(i["a"])(r),Object(i["a"])(t.treeExpandedKeys))))})),r.next=24;break;case 21:r.prev=21,r.t0=r["catch"](2),console.error("http请求错误，请检查apiUrl是否正确！");case 24:t.fetching=!1;case 25:case"end":return r.stop()}}),r,null,[[2,21]])})))()},handleLoadMore:function(e){var t=this;return Object(o["a"])(Object(l["a"])().mark((function r(){var n,a,o,s,u,d,y,h;return Object(l["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.fetching=!0,n=[],a=Object(c["a"])(e);try{for(a.s();!(o=a.n()).done;)s=o.value,s&&n.push(t.fetchData({code:s}))}catch(l){a.e(l)}finally{a.f()}return r.next=6,Promise.all(n);case 6:u=r.sent,d=f()(u),y=Object(p["g"])(t.treeData),h=Object(p["h"])([].concat(Object(i["a"])(y),Object(i["a"])(d))),t.treeData=Object(p["f"])(h,t.replaceFields),t.fetching=!1;case 12:case"end":return r.stop()}}),r)})))()},handleLoadLazyData:function(e){var t=this,r=e;return new Promise((function(e){r.dataRef.children?e():t.fetchData({code:r.dataRef.key}).then((function(n){var a=Object(p["h"])(n,"key");r.dataRef.children=Object(i["a"])(a),t.treeData=Object(i["a"])(t.treeData),e(a)})).finally((function(){t.fetching=!1}))}))},onSelectSearch:function(e){/^\s*$/.test(e)||(this.handlerSearch(e),this.$emit("search",e))},handlerSearch:function(e){var t=this;return Object(o["a"])(Object(l["a"])().mark((function r(){var n;return Object(l["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t.lazy){r.next=8;break}return r.next=3,t.fetchDataByName({name:e}).catch((function(e){return console.log(e)}));case 3:n=r.sent,t.tmpSearchOption=u()(n)||[],t.selectOption=n.filter((function(t){return String(null===t||void 0===t?void 0:t.title).indexOf(e)>-1})),r.next=9;break;case 8:t.selectOption=Object(p["a"])(t.treeData,(function(t){return String(null===t||void 0===t?void 0:t.title).indexOf(e)>-1}),t.replaceFields);case 9:case"end":return r.stop()}}),r)})))()},onSelectChange:function(e){var t=this;return Object(o["a"])(Object(l["a"])().mark((function r(){var n,a,c,o,s,d,f,y;return Object(l["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=Array.isArray(e)?e:[e],a=u()(t.selectOption).filter((function(e){return n.includes(e.key)})),!t.lazy){r.next=10;break}if(c=Object(p["g"])(t.treeData,t.replaceFields),o=c.map((function(e){return e.key})).filter((function(e){return e})),s=t.tmpSearchOption.filter((function(e){return!o.includes(e.key)})),d=s.map((function(e){return e.pkey})),0===d.length){r.next=10;break}return r.next=10,t.handleLoadMore(d);case 10:f=Object(p["b"])(t.treeData,Array.isArray(e)?e[0]:e,t.replaceFields),t.multiple?!t.treeSelectedKeys.includes(n)&&(y=t.treeSelectedKeys).push.apply(y,Object(i["a"])(n)):t.treeSelectedKeys=n,Object.assign(t,{selectedValue:n,treeExpandedKeys:f,selectOption:a,fetching:!1}),t.onSelectTreeFn(e);case 14:case"end":return r.stop()}}),r)})))()},onExpandTree:function(e,t){this.treeExpandedKeys=Array.isArray(e)?e:[e],this.$emit("expand",this.treeExpandedKeys,t)},onSelectTreeFn:function(e){var t=this;return Object(o["a"])(Object(l["a"])().mark((function r(){var n,a,c,o,s,u,d,f;return Object(l["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=Array.isArray(e)?e:[e],a=Array.isArray(e)?e[0]:e,c=Object(p["g"])(t.treeData,t.replaceFields),o=c.map((function(e){return e.key})).filter((function(e){return e})),o.includes(a)){r.next=14;break}return r.next=7,t.fetchDataById({code:a});case 7:return s=r.sent,r.next=10,Object(p["h"])([].concat(Object(i["a"])(c),Object(i["a"])(s)));case 10:return u=r.sent,r.next=13,Object(p["f"])(u);case 13:t.treeData=r.sent;case 14:d=Object(p["d"])(t.treeData,a),f=Array.from(new Set(t.multiple?[].concat(Object(i["a"])(t.treeSelectedKeys),Object(i["a"])(n)):n)),t.onSelectTree(f,{event:"select",selected:!0,node:{dataRef:d}});case 17:case"end":return r.stop()}}),r)})))()},onScrollIntoView:function(e){this.$nextTick((function(){var t,r,n=document.querySelector(".picker-modal-tree");n?null===(t=document.querySelector(".picker-modal-tree #c_".concat(e)))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"}):null===(r=document.getElementById("c_".concat(e)))||void 0===r||r.scrollIntoView({behavior:"smooth",block:"center"})}))},onSelectTree:function(e,t){var r=this,n=Array.isArray(e)?e:[e],a=t.node.dataRef.key;console.log("keysString",a),Object.assign(this,{treeSelectedKeys:n});var i=Object(p["h"])(Object(p["a"])(this.treeData,(function(e){return r.treeSelectedKeys.includes(e.key)}),this.replaceFields));if(this.join){var c=i.map((function(e){var t={};for(var n in e)n&&(t[n]=Object(p["e"])(r.treeData,a,n,r.replaceFields).join("/"));return t})),l=c.map((function(e){return e[r.valueField]}));this.$emit("select",{treeSelectedKeys:l,selectOption:c,treeData:u()(this.treeData)},t)}else{var o=i.map((function(e){return e[r.valueField]}));this.$emit("select",{treeSelectedKeys:o,selectOption:i,treeData:u()(this.treeData)},t)}this.selectedValue[0]!==a&&(this.selectedValue=[],this.selectOption=[]),this.onScrollIntoView(a)},onLazyLoad:function(e){this.treeLoadedKeys=e}}},b=v,m=(r("aef4"),r("2877")),g=Object(m["a"])(b,n,a,!1,null,null,null);t["a"]=g.exports},"363d":function(e,t,r){},"408c":function(e,t,r){var n=r("2b3e"),a=function(){return n.Date.now()};e.exports=a},"4cef":function(e,t){var r=/\s/;function n(e){var t=e.length;while(t--&&r.test(e.charAt(t)));return t}e.exports=n},5530:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("b64b"),r("a4d3"),r("4de4"),r("d3b7"),r("e439"),r("159b"),r("dbb4");function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},"5c69":function(e,t,r){var n=r("087d"),a=r("0621");function i(e,t,r,c,l){var o=-1,s=e.length;r||(r=a),l||(l=[]);while(++o<s){var u=e[o];t>0&&r(u)?t>1?i(u,t-1,r,c,l):n(l,u):c||(l[l.length]=u)}return l}e.exports=i},6486:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("SelectPicker",e._g(e._b({attrs:{title:e.title,value:e.value,search:e.search,"allow-clear":e.allowClear,placeholder:e.placeholder,multiple:e.multiple,disabled:e.disabled,valueField:e.valueField,fetchData:e.fetchGetTree,fetchDataById:e.fetchGetTreeById,fetchDataByName:e.fetchGetTreeByName}},"SelectPicker",e.$attrs,!1),e.$listeners))},a=[],i=r("5530"),c=(r("a9e3"),r("d3b7"),r("ac16"),r("f8c9"),r("b0c0"),r("9d27")),l=r("f2be"),o={inheritAttrs:!1,name:"OrgPicker",components:{SelectPicker:c["a"]},model:{prop:"value",event:"change"},props:{value:{type:[String,Array,null],default:null},baseUrl:{type:String,default:"/dts/bim"},treeApi:{type:String,default:"/q/CmTOrgMainServiceExAPI/getCmTOrgMainTreeDataList/v1"},treeApiById:{type:String,default:"/q/cmTOrgMain/getCmTOrgMainTreeParentByOrgUniqueCode/v1"},treeApiByName:{type:String,default:"/q/cmTOrgMain/getCmTOrgMainTreeParentByOrgName/v1"},placeholder:{type:String,default:"请选择关键词搜索"},multiple:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},title:{type:String,default:"组织机构选择器"},search:{type:Boolean,default:!0},width:{type:[String,Number],default:"425px"},height:{type:[String,Number],default:"370px"},top:{type:[String,Number],default:"100px"},centered:{type:Boolean,default:!1},initLevel:{type:[Number,null],default:2},limitLevel:{type:[Number,null],default:null},replaceFields:{type:Object,default:function(){return{pkey:"pkey",title:"title",key:"key",children:"children"}}},valueField:{type:String,default:"key"},join:{type:Boolean,default:!1},lazy:{type:Boolean,default:!0}},methods:{fetchGetTree:function(e){var t=this;return new Promise((function(r,n){var a=null===e||void 0===e?void 0:e.code;a&&Reflect.deleteProperty(e,"code"),$ec.http.send(t.baseUrl+t.treeApi,Object(i["a"])({orgLevelNum:t.limitLevel,orgUniqueCode:a},e)).then((function(e){var n=e.rows,a=Object(l["g"])(n,t.replaceFields);r(a)})).catch((function(e){n(e)})).finally((function(){console.log("finally")}))}))},fetchGetTreeById:function(e){var t=this;return new Promise((function(r,n){var a=null===e||void 0===e?void 0:e.code;a&&Reflect.deleteProperty(e,"code"),$ec.http.send(t.baseUrl+t.treeApiById,Object(i["a"])({orgLevelNum:t.limitLevel,orgUniqueCode:a},e)).then((function(e){var n=e.rows,a=Object(l["g"])(n,t.replaceFields);r(a)})).catch((function(e){n(e)})).finally((function(){console.log("finally")}))}))},fetchGetTreeByName:function(e){var t=this;return new Promise((function(r,n){var a=null===e||void 0===e?void 0:e.name;a&&Reflect.deleteProperty(e,"name"),$ec.http.send(t.baseUrl+t.treeApiByName,Object(i["a"])({orgLevelNum:t.limitLevel,orgName:a},e)).then((function(e){var n=e.rows,a=Object(l["g"])(n,t.replaceFields);r(a)})).catch((function(e){n(e)})).finally((function(){console.log("finally")}))}))}}},s=o,u=r("2877"),d=Object(u["a"])(s,n,a,!1,null,null,null);t["a"]=d.exports},"8d74":function(e,t,r){var n=r("4cef"),a=/^\s+/;function i(e){return e?e.slice(0,n(e)+1).replace(a,""):e}e.exports=i},"8ecc":function(e,t,r){"use strict";r("166a")},"991b":function(e,t,r){var n=r("5c69"),a=1/0;function i(e){var t=null==e?0:e.length;return t?n(e,a):[]}e.exports=i},"9d27":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"picker-modal"},[r("a-input-group",{staticClass:"picker-wrapper",attrs:{compact:""}},[r("a-select",{staticClass:"picker-wrapper-select",staticStyle:{width:"200px"},attrs:{value:e.selectedValue,"show-search":"","allow-clear":e.allowClear,placeholder:e.placeholder,mode:e.multiple?"multiple":"default",disabled:e.disabled,"show-arrow":!1,"filter-option":!1,maxTagCount:e.maxTagCount,"default-active-first-option":!1,"not-found-content":e.fetching?void 0:null},on:{search:e.onSelectSearch,change:e.onChange}},[e.fetching?r("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):e._e(),e._l(e.selectOption,(function(t){return r("a-select-option",{key:t[e.valueField],attrs:{title:""+t.title,value:t[e.valueField]}},[e._v(" "+e._s(t.title)+" ")])}))],2),r("div",{staticClass:"picker-btn-wrapper"},[r("a-button",{staticClass:"picker-wrapper-btn",attrs:{icon:"more",disabled:e.disabled},on:{click:e.onOpenModal}})],1)],1),r("ec-modal",{attrs:{title:e.title,visible:e.visible,width:e.widthed,height:e.height,top:e.top,centered:e.centered,keyboard:!1,"mask-closable":!1},on:{cancel:e.onCancel,ok:e.onOk}},[e.visible?r("TreeSearch",{ref:"treeSearch",staticClass:"picker-modal-tree",attrs:{lazy:e.lazy,join:e.join,search:e.search,initLevel:e.initLevel,multiple:e.multiple,selectedKeys:e.selectedKeys,expandedKeys:e.expandedKeys,fetchData:e.fetchData,fetchDataById:e.fetchDataById,fetchDataByName:e.fetchDataByName,replaceFields:e.replaceFields,valueField:e.valueField,isShowParent:e.isShowParent},on:{select:e.onSelectTreeData}}):e._e(),e.multiple?r("a-divider",{staticStyle:{height:"100%"},attrs:{type:"vertical"}}):e._e(),e.multiple?r("div",{staticClass:"picker-modal-wrap"},[r("div",{staticStyle:{height:"30px","line-height":"30px","font-size":"12px","text-align":"right"}},[e._v(" 已选择："),r("strong",[e._v(e._s(e.selectedKeys.length))]),e._v("项 ")]),r("div",{staticClass:"picker-modal-list"},[e._l(e.treeSelectOption,(function(t){return r("div",{key:t.key},[r("a-tag",{key:t.key,attrs:{color:"blue",closable:!0,size:"large"},on:{close:function(r){return e.onRemoveOption(t.key)}}},[e._v(e._s(t.title))])],1)})),!e.selectedKeys||Array.isArray(e.selectedKeys)&&0===e.selectedKeys.length?r("a-empty",{staticClass:"spin"}):e._e()],2)]):e._e()],1)],1)},a=[],i=r("b85c"),c=r("c7eb"),l=r("2909"),o=r("1da1");function s(e){if(Array.isArray(e))return e}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0");function u(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],c=!0,l=!1;try{for(r=r.call(e);!(c=(n=r.next()).done);c=!0)if(i.push(n.value),t&&i.length===t)break}catch(o){l=!0,a=o}finally{try{c||null==r["return"]||r["return"]()}finally{if(l)throw a}}return i}}var d=r("06c5");r("d9e2");function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){return s(e)||u(e,t)||Object(d["a"])(e,t)||f()}r("a9e3"),r("ac1f"),r("466d"),r("99af"),r("caad"),r("2532"),r("00b4"),r("a15b"),r("d81d"),r("4de4");var y=r("f2be"),h=r("0644"),v=r.n(h),b=r("b047"),m=r.n(b),g=r("991b"),O=r.n(g),k=r("24f1"),S={name:"SelectPicker",components:{TreeSearch:k["a"]},model:{prop:"value",event:"change"},props:{value:{type:[String,Array],default:null},maxTagCount:{type:Number,default:1},placeholder:{type:String,default:"请选择关键词搜索"},lazy:{type:Boolean,default:!0},multiple:{type:Boolean,default:!1},isShowParent:{type:Boolean,default:!0},allowClear:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},title:{type:String,default:"选择器"},width:{type:[String,Number],default:"425px"},height:{type:[String,Number],default:"370px"},top:{type:[String,Number],default:"100px"},centered:{type:Boolean,default:!1},join:{type:Boolean,default:!1},search:{type:Boolean,default:!0},initLevel:{type:Number,default:2},replaceFields:{type:Object,default:function(){return{pkey:"pkey",title:"title",key:"key",children:"children"}}},valueField:{type:String,default:"key"},fetchData:{type:Function},fetchDataById:{type:Function},fetchDataByName:{type:Function}},data:function(){return this.onSelectSearch=m()(this.onSelectSearch,300),{visible:!1,fetching:!1,treeData:[],selectedValue:[],expandedKeys:[],selectedKeys:[],selectOption:[],treeSelectOption:[]}},computed:{widthed:function(){var e=String(this.width).match(/[a-z]+|[^a-z]+/gi),t=p(e,2),r=t[0],n=t[1];return this.multiple?Number(r)+140+n:this.width}},watch:{value:{handler:function(e){this.handleListByCode(e)},deep:!0,immediate:!0}},methods:{handleTreeByName:function(e){var t=this;return Object(o["a"])(Object(c["a"])().mark((function r(){var n,a,i;return Object(c["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.fetching=!0,r.prev=1,!t.lazy){r.next=10;break}return r.next=5,t.fetchDataByName({name:e},e);case 5:n=r.sent,a=Object(y["a"])(n,(function(t){return String(null===t||void 0===t?void 0:t.title).indexOf(e)>-1}),t.replaceFields),t.selectOption=Object(y["h"])([].concat(Object(l["a"])(t.selectOption),Object(l["a"])(a)),"key"),r.next=15;break;case 10:return r.next=12,t.fetchData();case 12:i=r.sent,t.treeData=Object(y["f"])(i,t.replaceFields),t.selectOption=Object(y["a"])(i,(function(t){return String(null===t||void 0===t?void 0:t.title).indexOf(e)>-1}),t.replaceFields);case 15:r.next=20;break;case 17:r.prev=17,r.t0=r["catch"](1),console.error("http请求错误，请检查apiUrl是否正确！");case 20:t.fetching=!1;case 21:case"end":return r.stop()}}),r,null,[[1,17]])})))()},handleListByCode:function(e){var t=this;return Object(o["a"])(Object(c["a"])().mark((function r(){var n,a,l,o,s,u,d,f,p;return Object(c["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=[],!e){r.next=28;break}if(n=Array.isArray(e)?e:[e],t.fetching=!0,r.prev=4,!t.lazy){r.next=18;break}a=[],l=Object(i["a"])(n);try{for(l.s();!(o=l.n()).done;)s=o.value,s&&a.push(t.fetchDataById({code:s},e))}catch(c){l.e(c)}finally{l.f()}return r.next=11,Promise.all(a);case 11:u=r.sent,d=O()(u),f=Object(y["a"])(d,(function(e){return n.includes(e.key)}),t.replaceFields),t.selectOption=Object(y["h"])(f),t.treeSelectOption=v()(t.selectOption),r.next=23;break;case 18:return r.next=20,t.fetchData();case 20:p=r.sent,t.treeData=Object(y["f"])(p,t.replaceFields),t.selectOption=Object(y["a"])(p,(function(t){return String(null===t||void 0===t?void 0:t.key).indexOf(e)>-1}),t.replaceFields);case 23:r.next=28;break;case 25:r.prev=25,r.t0=r["catch"](4),console.error("http请求错误，请检查apiUrl是否正确！");case 28:t.selectedValue=n,t.selectedKeys=n,t.fetching=!1;case 31:case"end":return r.stop()}}),r,null,[[4,25]])})))()},onSelectSearch:function(e){/^\s*$/.test(e)||this.handleTreeByName(e)},onChange:function(e,t){var r=this,n=Array.isArray(e)?e:[e];if(this.join){var a=this.selectOption.map((function(e){var t={};for(var n in e)n&&(t[n]=Object(y["e"])(r.treeData,e.key,n,r.replaceFields).join("/"));return t})),i=a.map((function(e){return e[r.valueField]})).filter((function(e){return n.includes(e)}));Object.assign(this,{selectOption:a}),this.$emit("change",i,t)}else{var c=this.selectOption.map((function(e){return e[r.valueField]})).filter((function(e){return n.includes(e)}));this.$emit("change",c,t)}},onOpenModal:function(){this.visible=!0},onScrollIntoView:function(e){this.$nextTick((function(){var t,r,n=document.querySelector(".picker-modal-tree");n?null===(t=document.querySelector(".picker-modal-tree #c_".concat(e)))||void 0===t||t.scrollIntoView({behavior:"smooth",block:"center"}):null===(r=document.getElementById("c_".concat(e)))||void 0===r||r.scrollIntoView({behavior:"smooth",block:"center"})}))},onSelectTreeData:function(e){var t=e.treeSelectedKeys,r=e.treeData,n=e.selectOption;Object.assign(this,{selectedKeys:t,treeSelectOption:n,treeData:r})},onRemoveOption:function(e){this.selectedKeys=this.selectedKeys.filter((function(t){return t!==e})),this.treeSelectOption=this.treeSelectOption.filter((function(t){return t.key!==e})),this.onScrollIntoView(e)},onOk:function(){if(null===this.selectedKeys||Array.isArray(this.selectedKeys)&&0===this.selectedKeys.length)return this.$message.info("请先选择单位");this.$emit("change",this.selectedKeys),Object.assign(this,{visible:!1,selectOption:this.treeSelectOption}),this.$emit("ok",{selectedValue:this.selectedValue,selectOption:this.treeSelectOption})},onCancel:function(){this.visible=!1},onRefreshTree:function(e){this.$ref.treeSearch&&this.$ref.treeSearch.handleTreeData(e)}}},j=S,w=(r("8ecc"),r("2877")),x=Object(w["a"])(j,n,a,!1,null,null,null);t["a"]=x.exports},aef4:function(e,t,r){"use strict";r("363d")},b047:function(e,t,r){var n=r("1a8c"),a=r("408c"),i=r("b4b0"),c="Expected a function",l=Math.max,o=Math.min;function s(e,t,r){var s,u,d,f,p,y,h=0,v=!1,b=!1,m=!0;if("function"!=typeof e)throw new TypeError(c);function g(t){var r=s,n=u;return s=u=void 0,h=t,f=e.apply(n,r),f}function O(e){return h=e,p=setTimeout(j,t),v?g(e):f}function k(e){var r=e-y,n=e-h,a=t-r;return b?o(a,d-n):a}function S(e){var r=e-y,n=e-h;return void 0===y||r>=t||r<0||b&&n>=d}function j(){var e=a();if(S(e))return w(e);p=setTimeout(j,k(e))}function w(e){return p=void 0,m&&s?g(e):(s=u=void 0,f)}function x(){void 0!==p&&clearTimeout(p),h=0,s=y=u=p=void 0}function A(){return void 0===p?f:w(a())}function D(){var e=a(),r=S(e);if(s=arguments,u=this,y=e,r){if(void 0===p)return O(y);if(b)return clearTimeout(p),p=setTimeout(j,t),g(y)}return void 0===p&&(p=setTimeout(j,t)),f}return t=i(t)||0,n(r)&&(v=!!r.leading,b="maxWait"in r,d=b?l(i(r.maxWait)||0,t):d,m="trailing"in r?!!r.trailing:m),D.cancel=x,D.flush=A,D}e.exports=s},b4b0:function(e,t,r){var n=r("8d74"),a=r("1a8c"),i=r("ffd6"),c=NaN,l=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,u=parseInt;function d(e){if("number"==typeof e)return e;if(i(e))return c;if(a(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=a(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=o.test(e);return r||s.test(e)?u(e.slice(2),r?2:8):l.test(e)?c:+e}e.exports=d},b85c:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("d9e2");var n=r("06c5");function a(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Object(n["a"])(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){o=!0,c=e},f:function(){try{l||null==r["return"]||r["return"]()}finally{if(o)throw c}}}}},f2be:function(e,t,r){"use strict";r.d(t,"f",(function(){return o})),r.d(t,"g",(function(){return s})),r.d(t,"a",(function(){return u})),r.d(t,"h",(function(){return d})),r.d(t,"b",(function(){return f})),r.d(t,"e",(function(){return p})),r.d(t,"d",(function(){return y})),r.d(t,"c",(function(){return h}));var n=r("2909"),a=(r("d3b7"),r("159b"),r("ac16"),r("f8c9"),r("4de4"),r("4ec9"),r("3ca3"),r("ddb0"),r("d9e2"),r("a630"),r("6062"),r("0644")),i=r.n(a),c=r("60ed"),l=r.n(c);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{pkey:"pkey",key:"key",title:"title",children:"children"},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pkey:"pkey",children:"children"};if(!Array.isArray(e))return console.error("请传入一个list数组");e.forEach((function(n){var a=n[r.pkey];a&&e.forEach((function(e){var c=e;if(t)for(var l in t)String(l)!==String(t[l])&&(Array.isArray(c[t[l]])||c[t[l]]instanceof Object?c[l]=i()(c[t[l]]):c[l]=c[t[l]],Reflect.deleteProperty(c,t[l]));c&&c.key===a&&(c[r.children]=c[r.children]||[],c[r.children].push(n))}))}));var n=e.every((function(e){return e[t.pkey]}));return n?console.error("至少有一个根节点pid为null数组或传入一个空数组",e):e.filter((function(e){return!e[r.pkey]}))}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{pkey:"pkey",key:"key",title:"title"},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";if(!Array.isArray(e))return console.error("请传入一个tree数组");var a=[],c=i()(e),l=Object(n["a"])(c);while(l.length){var o=l.shift(),s=o[r];if(s&&l.push.apply(l,Object(n["a"])(s)),t)for(var u in t)String(u)!==String(t[u])&&(Array.isArray(o[t[u]])||o[t[u]]instanceof Object?o[u]=i()(o[t[u]]):o[u]=o[t[u]],Reflect.deleteProperty(o,t[u]));Reflect.deleteProperty(o,r),a.push(o)}return 0===a.length?e:a}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pkey:"pkey",key:"key",title:"title"};if(!Array.isArray(e))return console.error("请传入一个tree数组");var n=i()(e),a=s(n,r);return a.filter((function(e){return!!t(e)}))}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key";if(!Array.isArray(e))return console.error("请传入一个数组");if(!e||0===e.length||!l()(e[0]))return Array.from(new Set(e));var r=new Map;return e.forEach((function(e){if(!e[t])throw new Error("prop参数不匹配，在节点找不到对应的值");r.set(e[t],e)})),0!==r.size?Array.from(r.values()):void 0}function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pkey:"pkey",key:"key",title:"title"},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{pkey:"pkey",key:"key"};if(!Array.isArray(e))return console.error("请传入一个tree数组");var a=new Set,i=s(e,r);function c(e,t){e.forEach((function(r){String(r[n.key])===String(t)&&(a.add(r[n.key]),r.isLeaf&&a.delete(r[n.key]),c(e,r[n.pkey]))}))}return c(i,t),Array.from(a).reverse().filter((function(e){return e!==t}))}function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"key",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{pkey:"pkey",key:"key",title:"title"},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{pkey:"pkey",key:"key"};if(!Array.isArray(e))return console.error("请传入一个tree数组");var i=new Set,c=s(e,n);function l(e,t){e.forEach((function(n){String(n[a.key])===String(t)&&(i.add(n[r]),l(e,n[a.pkey]))}))}return l(c,t),Array.from(i).reverse()}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"key",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{pkey:"pkey",key:"key",title:"title"};if(!Array.isArray(e))return console.error("请传入一个tree数组");var a=s(e,n),i=a.filter((function(e){return String(e[r])===String(t)}));return Array.isArray(i)&&1===i.length?i[0]:null}function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{key:"key",label:"title"};if(!Array.isArray(e))return console.error("请传入一个字典数组");var n=e.filter((function(e){return String(e[r.key])===String(t)}));return n&&0!==n.length?n[0][r.label]:""}},ffd6:function(e,t,r){var n=r("3729"),a=r("1310"),i="[object Symbol]";function c(e){return"symbol"==typeof e||a(e)&&n(e)==i}e.exports=c}}]);
//# sourceMappingURL=chunk-0466bf0a.8d4d2ad5.js.map