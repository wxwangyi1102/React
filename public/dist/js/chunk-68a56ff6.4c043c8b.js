(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68a56ff6"],{"0842":function(e,t,a){"use strict";a("c62d")},4200:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ec-container",{staticClass:"info",attrs:{height:"100%","color-code":"001",title:"基地单元注销","show-title":""}},[a("ec-container-body",[a("ec-panel",{attrs:{auto:!1}},[a("ec-panel-toolbar",[a("ec-query-panel",{attrs:{defaultFold:!0},on:{query:e.onQuery,reset:e.onReset},scopedSlots:e._u([{key:"inner",fn:function(){return[a("ec-query-item",{attrs:{label:"烟叶类型"}},[a("ec-select",{attrs:{placeholder:"请选择烟叶类型"},model:{value:e.query.leafTypeCode,callback:function(t){e.$set(e.query,"leafTypeCode",t)},expression:"query.leafTypeCode"}},e._l(e.leafTypeList,(function(t){return a("a-select-option",{key:t.leafTypeCode},[e._v(" "+e._s(t.leafTypeName)+" ")])})),1)],1),a("ec-query-item",{attrs:{label:"基地单元名称"}},[a("a-input",{attrs:{placeholder:"请输入基地单元名称"},model:{value:e.query.baseCellName,callback:function(t){e.$set(e.query,"baseCellName","string"===typeof t?t.trim():t)},expression:"query.baseCellName"}})],1),a("ec-query-item",{attrs:{label:"基地单元编码"}},[a("a-input",{attrs:{placeholder:"请输入基地单元编码"},model:{value:e.query.baseCellCode,callback:function(t){e.$set(e.query,"baseCellCode","string"===typeof t?t.trim():t)},expression:"query.baseCellCode"}})],1)]},proxy:!0}])},[a("ec-query-item",{attrs:{label:"无合作关系年数（大于等于）"}},[a("a-input-number",{attrs:{placeholder:"请输入无合作关系年数"},model:{value:e.query.relieveYear,callback:function(t){e.$set(e.query,"relieveYear","string"===typeof t?t.trim():t)},expression:"query.relieveYear"}})],1),a("ec-query-item",{attrs:{label:"商业单位"}},[a("select-picker",{attrs:{title:"选择商业单位",placeholder:"请选择商业单位",lazy:!1,search:!1,fetchData:e.onFetchBusinessOrgList},model:{value:e.query.businesOrgCode,callback:function(t){e.$set(e.query,"businesOrgCode",t)},expression:"query.businesOrgCode"}})],1),a("ec-query-item",{attrs:{label:"业务年度"}},[a("a-input-number",{attrs:{placeholder:"请输入业务年度"},model:{value:e.query.busiYear,callback:function(t){e.$set(e.query,"busiYear","string"===typeof t?t.trim():t)},expression:"query.busiYear"}})],1)],1),a("ec-divider")],1),a("ec-panel-body",[a("ec-v-layout",{attrs:{auto:!1}},[a("ec-v-item",{attrs:{height:"auto"}},[a("ec-panel-toolbar",[a("ec-panel-item-left",[a("a-button",{attrs:{type:"primary"},on:{click:e.onCancellation}},[e._v("注销")]),a("a-button",{attrs:{type:"primary",ghost:""},on:{click:e.onCancellationUnit}},[e._v("已注销单位")])],1),a("ec-panel-item-right",[a("div",{staticClass:"unit-box"},[a("span",[e._v("集中交易年度："+e._s(e.busiYear)+"年")]),a("div",{staticClass:"select"},[e._v(" 重量单位： "),a("ec-select",{attrs:{showSearch:""},model:{value:e.weightUnit,callback:function(t){e.weightUnit="string"===typeof t?t.trim():t},expression:"weightUnit"}},e._l(e.weightUnitList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("div",{staticClass:"select"},[e._v(" 面积单位： "),a("ec-select",{attrs:{showSearch:""},model:{value:e.areaUnit,callback:function(t){e.areaUnit="string"===typeof t?t.trim():t},expression:"areaUnit"}},e._l(e.areaUnitList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1)])])],1)],1),a("ec-v-item",[a("ec-table",{ref:"tableRef",attrs:{loading:e.loading,"show-overflow":"",height:"100%",auto:!1,pagination:e.pagination,data:e.tableData},on:{"page-action":e.onPageAction,"checkbox-all":e.onSelAllTableData,"checkbox-change":e.onSelTableData}},[a("ec-table-col",{attrs:{type:"checkbox",width:"60",align:"center"}}),a("ec-table-col",{attrs:{type:"seq",title:"序号",width:"50",align:"center"}}),a("ec-table-col",{attrs:{field:"busiYear",title:"创建年度",align:"center","min-width":"100"}}),a("ec-table-col",{attrs:{field:"provOrgName",title:"省公司",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"cityOrgName",title:"市公司",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"provDivisionName",title:"省",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"cityDivisionName",title:"地(州、市)",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"counDivisionName",title:"县(区、市)",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"baseCellCode",title:"基地单元编码",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"baseCellName",title:"基地单元名称",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"leafTypeCode",title:"烟叶类型","min-width":"100",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(" "+e._s(e._f("getNameBy")(i.leafTypeCode,e.leafTypeObj))+" ")])]}}])}),a("ec-table-col",{attrs:{field:"leafVarietyName",title:"烟叶品种",align:"center","min-width":"100"}}),a("ec-table-col",{attrs:{field:"fieldArea",title:"基本烟田面积","min-width":"120",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.fieldArea,e.areaUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"plantArea",title:"种植面积","min-width":"100",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.plantArea,e.areaUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"buyWeight",title:"收购量","min-width":"100",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.buyWeight,e.weightUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"techSuppOrg",title:"技术依托单位",align:"center","min-width":"150"}})],1)],1)],1)],1)],1),a("list-modal",{ref:"editRef",attrs:{busiYear:e.busiYear,replaceFields:e.replaceFields,businessOrgList:e.businessOrgList,leafTypeObj:e.leafTypeObj}})],1)],1)},n=[],r=a("5530"),l=a("c7eb"),o=a("1da1"),s=(a("6198"),a("6fc0")),c=a.n(s),u=(a("d81d"),a("d3b7"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ec-drawer",{attrs:{title:"已注销单位",visible:e.visible,size:"large","is-confirm":!0},on:{close:e.onCancel}},[a("ec-container",{attrs:{height:"100%"}},[a("ec-container-body",[a("ec-panel",{attrs:{auto:!1}},[a("ec-panel-toolbar",[a("ec-query-panel",{attrs:{defaultFold:!0},on:{query:e.onQuery,reset:e.onReset}},[a("ec-query-item",{attrs:{label:"注销年度"}},[a("a-input-number",{attrs:{min:2e3,max:2099},model:{value:e.query.cancelYear,callback:function(t){e.$set(e.query,"cancelYear",t)},expression:"query.cancelYear"}})],1),a("ec-query-item",{attrs:{label:"商业单位"}},[a("select-picker",{attrs:{title:"选择商业单位",lazy:!1,search:!1,fetchData:e.onFetchBusinessOrgList},on:{ok:e.getBizCode},model:{value:e.query.businesOrgCode,callback:function(t){e.$set(e.query,"businesOrgCode",t)},expression:"query.businesOrgCode"}})],1),a("ec-query-item",{attrs:{label:"办理依据"}},[a("a-input",{attrs:{placeholder:""},model:{value:e.query.remark,callback:function(t){e.$set(e.query,"remark","string"===typeof t?t.trim():t)},expression:"query.remark"}})],1)],1),a("ec-divider")],1),a("ec-panel-body",[a("ec-v-layout",{attrs:{auto:!1}},[a("ec-v-item",{attrs:{height:"auto"}},[a("ec-panel-toolbar",[a("ec-panel-item-left",[a("a-button",{attrs:{type:"primary"},on:{click:e.onExport}},[e._v("导出")])],1)],1)],1),a("ec-v-item",[a("ec-table",{ref:"tableRef",attrs:{loading:e.loading,"show-overflow":"",height:"100%",auto:!1,pagination:e.pagination,data:e.tableData},on:{"page-action":e.onPageAction}},[a("ec-table-col",{attrs:{type:"seq",title:"序号",width:"50",align:"center"}}),a("ec-table-col",{attrs:{field:"cancelYear",title:"注销年度",align:"center","min-width":"100"}}),a("ec-table-col",{attrs:{field:"cancelTime",title:"注销日期",align:"center","min-width":"100"}}),a("ec-table-col",{attrs:{field:"provOrgName",title:"省公司",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"cityOrgName",title:"市公司",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"provDivisionName",title:"省",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"cityDivisionName",title:"地(州、市)",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"counDivisionName",title:"县(区、市)",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"baseCellCode",title:"基地单元编码",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"baseCellName",title:"基地单元名称",align:"center","min-width":"150"}}),a("ec-table-col",{attrs:{field:"leafTypeCode",title:"烟叶类型","min-width":"100",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(" "+e._s(e._f("getNameBy")(i.leafTypeCode,e.leafTypeObj))+" ")])]}}])}),a("ec-table-col",{attrs:{field:"leatVarietyName",title:"烟叶品种",align:"center","min-width":"100"}}),a("ec-table-col",{attrs:{field:"fieldArea",title:"基本烟田面积(万亩)","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.fieldArea,e.areaUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"plantArea",title:"种植面积(万亩)","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.plantArea,e.areaUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"buyWeight",title:"收购量(万担)","min-width":"150",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",[e._v(e._s(e._f("amountFormat")(i.buyWeight,e.weightUnit)))])]}}])}),a("ec-table-col",{attrs:{field:"remark",title:"办理依据",align:"center","min-width":"150"}})],1)],1)],1)],1)],1)],1),a("ec-container-footer",[a("a-button",{on:{click:e.onCancel}},[e._v("关闭")])],1)],1)],1)],1)}),d=[],f=(a("a9e3"),a("6ea6")),b={name:"ListModal",components:{SelectPicker:c.a},props:{businessOrgList:{type:Array,default:function(){return[]}},busiYear:{type:Number,default:0},replaceFields:{type:Object,default:function(){}},leafTypeObj:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,visible:!1,bizCode:null,query:{},tableData:[],pagination:{pageNumber:1,pageSize:10,total:0},weightUnit:"500000",areaUnit:"10000"}},methods:{show:function(){this.visible=!0,this.query={cancelYear:this.busiYear,busiYear:this.busiYear},this.onQuery()},onFetchBusinessOrgList:function(){var e=this;return new Promise((function(t){var a=Object(f["treeFormatList"])(e.businessOrgList,e.replaceFields);t(a)}))},onPageAction:function(e,t){var a=this;if(this.query.clearYear||this.query.busiYear){var i=Object(r["a"])({pageNo:e,pageSize:t},this.query);this.loading=!0,i.businesOrgCode=this.bizCode,this.$apis.apm.baseCancellation.cancellationedQuery(i).then((function(e){a.loading=!1,a.tableData=(null===e||void 0===e?void 0:e.rows)||[],a.pagination.total=null===e||void 0===e?void 0:e.totalRows})).catch((function(){a.loading=!1}))}},onQuery:function(){var e,t;null===(e=this.$refs)||void 0===e||null===(t=e.tableRef)||void 0===t||t.pageAction(1,10)},getBizCode:function(e){var t=e.selectOption;this.bizCode=null===t||void 0===t?void 0:t.bizCode},onReset:function(){this.query={cancelYear:this.busiYear,busiYear:this.busiYear},this.onQuery()},onCancel:function(){this.visible=!1,this.onReset()},onExport:function(){}}},p=b,h=a("2877"),y=Object(h["a"])(p,u,d,!1,null,null,null),m=y.exports,g={name:"Index",components:{ListModal:m,SelectPicker:c.a},data:function(){return{loading:!1,query:{},weightUnitList:[],areaUnitList:[],weightUnit:"500000",areaUnit:"10000",tableData:[],pagination:{pageNumber:1,pageSize:10,total:0},selTableData:[],userInfo:{},busiYear:0,leafTypeList:[],businessOrgList:[],replaceFields:{pkey:"parentOrgUniqueCode",title:"orgName",key:"orgUniqueCode",children:"children"}}},computed:{leafTypeObj:function(){return this.leafTypeList.map((function(e){return{key:e.leafTypeCode,title:e.leafTypeName}}))}},created:function(){var e=this;return Object(o["a"])(Object(l["a"])().mark((function t(){var a;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$router.history.current.query.appCode,e.appCode=a||"CM",e.handleGetEnum(),e.handleQueryLeafTypeList(),t.next=6,e.handleGetOrgCode();case 6:return t.next=8,e.handleGetBusiYear();case 8:return t.next=10,e.handleQueryBusinessOrgList();case 10:case"end":return t.stop()}}),t)})))()},methods:{handleGetEnum:function(){var e=this,t={enumTypeCodes:["WEIGHT_UNIT","AREA_UNIT"]};this.$apis.bim.enumType.query(t).then((function(t){var a=(null===t||void 0===t?void 0:t.enumMap)||{};e.weightUnitList=a.WEIGHT_UNIT||[],e.areaUnitList=a.AREA_UNIT||[]}))},handleQueryLeafTypeList:function(){var e=this;this.$apis.bim.leafType.query({}).then((function(t){e.leafTypeList=(null===t||void 0===t?void 0:t.rows)||[]}))},handleGetOrgCode:function(){var e=this;return Object(o["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apis.bim.curOrg.get({});case 2:e.userInfo=t.sent;case 3:case"end":return t.stop()}}),t)})))()},onPageAction:function(e,t){var a=this;if(this.busiYear){var i=Object(r["a"])({pageNo:e,pageSize:t},this.query);this.loading=!0,this.$apis.apm.baseCancellation.query(i).then((function(e){a.loading=!1,a.tableData=(null===e||void 0===e?void 0:e.rows)||[],a.pagination.total=null===e||void 0===e?void 0:e.totalRows})).catch((function(){a.loading=!1}))}},onQuery:function(){this.$refs.tableRef.pageAction(1,10)},onReset:function(){this.businesOrgCodeTemp=void 0,this.query={busiYear:this.busiYear},this.onQuery()},handleGetBusiYear:function(){var e=this;return Object(o["a"])(Object(l["a"])().mark((function t(){var a,i,n,r;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={orgCode:null===(a=e.userInfo)||void 0===a?void 0:a.orgUniqueCode,bizCode:null===(i=e.userInfo)||void 0===i?void 0:i.bizCode,yearTypeCode:"CENTER_YEAR",appCode:e.appCode},t.next=3,e.$apis.bim.busiYear.get(n);case 3:r=t.sent,e.busiYear=r.yearValue,e.query.busiYear=e.busiYear,e.onQuery();case 7:case"end":return t.stop()}}),t)})))()},handleQueryBusinessOrgList:function(){var e=this;return Object(o["a"])(Object(l["a"])().mark((function t(){var a,i;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={busiYear:e.busiYear,orgTypeEk:"TOBACCO",orgLevelEk:"2",parentOrgUniqueCode:e.userInfo.orgUniqueCode},t.next=3,e.$apis.bim.org.queryBy(a);case 3:i=t.sent,e.businessOrgList=i.rows||[];case 5:case"end":return t.stop()}}),t)})))()},onFetchBusinessOrgList:function(){var e=this;return new Promise((function(t){var a=Object(f["treeFormatList"])(e.businessOrgList,e.replaceFields);t(a)}))},onSelTableData:function(e){var t=e.records;this.selTableData=t},onSelAllTableData:function(e){var t=e.records;this.selTableData=t},onCancellationUnit:function(){this.$refs.editRef.show()},onCancellation:function(){var e=this,t=this.$createElement;this.selTableData.length?this.$confirm({title:"是否执行该操作?",content:function(){return t("div",{style:"color:red;"},["是否确认注销选中的数据，确认请点击'确认'按钮，取消点击'取消'按钮。"])},onOk:function(){var t={bmUnitIds:e.selTableData.map((function(e){return e.bmUnitId})),busiYear:e.busiYear};e.loading=!0,e.$apis.apm.baseCancellation.cancellation(t).then((function(){e.loading=!1,e.$message.error("注销成功"),e.onQuery()}))}}):this.$message.error("请选择一条数据再注销")}}},v=g,w=(a("0842"),Object(h["a"])(v,i,n,!1,null,"6cdcdbe2",null));t["default"]=w.exports},5530:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("159b"),a("dbb4");function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}},c62d:function(e,t,a){}}]);
//# sourceMappingURL=chunk-68a56ff6.4c043c8b.js.map