(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3950f57a"],{"09b5":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ec-container",{attrs:{height:"auto"}},[r("ec-container-header",[r("ec-panel-toolbar",[r("ec-panel-item-left",[r("ec-header",{attrs:{title:"交易衔接量锁定",icon:"onetomany","color-code":"003"}})],1),r("ec-panel-item-right",[r("div",[e._v("集中交易年度："+e._s(e.busiYear)+"年")])])],1)],1),r("ec-container-body",[r("ec-panel",[r("ec-panel-toolbar",[r("ec-query-panel",{attrs:{defaultFold:!0},on:{query:e.init,reset:e.resetHandle}},[r("ec-query-item",{attrs:{label:"锁定状态"}},[r("ec-select",{attrs:{showSearch:"",placeholder:"请选择锁定状态"},model:{value:e.queryItems.lockState,callback:function(t){e.$set(e.queryItems,"lockState",t)},expression:"queryItems.lockState"}},e._l(e.lockStateOptions,(function(t){return r("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1),r("ec-query-item",{attrs:{label:"单位类型"}},[r("a-select",{attrs:{showSearch:"",placeholder:"请选择单位类型"},model:{value:e.queryItems.orgType,callback:function(t){e.$set(e.queryItems,"orgType",t)},expression:"queryItems.orgType"}},e._l(e.memberOrgTypeOptions,(function(t){return r("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1),r("ec-query-item",{attrs:{label:"会员单位"}},[r("select-picker",{attrs:{title:"选择会员单位",lazy:!1,search:!1,fetchData:e.getfetchData},on:{ok:e.handlerorgTypeChange},model:{value:e.lockCode,callback:function(t){e.lockCode=t},expression:"lockCode"}})],1)],1),r("ec-divider")],1),r("ec-panel-item",[e.islock?r("ec-panel-item-left",[r("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handlelockall("1")}}},[e._v("全部锁定")]),r("a-button",{on:{click:function(t){return e.handlelockall("0")}}},[e._v("全部解锁")])],1):e._e()],1),r("ec-panel-body",[r("ec-v-layout",[r("ec-v-item",[r("ec-table",{ref:"xTable1",attrs:{height:"636","header-align":"center",align:"center","show-overflow":"",data:e.tableData}},[r("ec-table-col",{attrs:{type:"seq",title:"序号",width:"50"}}),r("ec-table-col",{attrs:{field:"busiYear",title:"集中交易年度"}}),r("ec-table-col",{attrs:{field:"lockOrgCode",title:"会员单位"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(e._s(e.useGetname(r.lockOrgCode)))]}}])}),r("ec-table-col",{attrs:{field:"lockState",title:"锁定状态"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(e._s("1"===r.lockState?"已锁定":"未锁定"))]}}])}),r("ec-table-col",{attrs:{title:"操作",width:"190"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("a-button",{attrs:{disabled:"0"!==a.lockState,type:"link"},on:{click:function(t){return e.handlelock(a,"1")}}},[e._v("锁定")]),r("a-button",{attrs:{disabled:"1"!==a.lockState,type:"link"},on:{click:function(t){return e.handlelock(a,"0")}}},[e._v("解锁")])]}}])})],1)],1)],1)],1)],1)],1)],1)},n=[],o=r("c7eb"),i=r("1da1"),c=r("5530"),l=(r("6198"),r("6fc0")),s=r.n(l),u=(r("d3b7"),r("d81d"),r("7db0"),r("6ea6")),d={name:"Lock",components:{SelectPicker:s.a},data:function(){return{orgType:"",orgCode:"",appCode:"",lockCode:"",bizCode:"",islock:!0,inquirevisible:!1,records:[],lockStateOptions:[{label:"全部",value:""},{label:"未锁定",value:"0"},{label:"已锁定",value:"1"}],memberOrgTypeOptions:[{label:"全部",value:""},{label:"商业企业",value:"TOBACCO"},{label:"工业企业",value:"INDUSTRY"},{label:"进出口企业",value:"EXPORT"}],treeParams:{bizCode:"11000001000000000000",orgTypeEk:"EXPORT,INDUSTRY,TOBACCO",orgLevelEk:"2",paramMap:{isCorporation:"1"}},queryItems:{lockState:"",orgType:""},tableData:[],treeData:[],rules:{}}},created:function(){this.onGetuserinfo()},computed:{_apis:function(){return this.$apis.centre.lock},_apply:function(){return this.$apis.centre.apply},appConfig:function(){return this.$store.getters.getAppConfig},busiYear:function(){var e,t;return null===(e=this.$store.getters.getAppConfig)||void 0===e||null===(t=e.yearValueMap)||void 0===t?void 0:t.CENTER_YEAR}},methods:{init:function(){var e=this,t=Object(c["a"])({},this.queryItems);t.busiYear=this.busiYear,!t.lockState&&delete t.lockState,!t.orgType&&delete t.orgType,this._apis.query(t).then((function(t){e.tableData=t.rows}))},resetHandle:function(){},handlelock:function(e,t){var r=this,a=e.asOrgLockId;$ec.showLoading();var n={lockState:t,asOrgLockIds:[a],busiYear:this.busiYear};this._apis.statusOn(n).then((function(e){if(e.ifCan){r.init();var a="1"===t?"锁定成功":"解锁成功";r.$message.success(a)}else r.$message.error(e.returnMess)})).finally((function(){$ec.hideLoading()}))},handlelockall:function(e){var t=this;$ec.showLoading();var r=this.tableData.map((function(e){return e.asOrgLockId})),a={asOrgLockIds:r,lockState:e,busiYear:this.busiYear};this._apis.statusOn(a).then((function(r){if(r.ifCan){var a="1"===e?"全部锁定成功":"全部解锁成功";t.$message.success(a),t.init()}else t.$message.error(r.returnMess)})).finally((function(){$ec.hideLoading()}))},handlerorgTypeChange:function(e){var t=e.selectOption.val;this.queryItems.lockCode=t},onGetuserinfo:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){var r,a,n,i;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apis.bpm.executionEnter.getOrgCode({});case 2:r=t.sent,a=r.orgCode,n=r.orgTypeEk,i=r.bizCode,e.orgCode=a,e.bizCode=i,e.orgType="TOBACCO"===n?"O":"I",e.treeParams.bizYear=e.busiYear,e.treeGetlist(),e.init();case 12:case"end":return t.stop()}}),t)})))()},treeGetlist:function(){var e=this;return Object(i["a"])(Object(o["a"])().mark((function t(){var r,a,n;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={pkey:"parentBizCode",title:"orgName",key:"bizCode",children:"children"},e.treeParams.bizCode=null===(r=e.appConfig)||void 0===r?void 0:r.bizCode,t.next=4,e._apply.getreeDate(e.treeParams);case 4:n=t.sent,e.treeData=Object(u["treeFormatList"])(null===n||void 0===n?void 0:n.rows,a);case 6:case"end":return t.stop()}}),t)})))()},getfetchData:function(){var e=this;return new Promise((function(t){var r=Object(u["cloneDeep"])(e.treeData);t(r)}))},useGetname:function(e){var t,r;return(null===(t=this.treeData)||void 0===t||null===(r=t.find((function(t){return t.key===e})))||void 0===r?void 0:r.title)||""}}},p=d,b=(r("0b15"),r("2877")),f=Object(b["a"])(p,a,n,!1,null,"dcc94642",null);t["default"]=f.exports},"0b15":function(e,t,r){"use strict";r("e16e")},5530:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("b64b"),r("a4d3"),r("4de4"),r("d3b7"),r("e439"),r("159b"),r("dbb4");function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},e16e:function(e,t,r){}}]);
//# sourceMappingURL=chunk-3950f57a.d3615684.js.map