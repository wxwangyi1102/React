{"version":3,"sources":["webpack:///./src/views/apm/daily/purchase-sale/AddModal.vue?4ec9","webpack:///./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/esm/objectSpread2.js","webpack:///./src/views/apm/daily/purchase-sale/Index.vue?30fd","webpack:///./src/views/apm/daily/purchase-sale/AddModal.vue?683c","webpack:///src/views/apm/daily/purchase-sale/AddModal.vue","webpack:///./src/views/apm/daily/purchase-sale/AddModal.vue?057b","webpack:///./src/views/apm/daily/purchase-sale/AddModal.vue","webpack:///./src/views/apm/daily/purchase-sale/DetailModal.vue?c2a2","webpack:///src/views/apm/daily/purchase-sale/DetailModal.vue","webpack:///./src/views/apm/daily/purchase-sale/DetailModal.vue?96a7","webpack:///./src/views/apm/daily/purchase-sale/DetailModal.vue","webpack:///src/views/apm/daily/purchase-sale/Index.vue","webpack:///./src/views/apm/daily/purchase-sale/Index.vue?2679","webpack:///./src/views/apm/daily/purchase-sale/Index.vue"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","getOwnPropertyDescriptors","defineProperties","render","_vm","this","_h","$createElement","_c","_self","attrs","on","onQuery","onReset","scopedSlots","_u","fn","model","queryParams","callback","$$v","$set","expression","proxy","_l","item","leafTypeCode","_v","_s","leafTypeName","onSelWeightUnit","weightUnit","enumKey","name","onAdd","onConfirm","onDelete","_e","staticStyle","busiYear","curWeightUnit","ref","tableData","loading","footerMethod","onSelAllTableData","onSelTableData","row","_f","createTime","leafTypeObj","total","zhej","gsptgx","jdy","ckbhgx","$event","onEdit","onDetail","onBaseDetail","orgList","leafTypeList","planYearList","staticRenderFns","staticClass","title","visible","onclose","formData","formRules","isEdit","fetchGetTree","onBeforeOk","onSelOrg","leafTypeDisabled","isDetail","tableLoading","type","operateType","onComputedTotal","onSaveAndAdd","onSave","components","SelectPicker","props","default","data","memberOrgCode","required","message","trigger","replaceFields","pkey","children","methods","show","resolve","addQuery","planYear","memberLevelCode","Number","toFixed","editQuery","adjustBatch","remark","res","nowDate","afterData","component","onClose","visibile","queryJdy","params","then","catch","sumNum","list","field","count","columns","AddModal","DetailModal","pagination","pageNumber","pageSize","appCode","orgCode","weightUnitList","selTableData","userInfo","isEntry","computed","appConfig","bizCode","created","beforeHandler","handleGetWeightUnitList","enumTypeCodes","handleGetOrgList","bizYear","orgTypeEk","orgLevelEk","paramMap","isCorporation","handleListToTree","parent","treeData","query","newItem","content","onOk","adjustBatchs"],"mappings":"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","file":"js/chunk-b492cbd2.008421d0.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AddModal.vue?vue&type=style&index=0&id=0870d1b8&prod&lang=less&scoped=true&\"","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty.js\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ec-container',{attrs:{\"height\":\"100%\"}},[_c('ec-container-header',[_c('ec-panel-item',[_c('ec-panel-item-left',[_c('ec-header',{attrs:{\"title\":\"工商购销调拨计划量调整登记\",\"icon\":\"onetomany\",\"color-code\":\"008\"}})],1)],1)],1),_c('ec-container-body',[_c('ec-panel',{attrs:{\"auto\":false}},[_c('ec-panel-toolbar',[_c('ec-query-panel',{attrs:{\"defaultFold\":\"\"},on:{\"query\":_vm.onQuery,\"reset\":_vm.onReset},scopedSlots:_vm._u([{key:\"inner\",fn:function(){return [_c('ec-query-item',{attrs:{\"label\":\"会员单位\"}},[_c('a-input',{attrs:{\"allowClear\":\"\",\"placeholder\":\"请输入会员单位\"},model:{value:(_vm.queryParams.memberOrgCode),callback:function ($$v) {_vm.$set(_vm.queryParams, \"memberOrgCode\", $$v)},expression:\"queryParams.memberOrgCode\"}})],1),_c('ec-query-item',{attrs:{\"label\":\"办理依据\"}},[_c('a-input',{attrs:{\"placeholder\":\"请输入办理依据\"},model:{value:(_vm.queryParams.remark),callback:function ($$v) {_vm.$set(_vm.queryParams, \"remark\", $$v)},expression:\"queryParams.remark\"}})],1)]},proxy:true}])},[_c('ec-query-item',{attrs:{\"label\":\"烟叶类型\"}},[_c('ec-select',{attrs:{\"allowClear\":\"\",\"placeholder\":\"请选择烟叶类型\"},model:{value:(_vm.queryParams.leafTypeCode),callback:function ($$v) {_vm.$set(_vm.queryParams, \"leafTypeCode\", $$v)},expression:\"queryParams.leafTypeCode\"}},_vm._l((_vm.leafTypeList),function(item){return _c('a-select-option',{key:item.leafTypeCode},[_vm._v(\" \"+_vm._s(item.leafTypeName)+\" \")])}),1)],1),_c('ec-query-item',{attrs:{\"label\":\"计划年度\"}},[_c('ec-select',{attrs:{\"placeholder\":\"请选择计划年度\"},model:{value:(_vm.queryParams.planYear),callback:function ($$v) {_vm.$set(_vm.queryParams, \"planYear\", $$v)},expression:\"queryParams.planYear\"}},_vm._l((_vm.planYearList),function(item){return _c('a-select-option',{key:item},[_vm._v(\" \"+_vm._s(item)+\" \")])}),1)],1),_c('ec-query-item',{attrs:{\"label\":\"计量单位\"}},[_c('a-select',{attrs:{\"allow-clear\":\"\",\"placeholder\":\"请选择计量单位\"},on:{\"select\":_vm.onSelWeightUnit},model:{value:(_vm.weightUnit),callback:function ($$v) {_vm.weightUnit=$$v},expression:\"weightUnit\"}},_vm._l((_vm.weightUnitList),function(item){return _c('a-select-option',{key:item.enumKey},[_vm._v(\" \"+_vm._s(item.name)+\" \")])}),1)],1)],1),_c('ec-divider')],1),_c('ec-panel-header',[(_vm.isEntry)?_c('ec-panel-item-left',[_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onAdd}},[_vm._v(\"新增\")]),_c('a-button',{attrs:{\"type\":\"default\"},on:{\"click\":_vm.onConfirm}},[_vm._v(\"确认\")]),_c('a-button',{attrs:{\"type\":\"default\"},on:{\"click\":_vm.onDelete}},[_vm._v(\"删除\")])],1):_vm._e(),_c('ec-panel-item-right',[_c('span',{staticStyle:{\"margin-right\":\"16px\"}},[_vm._v(\"业务年度：\"+_vm._s(_vm.busiYear)+\"年\")]),_c('span',[_vm._v(\"单位：\"+_vm._s(_vm.curWeightUnit.name))])])],1),_c('ec-panel-body',[_c('ec-table',{ref:\"table\",attrs:{\"border\":\"\",\"show-footer\":\"\",\"show-overflow\":\"\",\"highlight-current-row\":\"\",\"height\":\"100%\",\"auto\":false,\"data\":_vm.tableData,\"loading\":_vm.loading,\"footer-method\":_vm.footerMethod},on:{\"checkbox-all\":_vm.onSelAllTableData,\"checkbox-change\":_vm.onSelTableData}},[_c('ec-table-col',{attrs:{\"type\":\"checkbox\",\"width\":\"50\",\"align\":\"center\"}}),_c('ec-table-col',{attrs:{\"type\":\"seq\",\"width\":\"60\",\"title\":\"序号\",\"align\":\"center\"}}),_c('ec-table-col',{attrs:{\"field\":\"createTime\",\"title\":\"录入日期\",\"align\":\"center\",\"width\":\"120\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"dateFormat\")(row.createTime,'YYYY-MM-DD')))])]}}])}),_c('ec-table-col',{attrs:{\"field\":\"memberOrgName\",\"title\":\"会员单位\",\"align\":\"center\",\"min-width\":\"150\"}}),_c('ec-table-col',{attrs:{\"field\":\"orgName\",\"title\":\"烟叶类型\",\"align\":\"center\",\"min-width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"getNameBy\")(row.leafTypeCode,_vm.leafTypeObj)))])]}}])}),_c('ec-table-col',{attrs:{\"field\":\"total\",\"title\":\"总计\",\"align\":\"center\",\"min-width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"amountFormat\")(row.total,_vm.weightUnit)))])]}}])}),_c('ec-table-colgroup',{attrs:{\"title\":\"国内调拨计划量\"}},[_c('ec-table-col',{attrs:{\"field\":\"zhej\",\"title\":\"合计\",\"align\":\"center\",\"min-width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"amountFormat\")(row.zhej,_vm.weightUnit)))])]}}])}),_c('ec-table-col',{attrs:{\"field\":\"gsptgx\",\"title\":\"工商普通购销\",\"align\":\"center\",\"min-width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"amountFormat\")(row.gsptgx,_vm.weightUnit)))])]}}])}),_c('ec-table-col',{attrs:{\"field\":\"jdy\",\"title\":\"基地烟\",\"align\":\"center\",\"min-width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"amountFormat\")(row.jdy,_vm.weightUnit)))])]}}])})],1),_c('ec-table-colgroup',{attrs:{\"title\":\"出口调拨计划量\"}},[_c('ec-table-col',{attrs:{\"field\":\"ckbhgx\",\"title\":\"出口备货普通购销\",\"align\":\"center\",\"min-width\":\"200\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"amountFormat\")(row.ckbhgx,_vm.weightUnit)))])]}}])})],1),_c('ec-table-col',{attrs:{\"title\":\"操作\",\"align\":\"center\",\"width\":\"180\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('a-button',{attrs:{\"type\":\"link\"},on:{\"click\":function($event){return _vm.onEdit(row)}}},[_vm._v(\"编辑\")]),_c('a-button',{attrs:{\"type\":\"link\"},on:{\"click\":function($event){return _vm.onDetail(row)}}},[_vm._v(\"详细\")]),_c('a-button',{attrs:{\"type\":\"link\"},on:{\"click\":function($event){return _vm.onBaseDetail(row)}}},[_vm._v(\"基地烟详细\")])]}}])})],1)],1)],1),_c('add-modal',{ref:\"addModalRef\",attrs:{\"busiYear\":_vm.busiYear,\"orgList\":_vm.orgList,\"curWeightUnit\":_vm.curWeightUnit,\"leafTypeList\":_vm.leafTypeList,\"planYearList\":_vm.planYearList},on:{\"finish\":_vm.onQuery}}),_c('detail-modal',{ref:\"detailModalRef\",attrs:{\"leafTypeObj\":_vm.leafTypeObj}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ec-drawer',{staticClass:\"ec-draw-form\",attrs:{\"title\":_vm.title,\"visible\":_vm.visible,\"size\":\"large\",\"is-confirm\":true},on:{\"close\":_vm.onclose}},[_c('ec-container',{attrs:{\"height\":\"auto\",\"fixed\":\"top bottom\",\"color-code\":\"007\"}},[_c('ec-container-body',[_c('ec-panel',{attrs:{\"color-code\":\"001\"}},[_c('ec-panel-item',[_c('ec-form',{ref:\"formRef\",attrs:{\"model\":_vm.formData,\"rules\":_vm.formRules}},[_c('a-row',{attrs:{\"type\":\"flex\",\"gutter\":12}},[_c('a-col',{staticClass:\"first-step\",attrs:{\"span\":24}},[_c('div',{staticClass:\"sub-title\"},[_vm._v(\"第一步: 选取单位、烟叶类型、操作类型\")]),_c('div',{staticClass:\"unit\"},[_c('span',[_vm._v(\"业务年度：\"+_vm._s(_vm.formData.busiYear)+\"年；\")]),_c('span',[_vm._v(\"计量单位：\"+_vm._s(_vm.curWeightUnit.name))])])]),_c('a-col',{attrs:{\"span\":6}},[_c('a-form-model-item',{attrs:{\"label\":\"计划年度\",\"prop\":\"planYear\"}},[_c('ec-select',{attrs:{\"disabled\":_vm.isEdit,\"placeholder\":\"请选择计划年度\"},model:{value:(_vm.formData.planYear),callback:function ($$v) {_vm.$set(_vm.formData, \"planYear\", $$v)},expression:\"formData.planYear\"}},_vm._l((_vm.planYearList),function(item){return _c('a-select-option',{key:item},[_vm._v(\" \"+_vm._s(item)+\" \")])}),1)],1)],1),_c('a-col',{attrs:{\"span\":6}},[_c('a-form-model-item',{attrs:{\"label\":\"单位名称\",\"prop\":\"memberOrgCode\"}},[_c('select-picker',{attrs:{\"disabled\":_vm.isEdit,\"title\":\"选择单位\",\"lazy\":false,\"search\":false,\"fetchData\":_vm.fetchGetTree,\"placeholder\":\"请选择单位名称\",\"beforeOk\":_vm.onBeforeOk},on:{\"ok\":_vm.onSelOrg},model:{value:(_vm.formData.memberOrgCode),callback:function ($$v) {_vm.$set(_vm.formData, \"memberOrgCode\", $$v)},expression:\"formData.memberOrgCode\"}})],1)],1),_c('a-col',{attrs:{\"span\":6}},[_c('a-form-model-item',{attrs:{\"label\":\"烟叶类型\",\"prop\":\"leafTypeCode\"}},[_c('ec-select',{attrs:{\"disabled\":_vm.leafTypeDisabled || _vm.isEdit,\"placeholder\":\"请选择烟叶类型\"},on:{\"select\":_vm.onQuery},model:{value:(_vm.formData.leafTypeCode),callback:function ($$v) {_vm.$set(_vm.formData, \"leafTypeCode\", $$v)},expression:\"formData.leafTypeCode\"}},_vm._l((_vm.leafTypeList),function(item){return _c('a-select-option',{key:item.leafTypeCode},[_vm._v(\" \"+_vm._s(item.leafTypeName)+\" \")])}),1)],1)],1),_c('a-col',{attrs:{\"span\":6}},[_c('a-form-model-item',{attrs:{\"label\":\"操作类型\",\"prop\":\"operateType\"}},[_c('ec-select',{attrs:{\"disabled\":_vm.isEdit,\"placeholder\":\"请选择操作类型\"},on:{\"select\":_vm.onQuery},model:{value:(_vm.formData.operateType),callback:function ($$v) {_vm.$set(_vm.formData, \"operateType\", $$v)},expression:\"formData.operateType\"}},[_c('a-select-option',{key:\"1\"},[_vm._v(\"增量\")]),_c('a-select-option',{key:\"0\"},[_vm._v(\"减量\")])],1)],1)],1),_c('a-col',{attrs:{\"span\":24}},[_c('a-form-model-item',{attrs:{\"label\":\"办理依据\"}},[_c('a-input',{attrs:{\"disabled\":_vm.isDetail,\"autocomplete\":\"off\",\"placeholder\":\"请输入办理依据\"},model:{value:(_vm.formData.remark),callback:function ($$v) {_vm.$set(_vm.formData, \"remark\", $$v)},expression:\"formData.remark\"}})],1)],1),_c('a-col',{attrs:{\"span\":24}},[_c('div',{staticClass:\"sub-title\"},[_vm._v(\"第二步: 登记/编辑数量\")])]),_c('a-col',{attrs:{\"span\":24}},[_c('ec-table',{ref:\"tableRef\",attrs:{\"stripe\":\"\",\"border\":\"\",\"show-overflow\":\"\",\"loading\":_vm.tableLoading,\"data\":_vm.tableData}},[_c('ec-table-col',{attrs:{\"field\":\"title\",\"title\":\"\",\"align\":\"left\",\"width\":\"150\"}}),_c('ec-table-col',{attrs:{\"field\":\"total\",\"title\":\"总计\",\"align\":\"center\",\"min-width\":\"100\"}}),_c('ec-table-colgroup',{attrs:{\"title\":\"国内调拨计划量\"}},[_c('ec-table-col',{attrs:{\"field\":\"zhej\",\"title\":\"合计\",\"align\":\"center\",\"width\":\"150\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [(row.type === 'now' && !_vm.isDetail)?_c('div',[_c('a-input-number',{attrs:{\"min\":_vm.tableData[0].jdy,\"max\":_vm.formData.operateType === '0' ? _vm.tableData[0].zhej : 1000000000},on:{\"blur\":_vm.onComputedTotal},model:{value:(row.zhej),callback:function ($$v) {_vm.$set(row, \"zhej\", $$v)},expression:\"row.zhej\"}})],1):_c('span',[_vm._v(_vm._s(row.zhej))])]}}])}),_c('ec-table-col',{attrs:{\"field\":\"gsptgx\",\"title\":\"工商普通购销\",\"align\":\"center\",\"width\":\"150\"}}),_c('ec-table-col',{attrs:{\"field\":\"jdy\",\"title\":\"基地烟\",\"align\":\"center\",\"width\":\"150\"}})],1),_c('ec-table-colgroup',{attrs:{\"title\":\"出口调拨计划量\"}},[_c('ec-table-col',{attrs:{\"field\":\"ckbhgx\",\"title\":\"出口备货普通购销\",\"align\":\"center\",\"width\":\"200\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [(row.type === 'now' && !_vm.isDetail)?_c('div',[_c('a-input-number',{attrs:{\"max\":_vm.formData.operateType === '0' ? _vm.tableData[0].ckbhgx : 1000000000},on:{\"blur\":_vm.onComputedTotal},model:{value:(row.ckbhgx),callback:function ($$v) {_vm.$set(row, \"ckbhgx\", $$v)},expression:\"row.ckbhgx\"}})],1):_c('span',[_vm._v(_vm._s(row.ckbhgx))])]}}])})],1)],1)],1)],1)],1)],1)],1)],1),_c('ec-container-footer',{attrs:{\"fixed\":\"\"}},[_c('a-space',[_c('a-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},on:{\"click\":_vm.onSaveAndAdd}},[_vm._v(\"保存并新增\")]),_c('a-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},on:{\"click\":_vm.onSave}},[_vm._v(\"保存\")]),_c('a-button',{on:{\"click\":_vm.onclose}},[_vm._v(\"关闭\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <ec-drawer\r\n    :title=\"title\"\r\n    :visible=\"visible\"\r\n    size=\"large\"\r\n    @close=\"onclose\"\r\n    class=\"ec-draw-form\"\r\n    :is-confirm=\"true\"\r\n  >\r\n    <ec-container height=\"auto\" fixed=\"top bottom\" color-code=\"007\">\r\n      <ec-container-body>\r\n        <ec-panel color-code=\"001\">\r\n          <ec-panel-item>\r\n            <ec-form :model=\"formData\" :rules=\"formRules\" ref=\"formRef\">\r\n              <a-row type=\"flex\" :gutter=\"12\">\r\n                <a-col :span=\"24\" class=\"first-step\">\r\n                  <div class=\"sub-title\">第一步: 选取单位、烟叶类型、操作类型</div>\r\n                  <div class=\"unit\">\r\n                    <span>业务年度：{{ formData.busiYear }}年；</span>\r\n                    <span>计量单位：{{ curWeightUnit.name }}</span>\r\n                  </div>\r\n                </a-col>\r\n\r\n                <a-col :span=\"6\">\r\n                  <a-form-model-item label=\"计划年度\" prop=\"planYear\">\r\n                    <ec-select\r\n                      :disabled=\"isEdit\"\r\n                      placeholder=\"请选择计划年度\"\r\n                      v-model=\"formData.planYear\"\r\n                    >\r\n                      <a-select-option v-for=\"item in planYearList\" :key=\"item\">\r\n                        {{ item }}\r\n                      </a-select-option>\r\n                    </ec-select>\r\n                  </a-form-model-item>\r\n                </a-col>\r\n                <a-col :span=\"6\">\r\n                  <a-form-model-item label=\"单位名称\" prop=\"memberOrgCode\">\r\n                    <select-picker\r\n                      :disabled=\"isEdit\"\r\n                      title=\"选择单位\"\r\n                      :lazy=\"false\"\r\n                      :search=\"false\"\r\n                      :fetchData=\"fetchGetTree\"\r\n                      placeholder=\"请选择单位名称\"\r\n                      v-model=\"formData.memberOrgCode\"\r\n                      :beforeOk=\"onBeforeOk\"\r\n                      @ok=\"onSelOrg\"\r\n                    />\r\n                  </a-form-model-item>\r\n                </a-col>\r\n                <a-col :span=\"6\">\r\n                  <a-form-model-item label=\"烟叶类型\" prop=\"leafTypeCode\">\r\n                    <ec-select\r\n                      :disabled=\"leafTypeDisabled || isEdit\"\r\n                      placeholder=\"请选择烟叶类型\"\r\n                      v-model=\"formData.leafTypeCode\"\r\n                      @select=\"onQuery\"\r\n                    >\r\n                      <a-select-option v-for=\"item in leafTypeList\" :key=\"item.leafTypeCode\">\r\n                        {{ item.leafTypeName }}\r\n                      </a-select-option>\r\n                    </ec-select>\r\n                  </a-form-model-item>\r\n                </a-col>\r\n                <a-col :span=\"6\">\r\n                  <a-form-model-item label=\"操作类型\" prop=\"operateType\">\r\n                    <ec-select\r\n                      :disabled=\"isEdit\"\r\n                      placeholder=\"请选择操作类型\"\r\n                      v-model=\"formData.operateType\"\r\n                      @select=\"onQuery\"\r\n                    >\r\n                      <a-select-option key=\"1\">增量</a-select-option>\r\n                      <a-select-option key=\"0\">减量</a-select-option>\r\n                    </ec-select>\r\n                  </a-form-model-item>\r\n                </a-col>\r\n                <a-col :span=\"24\">\r\n                  <a-form-model-item label=\"办理依据\">\r\n                    <a-input\r\n                      :disabled=\"isDetail\"\r\n                      v-model=\"formData.remark\"\r\n                      autocomplete=\"off\"\r\n                      placeholder=\"请输入办理依据\"\r\n                    />\r\n                  </a-form-model-item>\r\n                </a-col>\r\n                <a-col :span=\"24\">\r\n                  <div class=\"sub-title\">第二步: 登记/编辑数量</div>\r\n                </a-col>\r\n                <a-col :span=\"24\">\r\n                  <ec-table\r\n                    ref=\"tableRef\"\r\n                    stripe\r\n                    border\r\n                    show-overflow\r\n                    :loading=\"tableLoading\"\r\n                    :data=\"tableData\"\r\n                  >\r\n                    <ec-table-col field=\"title\" title=\"\" align=\"left\" width=\"150\" />\r\n                    <ec-table-col field=\"total\" title=\"总计\" align=\"center\" min-width=\"100\" />\r\n                    <ec-table-colgroup title=\"国内调拨计划量\">\r\n                      <ec-table-col field=\"zhej\" title=\"合计\" align=\"center\" width=\"150\">\r\n                        <template #default=\"{ row }\">\r\n                          <div v-if=\"row.type === 'now' && !isDetail\">\r\n                            <a-input-number\r\n                              :min=\"tableData[0].jdy\"\r\n                              :max=\"formData.operateType === '0' ? tableData[0].zhej : 1000000000\"\r\n                              v-model=\"row.zhej\"\r\n                              @blur=\"onComputedTotal\"\r\n                            />\r\n                          </div>\r\n                          <span v-else>{{ row.zhej }}</span>\r\n                        </template>\r\n                      </ec-table-col>\r\n                      <ec-table-col\r\n                        field=\"gsptgx\"\r\n                        title=\"工商普通购销\"\r\n                        align=\"center\"\r\n                        width=\"150\"\r\n                      />\r\n                      <ec-table-col field=\"jdy\" title=\"基地烟\" align=\"center\" width=\"150\" />\r\n                    </ec-table-colgroup>\r\n                    <ec-table-colgroup title=\"出口调拨计划量\">\r\n                      <ec-table-col\r\n                        field=\"ckbhgx\"\r\n                        title=\"出口备货普通购销\"\r\n                        align=\"center\"\r\n                        width=\"200\"\r\n                      >\r\n                        <template #default=\"{ row }\">\r\n                          <div v-if=\"row.type === 'now' && !isDetail\">\r\n                            <a-input-number\r\n                              :max=\"formData.operateType === '0' ? tableData[0].ckbhgx : 1000000000\"\r\n                              v-model=\"row.ckbhgx\"\r\n                              @blur=\"onComputedTotal\"\r\n                            />\r\n                          </div>\r\n                          <span v-else>{{ row.ckbhgx }}</span>\r\n                        </template>\r\n                      </ec-table-col>\r\n                    </ec-table-colgroup>\r\n                  </ec-table>\r\n                </a-col>\r\n              </a-row>\r\n            </ec-form>\r\n          </ec-panel-item>\r\n        </ec-panel>\r\n      </ec-container-body>\r\n      <ec-container-footer fixed>\r\n        <a-space>\r\n          <a-button :loading=\"loading\" type=\"primary\" @click=\"onSaveAndAdd\">保存并新增</a-button>\r\n          <a-button :loading=\"loading\" type=\"primary\" @click=\"onSave\">保存</a-button>\r\n          <a-button @click=\"onclose\">关闭</a-button>\r\n        </a-space>\r\n      </ec-container-footer>\r\n    </ec-container>\r\n  </ec-drawer>\r\n</template>\r\n<script>\r\nimport { SelectPicker } from '@euler-material/ecm-ui';\r\nimport { treeFormatList } from '@euler-material/ecm-utils';\r\n\r\nexport default {\r\n  name: 'AddModal',\r\n  components: { SelectPicker },\r\n  props: {\r\n    busiYear: {\r\n      type: Number,\r\n      default: 0,\r\n    },\r\n    leafTypeList: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    orgList: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    planYearList: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    curWeightUnit: {\r\n      type: Object,\r\n      default: () => {},\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      loading: false,\r\n      tableLoading: false,\r\n      formData: {},\r\n      formRules: {\r\n        memberOrgCode: { required: true, message: '请选择单位', trigger: 'change' },\r\n        leafTypeCode: { required: true, message: '请选择烟叶类型', trigger: 'change' },\r\n        operateType: { required: true, message: '请选择操作类型', trigger: 'change' },\r\n      },\r\n      tableData: [],\r\n      replaceFields: {\r\n        pkey: 'parentBizCode',\r\n        title: 'orgName',\r\n        key: 'bizCode',\r\n        children: 'children',\r\n      },\r\n      // 烟叶类型禁用状态\r\n      leafTypeDisabled: false,\r\n      // 是否编辑\r\n      isEdit: false,\r\n      // 是否详情\r\n      isDetail: false,\r\n      // 弹框标题\r\n      title: '新增',\r\n    };\r\n  },\r\n  methods: {\r\n    // 显示推窗\r\n    show(data, isDetail) {\r\n      this.visible = true;\r\n      if (data) {\r\n        this.formData = data;\r\n        this.isEdit = true;\r\n        this.isDetail = isDetail;\r\n        this.onQuery();\r\n      } else {\r\n        this.formData.busiYear = this.busiYear;\r\n        if (this.leafTypeList?.length) {\r\n          this.$set(this.formData, 'leafTypeCode', this.leafTypeList[0]?.leafTypeCode);\r\n        }\r\n        if (this.planYearList?.length) {\r\n          this.$set(this.formData, 'planYear', this.planYearList[0]);\r\n        }\r\n        this.$set(this.formData, 'operateType', '1');\r\n      }\r\n    },\r\n    // 获取树组件数据\r\n    fetchGetTree() {\r\n      return new Promise((resolve) => {\r\n        const data = treeFormatList(this.orgList, this.replaceFields);\r\n        resolve(data);\r\n      });\r\n    },\r\n    // 查询\r\n    onQuery() {\r\n      if (this.formData.adjustBatch) {\r\n        this.editQuery();\r\n      } else {\r\n        this.addQuery();\r\n      }\r\n    },\r\n    // 新增查询\r\n    addQuery() {\r\n      if (\r\n        this.formData.busiYear &&\r\n        this.formData.planYear &&\r\n        this.formData.memberLevelCode &&\r\n        this.formData.memberOrgCode &&\r\n        this.formData.leafTypeCode\r\n      ) {\r\n        const params = {\r\n          busiYear: this.formData.busiYear,\r\n          planYear: this.formData.planYear,\r\n          memberLevelCode: this.formData.memberLevelCode,\r\n          memberOrgCode: this.formData.memberOrgCode,\r\n          leafTypeCode: this.formData.leafTypeCode,\r\n        };\r\n        this.tableLoading = true;\r\n        this.$apis.apm.dailyPurchaseSale.queryDaily(params).then((res) => {\r\n          const data = res.rows[0] || {};\r\n          this.tableData = [\r\n            {\r\n              type: 'before',\r\n              title: '调整前',\r\n              zhej: (Number(data.gsptgx) + Number(data.jdy)) / Number(this.curWeightUnit.enumKey),\r\n              gsptgx: Number(data.gsptgx) / Number(this.curWeightUnit.enumKey),\r\n              jdy: Number(data.jdy) / Number(this.curWeightUnit.enumKey),\r\n              ckbhgx: Number(data.ckbhgx) / Number(this.curWeightUnit.enumKey),\r\n              total: (Number(data.zhej) + Number(data.ckbhgx)) / Number(this.curWeightUnit.enumKey),\r\n            },\r\n            {\r\n              type: 'now',\r\n              title: '本次调整量',\r\n              zhej: 0,\r\n              gsptgx: 0,\r\n              jdy: 0,\r\n              ckbhgx: 0,\r\n              total: 0,\r\n            },\r\n            {\r\n              type: 'after',\r\n              title: '调整后',\r\n              zhej: (\r\n                (Number(data.gsptgx) + Number(data.jdy)) /\r\n                Number(this.curWeightUnit.enumKey)\r\n              ).toFixed(4),\r\n              gsptgx: (Number(data.gsptgx) / Number(this.curWeightUnit.enumKey)).toFixed(4),\r\n              jdy: (Number(data.jdy) / Number(this.curWeightUnit.enumKey)).toFixed(4),\r\n              ckbhgx: (Number(data.ckbhgx) / Number(this.curWeightUnit.enumKey)).toFixed(4),\r\n              total: (\r\n                (Number(data.zhej) + Number(data.ckbhgx)) /\r\n                Number(this.curWeightUnit.enumKey)\r\n              ).toFixed(4),\r\n            },\r\n          ];\r\n          this.tableLoading = false;\r\n        });\r\n      }\r\n    },\r\n    // 编辑/详情查询\r\n    editQuery() {\r\n      const params = {\r\n        adjustBatch: this.formData.adjustBatch,\r\n      };\r\n      this.$apis.apm.dailyPurchaseSale.editQuery(params).then((res) => {\r\n        this.formData = {\r\n          adjustBatch: res.adjustBatch,\r\n          busiYear: res.busiYear,\r\n          planYear: res.planYear,\r\n          memberOrgCode: res.memberOrgCode,\r\n          leafTypeCode: res.leafTypeCode,\r\n          operateType: res.operateType,\r\n          remark: res.remark,\r\n        };\r\n\r\n        const obj = {};\r\n        res.dailyPcTAsAppTplForTplDTOS.forEach((item) => {\r\n          obj[item.row] = item;\r\n        });\r\n\r\n        this.tableData = [\r\n          {\r\n            type: 'before',\r\n            title: '调整前',\r\n            zhej:\r\n              (Number(obj['0'].gsptgx) + Number(obj['0'].jdy)) / Number(this.curWeightUnit.enumKey),\r\n            gsptgx: Number(obj['0'].gsptgx) / Number(this.curWeightUnit.enumKey),\r\n            jdy: Number(obj['0'].jdy) / Number(this.curWeightUnit.enumKey),\r\n            ckbhgx: Number(obj['0'].ckbhgx) / Number(this.curWeightUnit.enumKey),\r\n            total:\r\n              (Number(obj['0'].zhej) + Number(obj['0'].ckbhgx)) /\r\n              Number(this.curWeightUnit.enumKey),\r\n          },\r\n          {\r\n            type: 'now',\r\n            title: '本次调整量',\r\n            zhej:\r\n              (Number(obj['1'].gsptgx) + Number(obj['1'].jdy)) / Number(this.curWeightUnit.enumKey),\r\n            gsptgx: Number(obj['1'].gsptgx) / Number(this.curWeightUnit.enumKey),\r\n            jdy: Number(obj['1'].jdy) / Number(this.curWeightUnit.enumKey),\r\n            ckbhgx: Number(obj['1'].ckbhgx) / Number(this.curWeightUnit.enumKey),\r\n            total:\r\n              (Number(obj['1'].zhej) + Number(obj['1'].ckbhgx)) /\r\n              Number(this.curWeightUnit.enumKey),\r\n          },\r\n          {\r\n            type: 'after',\r\n            title: '调整后',\r\n            zhej: 0,\r\n            gsptgx: 0,\r\n            jdy: 0,\r\n            ckbhgx: 0,\r\n            total: 0,\r\n          },\r\n        ];\r\n        this.onComputedTotal();\r\n      });\r\n    },\r\n    // 选择单位之前\r\n    onBeforeOk(data) {\r\n      if (data?.selectOption?.orgLevelEk === '1') {\r\n        this.$message.error('中国烟草公司不可选');\r\n        return false;\r\n      }\r\n    },\r\n    // 选中单位\r\n    onSelOrg(data) {\r\n      const curOrg = data?.selectOption || {};\r\n\r\n      if (curOrg?.orgTypeEk === 'INDUSTRY') {\r\n        this.leafTypeDisabled = true;\r\n        this.formData.leafTypeCode = '10';\r\n      }\r\n\r\n      this.formData.memberLevelCode = curOrg.orgLevelEk;\r\n      this.formData.memberOrgCode = curOrg.key;\r\n      this.onQuery();\r\n    },\r\n    // 计算合计\r\n    onComputedTotal() {\r\n      const nowDate = this.tableData[1];\r\n      // 工商 = 国内合计 - 基地烟\r\n      nowDate.gsptgx = nowDate.zhej - nowDate.jdy;\r\n      // 总计 = 国内合计 + 出口\r\n      nowDate.total = nowDate.zhej + nowDate.ckbhgx;\r\n      this.tableData.splice(1, 1, nowDate);\r\n\r\n      // 计算调整后数据\r\n      const afterData = this.tableData[2];\r\n\r\n      if (this.formData.operateType === '1') {\r\n        // 增量\r\n        afterData.zhej = (this.tableData[0].zhej + this.tableData[1].zhej).toFixed(4);\r\n        afterData.gsptgx = (this.tableData[0].gsptgx + this.tableData[1].gsptgx).toFixed(4);\r\n        afterData.jdy = (this.tableData[0].jdy + this.tableData[1].jdy).toFixed(4);\r\n        afterData.ckbhgx = (this.tableData[0].ckbhgx + this.tableData[1].ckbhgx).toFixed(4);\r\n        afterData.total = (this.tableData[0].total + this.tableData[1].total).toFixed(4);\r\n      } else {\r\n        // 减量\r\n        afterData.zhej = (this.tableData[0].zhej - this.tableData[1].zhej).toFixed(4);\r\n        afterData.gsptgx = (this.tableData[0].gsptgx - this.tableData[1].gsptgx).toFixed(4);\r\n        afterData.jdy = (this.tableData[0].jdy - this.tableData[1].jdy).toFixed(4);\r\n        afterData.ckbhgx = (this.tableData[0].ckbhgx - this.tableData[1].ckbhgx).toFixed(4);\r\n        afterData.total = (this.tableData[0].total - this.tableData[1].total).toFixed(4);\r\n      }\r\n      this.tableData.splice(2, 1, afterData);\r\n    },\r\n    // 保存并新增\r\n    onSaveAndAdd() {\r\n      this.$refs.formRef.validate((valid) => {\r\n        if (valid) {\r\n          this.formData.ckbhgxba = this.tableData[0]?.ckbhgx;\r\n          this.formData.gsptgxba = this.tableData[0]?.gsptgx;\r\n          this.formData.zhejba = this.tableData[0]?.zhej;\r\n          this.formData.ckbhgx = this.tableData[1]?.ckbhgx;\r\n          this.formData.gsptgx = this.tableData[1]?.gsptgx;\r\n          this.formData.zhej = this.tableData[1]?.zhej;\r\n          this.loading = true;\r\n          this.$apis.apm.dailyPurchaseSale.add(this.formData).then(() => {\r\n            this.$message.success('保存成功');\r\n            this.$emit('finish');\r\n            this.formData = {\r\n              busiYear: this.busiYear,\r\n            };\r\n            if (this.leafTypeList?.length) {\r\n              this.$set(this.formData, 'leafTypeCode', this.leafTypeList[0]?.leafTypeCode);\r\n            }\r\n            this.$set(this.formData, 'operateType', '1');\r\n            this.tableData = [];\r\n            this.$refs.formRef.resetFields();\r\n            this.loading = false;\r\n          });\r\n        } else {\r\n          this.$message.error('验证不通过');\r\n        }\r\n      });\r\n    },\r\n    // 保存\r\n    onSave() {\r\n      this.$refs.formRef.validate((valid) => {\r\n        if (valid) {\r\n          if (this.tableData[1].zhej === 0 && this.tableData[1].ckbhgx === 0) {\r\n            this.$message.error('未做任何调整，不能保存');\r\n            return;\r\n          }\r\n\r\n          this.formData.ckbhgxba = this.tableData[0]?.ckbhgx * Number(this.curWeightUnit.enumKey);\r\n          this.formData.gsptgxba = this.tableData[0]?.gsptgx * Number(this.curWeightUnit.enumKey);\r\n          this.formData.zhejba = this.tableData[0]?.zhej * Number(this.curWeightUnit.enumKey);\r\n          this.formData.ckbhgx = this.tableData[1]?.ckbhgx * Number(this.curWeightUnit.enumKey);\r\n          this.formData.gsptgx = this.tableData[1]?.gsptgx * Number(this.curWeightUnit.enumKey);\r\n          this.formData.zhej = this.tableData[1]?.zhej * Number(this.curWeightUnit.enumKey);\r\n          this.loading = true;\r\n          this.$apis.apm.dailyPurchaseSale.add(this.formData).then(() => {\r\n            this.loading = false;\r\n            this.$message.success('保存成功');\r\n            this.$emit('finish');\r\n            this.onclose();\r\n          });\r\n        } else {\r\n          this.$message.error('验证不通过');\r\n        }\r\n      });\r\n    },\r\n    // 关闭 \r\n    onclose() {\r\n      this.$refs.formRef.resetFields();\r\n      this.formData = {};\r\n      this.tableData = [];\r\n      this.visible = false;\r\n      this.isEdit = false;\r\n      this.isDetail = false;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/deep/ .sub-title {\r\n  margin-bottom: 10px;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: #1890ff;\r\n}\r\n\r\n.first-step {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AddModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AddModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AddModal.vue?vue&type=template&id=0870d1b8&scoped=true&\"\nimport script from \"./AddModal.vue?vue&type=script&lang=js&\"\nexport * from \"./AddModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AddModal.vue?vue&type=style&index=0&id=0870d1b8&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0870d1b8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ec-modal',{attrs:{\"title\":\"详细\",\"size\":\"large\",\"is-confirm\":true},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('a-button',{on:{\"click\":_vm.onClose}},[_vm._v(\"关闭\")])]},proxy:true}]),model:{value:(_vm.visibile),callback:function ($$v) {_vm.visibile=$$v},expression:\"visibile\"}},[_c('ec-table',{attrs:{\"border\":\"\",\"show-footer\":\"\",\"height\":\"100%\",\"auto\":false,\"data\":_vm.tableData,\"loading\":_vm.loading,\"show-overflow\":\"\",\"footer-method\":_vm.footerMethod}},[_c('ec-table-col',{attrs:{\"type\":\"seq\",\"width\":\"60\",\"title\":\"序号\",\"align\":\"center\"}}),_c('ec-table-col',{attrs:{\"field\":\"createTime\",\"title\":\"录入日期\",\"align\":\"center\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"dateFormat\")(row.createTime,'YYYY-MM-DD')))])]}}])}),_c('ec-table-col',{attrs:{\"field\":\"apprTypeCode\",\"title\":\"业务类型\",\"align\":\"center\",\"width\":\"100\"}}),_c('ec-table-col',{attrs:{\"field\":\"baseCellName\",\"title\":\"基地单元\",\"align\":\"center\",\"min-width\":\"100\"}}),_c('ec-table-col',{attrs:{\"field\":\"orgName\",\"title\":\"烟叶类型\",\"align\":\"center\",\"min-width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('div',[_vm._v(_vm._s(_vm._f(\"getNameBy\")(row.leafTypeCode,_vm.leafTypeObj)))])]}}])}),_c('ec-table-col',{attrs:{\"field\":\"baApprWeight\",\"title\":\"调整前量\",\"align\":\"center\",\"width\":\"100\"}}),_c('ec-table-col',{attrs:{\"field\":\"apprWeight\",\"title\":\"本次调整量\",\"align\":\"center\",\"width\":\"100\"}}),_c('ec-table-col',{attrs:{\"field\":\"aaApprWeight\",\"title\":\"调整后量\",\"align\":\"center\",\"width\":\"100\"}}),_c('ec-table-col',{attrs:{\"field\":\"remark\",\"title\":\"办理依据\",\"align\":\"center\",\"min-width\":\"100\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <ec-modal v-model=\"visibile\" title=\"详细\" size=\"large\" :is-confirm=\"true\">\r\n    <ec-table\r\n      border\r\n      show-footer\r\n      height=\"100%\"\r\n      :auto=\"false\"\r\n      :data=\"tableData\"\r\n      :loading=\"loading\"\r\n      show-overflow\r\n      :footer-method=\"footerMethod\"\r\n    >\r\n      <ec-table-col type=\"seq\" width=\"60\" title=\"序号\" align=\"center\"></ec-table-col>\r\n      <ec-table-col field=\"createTime\" title=\"录入日期\" align=\"center\" width=\"100\">\r\n        <template #default=\"{ row }\">\r\n          <div>{{ row.createTime | dateFormat('YYYY-MM-DD') }}</div>\r\n        </template>\r\n      </ec-table-col>\r\n      <ec-table-col field=\"apprTypeCode\" title=\"业务类型\" align=\"center\" width=\"100\" />\r\n      <ec-table-col field=\"baseCellName\" title=\"基地单元\" align=\"center\" min-width=\"100\" />\r\n      <ec-table-col field=\"orgName\" title=\"烟叶类型\" align=\"center\" min-width=\"100\">\r\n        <template #default=\"{ row }\">\r\n          <div>{{ row.leafTypeCode | getNameBy(leafTypeObj) }}</div>\r\n        </template>\r\n      </ec-table-col>\r\n      <ec-table-col field=\"baApprWeight\" title=\"调整前量\" align=\"center\" width=\"100\" />\r\n      <ec-table-col field=\"apprWeight\" title=\"本次调整量\" align=\"center\" width=\"100\" />\r\n      <ec-table-col field=\"aaApprWeight\" title=\"调整后量\" align=\"center\" width=\"100\" />\r\n      <ec-table-col field=\"remark\" title=\"办理依据\" align=\"center\" min-width=\"100\" />\r\n    </ec-table>\r\n    <template v-slot:footer>\r\n      <a-button @click=\"onClose\">关闭</a-button>\r\n    </template>\r\n  </ec-modal>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'DetailModal',\r\n  props: {\r\n    leafTypeObj: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      visibile: false,\r\n      loading: false,\r\n      tableData: [],\r\n    };\r\n  },\r\n  methods: {\r\n    show(data) {\r\n      this.visibile = true;\r\n      this.onQuery(data);\r\n    },\r\n    onClose() {\r\n      this.visibile = false;\r\n    },\r\n    // 查询\r\n    onQuery(data) {\r\n      const params = {\r\n        adjustBatch: data.adjustBatch,\r\n      };\r\n      this.loading = true;\r\n      this.$apis.apm.dailyPurchaseSale\r\n        .queryJdy(params)\r\n        .then((res) => {\r\n          this.loading = false;\r\n          this.tableData = res?.rows || [];\r\n        })\r\n        .catch(() => {\r\n          this.loading = false;\r\n        });\r\n    },\r\n    // 合计的数据\r\n    sumNum(list, field) {\r\n      let count = 0;\r\n      list.forEach((item) => {\r\n        count += Number(item[field]);\r\n      });\r\n      return count.toFixed(2);\r\n    },\r\n    // 底部合计行\r\n    footerMethod({ columns, data }) {\r\n      return [\r\n        columns.map((column, columnIndex) => {\r\n          if (columnIndex === 0) {\r\n            return '合计';\r\n          }\r\n          if (['baApprWeight', 'apprWeight'].includes(column.property)) {\r\n            return this.sumNum(data, column.property);\r\n          }\r\n          return null;\r\n        }),\r\n      ];\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DetailModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DetailModal.vue?vue&type=template&id=26edd026&\"\nimport script from \"./DetailModal.vue?vue&type=script&lang=js&\"\nexport * from \"./DetailModal.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <ec-container height=\"100%\">\r\n    <ec-container-header>\r\n      <ec-panel-item>\r\n        <ec-panel-item-left>\r\n          <ec-header title=\"工商购销调拨计划量调整登记\" icon=\"onetomany\" color-code=\"008\" />\r\n        </ec-panel-item-left>\r\n      </ec-panel-item>\r\n    </ec-container-header>\r\n    <ec-container-body>\r\n      <ec-panel :auto=\"false\">\r\n        <ec-panel-toolbar>\r\n          <ec-query-panel defaultFold @query=\"onQuery\" @reset=\"onReset\">\r\n            <ec-query-item label=\"烟叶类型\">\r\n              <ec-select allowClear placeholder=\"请选择烟叶类型\" v-model=\"queryParams.leafTypeCode\">\r\n                <a-select-option v-for=\"item in leafTypeList\" :key=\"item.leafTypeCode\">\r\n                  {{ item.leafTypeName }}\r\n                </a-select-option>\r\n              </ec-select>\r\n            </ec-query-item>\r\n            <ec-query-item label=\"计划年度\">\r\n              <ec-select placeholder=\"请选择计划年度\" v-model=\"queryParams.planYear\">\r\n                <a-select-option v-for=\"item in planYearList\" :key=\"item\">\r\n                  {{ item }}\r\n                </a-select-option>\r\n              </ec-select>\r\n            </ec-query-item>\r\n            <ec-query-item label=\"计量单位\">\r\n              <a-select\r\n                allow-clear\r\n                placeholder=\"请选择计量单位\"\r\n                v-model=\"weightUnit\"\r\n                @select=\"onSelWeightUnit\"\r\n              >\r\n                <a-select-option v-for=\"item in weightUnitList\" :key=\"item.enumKey\">\r\n                  {{ item.name }}\r\n                </a-select-option>\r\n              </a-select>\r\n            </ec-query-item>\r\n            <template #inner>\r\n              <ec-query-item label=\"会员单位\">\r\n                <a-input\r\n                  allowClear\r\n                  v-model=\"queryParams.memberOrgCode\"\r\n                  placeholder=\"请输入会员单位\"\r\n                />\r\n              </ec-query-item>\r\n              <ec-query-item label=\"办理依据\">\r\n                <a-input v-model=\"queryParams.remark\" placeholder=\"请输入办理依据\" />\r\n              </ec-query-item>\r\n            </template>\r\n          </ec-query-panel>\r\n          <ec-divider />\r\n        </ec-panel-toolbar>\r\n        <ec-panel-header>\r\n          <ec-panel-item-left v-if=\"isEntry\">\r\n            <a-button type=\"primary\" @click=\"onAdd\">新增</a-button>\r\n            <a-button type=\"default\" @click=\"onConfirm\">确认</a-button>\r\n            <a-button type=\"default\" @click=\"onDelete\">删除</a-button>\r\n          </ec-panel-item-left>\r\n          <ec-panel-item-right>\r\n            <span style=\"margin-right: 16px\">业务年度：{{ busiYear }}年</span>\r\n            <span>单位：{{ curWeightUnit.name }}</span>\r\n          </ec-panel-item-right>\r\n        </ec-panel-header>\r\n        <ec-panel-body>\r\n          <ec-table\r\n            ref=\"table\"\r\n            border\r\n            show-footer\r\n            show-overflow\r\n            highlight-current-row\r\n            height=\"100%\"\r\n            :auto=\"false\"\r\n            :data=\"tableData\"\r\n            :loading=\"loading\"\r\n            :footer-method=\"footerMethod\"\r\n            @checkbox-all=\"onSelAllTableData\"\r\n            @checkbox-change=\"onSelTableData\"\r\n          >\r\n            <ec-table-col type=\"checkbox\" width=\"50\" align=\"center\"></ec-table-col>\r\n            <ec-table-col type=\"seq\" width=\"60\" title=\"序号\" align=\"center\"></ec-table-col>\r\n            <ec-table-col field=\"createTime\" title=\"录入日期\" align=\"center\" width=\"120\">\r\n              <template #default=\"{ row }\">\r\n                <div>{{ row.createTime | dateFormat('YYYY-MM-DD') }}</div>\r\n              </template>\r\n            </ec-table-col>\r\n            <ec-table-col field=\"memberOrgName\" title=\"会员单位\" align=\"center\" min-width=\"150\" />\r\n            <ec-table-col field=\"orgName\" title=\"烟叶类型\" align=\"center\" min-width=\"100\">\r\n              <template #default=\"{ row }\">\r\n                <div>{{ row.leafTypeCode | getNameBy(leafTypeObj) }}</div>\r\n              </template>\r\n            </ec-table-col>\r\n            <ec-table-col field=\"total\" title=\"总计\" align=\"center\" min-width=\"100\">\r\n              <template #default=\"{ row }\">\r\n                <div>{{ row.total | amountFormat(weightUnit) }}</div>\r\n              </template>\r\n            </ec-table-col>\r\n            <ec-table-colgroup title=\"国内调拨计划量\">\r\n              <ec-table-col field=\"zhej\" title=\"合计\" align=\"center\" min-width=\"150\">\r\n                <template #default=\"{ row }\">\r\n                  <div>{{ row.zhej | amountFormat(weightUnit) }}</div>\r\n                </template>\r\n              </ec-table-col>\r\n              <ec-table-col field=\"gsptgx\" title=\"工商普通购销\" align=\"center\" min-width=\"150\">\r\n                <template #default=\"{ row }\">\r\n                  <div>{{ row.gsptgx | amountFormat(weightUnit) }}</div>\r\n                </template>\r\n              </ec-table-col>\r\n              <ec-table-col field=\"jdy\" title=\"基地烟\" align=\"center\" min-width=\"150\">\r\n                <template #default=\"{ row }\">\r\n                  <div>{{ row.jdy | amountFormat(weightUnit) }}</div>\r\n                </template>\r\n              </ec-table-col>\r\n            </ec-table-colgroup>\r\n            <ec-table-colgroup title=\"出口调拨计划量\">\r\n              <ec-table-col field=\"ckbhgx\" title=\"出口备货普通购销\" align=\"center\" min-width=\"200\">\r\n                <template #default=\"{ row }\">\r\n                  <div>{{ row.ckbhgx | amountFormat(weightUnit) }}</div>\r\n                </template>\r\n              </ec-table-col>\r\n            </ec-table-colgroup>\r\n            <ec-table-col title=\"操作\" align=\"center\" width=\"180\">\r\n              <template #default=\"{ row }\">\r\n                <a-button type=\"link\" @click=\"onEdit(row)\">编辑</a-button>\r\n                <a-button type=\"link\" @click=\"onDetail(row)\">详细</a-button>\r\n                <a-button type=\"link\" @click=\"onBaseDetail(row)\">基地烟详细</a-button>\r\n              </template>\r\n            </ec-table-col>\r\n          </ec-table>\r\n        </ec-panel-body>\r\n      </ec-panel>\r\n\r\n      <add-modal\r\n        ref=\"addModalRef\"\r\n        :busiYear=\"busiYear\"\r\n        :orgList=\"orgList\"\r\n        :curWeightUnit=\"curWeightUnit\"\r\n        :leafTypeList=\"leafTypeList\"\r\n        :planYearList=\"planYearList\"\r\n        @finish=\"onQuery\"\r\n      />\r\n\r\n      <detail-modal ref=\"detailModalRef\" :leafTypeObj=\"leafTypeObj\" />\r\n    </ec-container-body>\r\n  </ec-container>\r\n</template>\r\n\r\n<script>\r\nimport AddModal from './AddModal.vue';\r\nimport DetailModal from './DetailModal.vue';\r\nimport _ from 'lodash';\r\n\r\nexport default {\r\n  name: 'Index',\r\n  components: { AddModal, DetailModal },\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      tableData: [],\r\n      queryParams: {},\r\n      pagination: {\r\n        pageNumber: 1,\r\n        pageSize: 10,\r\n        total: 0,\r\n      },\r\n      // 应用编码\r\n      appCode: undefined,\r\n      // 当前登入组织编码\r\n      orgCode: undefined,\r\n      // 组织单位列表\r\n      orgList: [],\r\n      // 烟叶类型列表 (默认只能选这三个烟叶类型)\r\n      leafTypeList: [\r\n        { leafTypeCode: '10', leafTypeName: '烤烟' },\r\n        { leafTypeCode: '20', leafTypeName: '晾晒烟' },\r\n        { leafTypeCode: '2013', leafTypeName: '雪茄烟' },\r\n      ],\r\n      // 计量单位\r\n      weightUnitList: [],\r\n      // 选中表格\r\n      selTableData: [],\r\n      // 计量单位key\r\n      weightUnit: '500000',\r\n      // 用户信息\r\n      userInfo: {},\r\n      // 是否录入\r\n      isEntry: false,\r\n      // 计划年度列表\r\n      planYearList: [],\r\n    };\r\n  },\r\n  computed: {\r\n    appConfig() {\r\n      return this.$store.getters.getAppConfig;\r\n    },\r\n    leafTypeObj() {\r\n      return this.leafTypeList.map((item) => {\r\n        return {\r\n          key: item.leafTypeCode,\r\n          title: item.leafTypeName,\r\n        };\r\n      });\r\n    },\r\n    busiYear() {\r\n      return this.$store.getters.getAppConfig?.yearValueMap?.DAILY_YEAR;\r\n    },\r\n    bizCode() {\r\n      return this.$store.getters.getAppConfig?.bizCode;\r\n    },\r\n    // 当前选中计量单位\r\n    curWeightUnit() {\r\n      return this.weightUnitList.find((item) => item.enumKey === this.weightUnit) || {};\r\n    },\r\n  },\r\n  created() {\r\n    // 通过路由获取appCode\r\n    const { appCode } = this.$router.history.current.query;\r\n    this.appCode = appCode || 'CM';\r\n\r\n    // 计划年度列表\r\n    const nowYear = new Date().getFullYear();\r\n    this.planYearList = [nowYear, nowYear + 1];\r\n    this.queryParams.planYear = nowYear;\r\n\r\n    this.beforeHandler();\r\n    this.handleGetWeightUnitList();\r\n    this.handleGetOrgList();\r\n    this.onQuery();\r\n  },\r\n  methods: {\r\n    // 获取模块录入状态\r\n    beforeHandler() {\r\n      this.$apis.apm.dailyPurchaseSale.before().then((res) => {\r\n        if (res === '1') {\r\n          this.isEntry = true;\r\n        }\r\n      });\r\n    },\r\n    // 获取计量单位列表\r\n    handleGetWeightUnitList() {\r\n      const params = {\r\n        enumTypeCodes: ['WEIGHT_UNIT'],\r\n      };\r\n      this.$apis.bim.enumType.query(params).then((res) => {\r\n        this.weightUnitList = res?.enumMap?.WEIGHT_UNIT || [];\r\n      });\r\n    },\r\n    // 获取组织单位\r\n    handleGetOrgList() {\r\n      const params = {\r\n        bizYear: this.busiYear,\r\n        bizCode: this.bizCode,\r\n        orgTypeEk: 'EXPORT,INDUSTRY,TOBACCO',\r\n        orgLevelEk: '2',\r\n        paramMap: {\r\n          isCorporation: '1',\r\n        },\r\n      };\r\n      this.$apis.apm.dailyPurchaseSale.queryOrgTree(params).then((res) => {\r\n        this.orgList = res?.rows || [];\r\n      });\r\n    },\r\n    // 将列转为树结构\r\n    handleListToTree(data) {\r\n      // * 先生成parent建立父子关系\r\n      const obj = {};\r\n      data.forEach((item) => {\r\n        obj[item.orgUniqueCode] = item;\r\n      });\r\n      const treeData = [];\r\n      data.forEach((item) => {\r\n        const parent = obj[item.parentOrgUniqueCode];\r\n        if (parent) {\r\n          // * 当前项有父节点\r\n          parent.children = parent.children || [];\r\n          parent.children.push(item);\r\n        } else {\r\n          // * 当前项没有父节点 -> 顶层\r\n          treeData.push(item);\r\n        }\r\n      });\r\n      return treeData;\r\n    },\r\n    // 选择重量单位，重新计算底部合计\r\n    onSelWeightUnit() {\r\n      this.tableData = _.cloneDeep(this.tableData);\r\n    },\r\n    // 查询\r\n    onQuery() {\r\n      const params = {\r\n        busiYear: this.busiYear,\r\n        ...this.queryParams,\r\n      };\r\n      this.loading = true;\r\n      this.$apis.apm.dailyPurchaseSale\r\n        .query(params)\r\n        .then((res) => {\r\n          this.loading = false;\r\n          this.tableData = res?.rows.map((item) => {\r\n            const newItem = item;\r\n            newItem.total = Number(item.zhej) + Number(item.ckbhgx);\r\n            return newItem;\r\n          });\r\n          this.pagination.total = res?.totalRows;\r\n        })\r\n        .catch(() => {\r\n          this.loading = false;\r\n        });\r\n    },\r\n    // 重置\r\n    onReset() {\r\n      this.queryParams = {};\r\n      this.onQuery();\r\n    },\r\n    // table选中对应项\r\n    onSelTableData({ records }) {\r\n      this.selTableData = records;\r\n    },\r\n    // table选中所有项\r\n    onSelAllTableData({ records }) {\r\n      this.selTableData = records;\r\n    },\r\n    // 合计的数据\r\n    sumNum(list, field) {\r\n      let count = 0;\r\n      list.forEach((item) => {\r\n        count += Number(item[field]);\r\n      });\r\n      count /= this.weightUnit;\r\n      return count.toFixed(4);\r\n    },\r\n    // 底部合计行\r\n    footerMethod({ columns, data }) {\r\n      return [\r\n        columns.map((column, columnIndex) => {\r\n          if (columnIndex === 0) {\r\n            return '合计';\r\n          }\r\n          if (['total', 'zhej', 'gsptgx', 'jdy', 'ckbhgx'].includes(column.property)) {\r\n            return this.sumNum(data, column.property);\r\n          }\r\n          return null;\r\n        }),\r\n      ];\r\n    },\r\n    // 新增\r\n    onAdd() {\r\n      this.$refs.addModalRef.show();\r\n    },\r\n    // 编辑\r\n    onEdit(data) {\r\n      this.$refs.addModalRef.show(_.cloneDeep(data));\r\n    },\r\n    // 确认\r\n    onConfirm() {\r\n      if (!this.selTableData.length) {\r\n        this.$message.error('请选择一条数据再确认');\r\n        return;\r\n      }\r\n      this.$confirm({\r\n        title: '是否执行该操作?',\r\n        content: () => (\r\n          <div style=\"color:red;\">\r\n            是否要确认选中的数据，确认请点击'确认'按钮，取消点击'取消'按钮。\r\n          </div>\r\n        ),\r\n        onOk: () => {\r\n          this.loading = true;\r\n          const params = {\r\n            adjustBatchs: this.selTableData.map((item) => item.adjustBatch),\r\n          };\r\n          this.$apis.apm.dailyPurchaseSale.confirm(params).then(() => {\r\n            this.$message.success('确认成功');\r\n            this.loading = false;\r\n            this.onQuery();\r\n          });\r\n        },\r\n      });\r\n    },\r\n    // 删除\r\n    onDelete() {\r\n      if (!this.selTableData.length) {\r\n        this.$message.error('请选择一条数据再删除');\r\n        return;\r\n      }\r\n      this.$confirm({\r\n        title: '是否执行该操作?',\r\n        content: () => (\r\n          <div style=\"color:red;\">\r\n            是否确认删除选中的数据，确认请点击'确认'按钮，取消点击'取消'按钮。\r\n          </div>\r\n        ),\r\n        onOk: () => {\r\n          this.loading = true;\r\n          const params = {\r\n            adjustBatchs: this.selTableData.map((item) => item.adjustBatch),\r\n          };\r\n          this.$apis.apm.dailyPurchaseSale.delete(params).then(() => {\r\n            this.$message.success('删除成功');\r\n            this.loading = false;\r\n            this.onQuery();\r\n          });\r\n        },\r\n      });\r\n    },\r\n    // 详情\r\n    onDetail(data) {\r\n      this.$refs.addModalRef.show(_.cloneDeep(data), true);\r\n    },\r\n    // 基地烟详情\r\n    onBaseDetail(data) {\r\n      this.$refs.detailModalRef.show(data);\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped></style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=ac65c240&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ac65c240\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}