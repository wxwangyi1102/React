(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6aa884f6"],{"0676":function(e,t,a){function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}a("d9e2"),e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports},"11b0":function(e,t,a){function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630"),e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports},2236:function(e,t,a){var r=a("5a43");function o(e){if(Array.isArray(e))return r(e)}e.exports=o,e.exports.__esModule=!0,e.exports["default"]=e.exports},"278c":function(e,t,a){var r=a("c135"),o=a("9b42"),n=a("6613"),s=a("c240");function i(e,t){return r(e)||o(e,t)||n(e,t)||s()}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},"448a":function(e,t,a){var r=a("2236"),o=a("11b0"),n=a("6613"),s=a("0676");function i(e){return r(e)||o(e)||n(e)||s()}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},5530:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("159b"),a("dbb4");function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}},"55b1":function(e,t,a){"use strict";a("86a2")},"5a43":function(e,t){function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}e.exports=a,e.exports.__esModule=!0,e.exports["default"]=e.exports},63748:function(e,t,a){a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("d9e2");var r=a("6613");function o(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=r(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){l=!0,s=e},f:function(){try{i||null==a["return"]||a["return"]()}finally{if(l)throw s}}}}e.exports=o,e.exports.__esModule=!0,e.exports["default"]=e.exports},6613:function(e,t,a){a("fb6a"),a("d3b7"),a("b0c0"),a("a630"),a("3ca3"),a("ac1f"),a("00b4");var r=a("5a43");function o(e,t){if(e){if("string"===typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}e.exports=o,e.exports.__esModule=!0,e.exports["default"]=e.exports},"860f":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ec-container",{attrs:{height:"100%"}},[a("ec-container-header",[a("ec-panel-item",[a("ec-panel-item-left",[a("ec-header",{attrs:{title:"历史库存陈烟码包申请",icon:"onetomany","color-code":"008"}})],1)],1)],1),a("ec-container-body",{attrs:{auto:!1}},[a("ec-v-layout",[a("ec-v-item",[a("ec-panel",[a("ec-panel-body",[a("a-descriptions",{attrs:{bordered:"",column:4}},[a("a-descriptions-item",{attrs:{label:"调拨年度"}},[e._v(" "+e._s(e.queryItems.tranYear)+" ")]),a("a-descriptions-item",{attrs:{label:"烟叶类型"}},[e._v(" "+e._s(e.getLabelName(e.queryItems.leafTypeCode,this.leafTypeList,"leafTypeCode","leafTypeName")||"全部"))]),a("a-descriptions-item",{attrs:{label:"计划量"}},[e._v(" "+e._s(e.totalData.planTotalWeight)+" ")]),a("a-descriptions-item",{attrs:{label:"剩余计划量"}},[e._v(" "+e._s(e.totalData.leftWeight)+" ")]),a("a-descriptions-item",{attrs:{label:"申请码包数量"}},[e._v(" "+e._s(e.totalData.applyNum)+" ")]),a("a-descriptions-item",{attrs:{label:"申请量"}},[e._v(" "+e._s(e.totalData.applyWeight)+" ")]),a("a-descriptions-item",{attrs:{label:""}}),a("a-descriptions-item",{attrs:{label:""}})],1)],1)],1),a("ec-panel",[a("ec-panel-toolbar",[a("ec-query-panel",{attrs:{defaultFold:!0},on:{query:function(t){return e.$refs.table.pageAction(1)},reset:e.onReset},scopedSlots:e._u([{key:"inner",fn:function(){return[a("ec-query-item",{attrs:{label:"仓库"}},[a("a-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.queryItems.storeCode,callback:function(t){e.$set(e.queryItems,"storeCode",t)},expression:"queryItems.storeCode"}},e._l(e.storesList,(function(t){return a("a-select-option",{key:t.storeCode,attrs:{value:t.storeCode}},[e._v(e._s(t.storeName))])})),1)],1),a("ec-query-item",{attrs:{label:"物料"}},[a("ec-select",{attrs:{placeholder:"请选择"},model:{value:e.queryItems.materialCode,callback:function(t){e.$set(e.queryItems,"materialCode",t)},expression:"queryItems.materialCode"}},e._l(e.specList,(function(t){return a("a-select-option",{key:t.spec},[e._v(" "+e._s(t.spec)+" ")])})),1)],1),a("ec-query-item",{attrs:{label:"状态"}},[a("ec-select",{attrs:{placeholder:"请选择"},model:{value:e.queryItems.applyState,callback:function(t){e.$set(e.queryItems,"applyState",t)},expression:"queryItems.applyState"}},e._l(e.applyStateList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1)]},proxy:!0}])},[a("ec-query-item",{attrs:{label:"调拨年度"}},[a("a-input-number",{attrs:{placeholder:"请输入"},model:{value:e.queryItems.tranYear,callback:function(t){e.$set(e.queryItems,"tranYear",t)},expression:"queryItems.tranYear"}})],1),a("ec-query-item",{attrs:{label:"申请单位"}},[a("org-picker",{attrs:{disabled:!0,placeholder:"请选择"},model:{value:e.queryItems.applyOrgCodes,callback:function(t){e.$set(e.queryItems,"applyOrgCodes",t)},expression:"queryItems.applyOrgCodes"}})],1),a("ec-query-item",{attrs:{label:"烟叶类型"}},[a("ec-select",{attrs:{showSearch:"",allowClear:"",placeholder:"请选择"},on:{select:e.leafTypeChange},model:{value:e.queryItems.leafTypeCode,callback:function(t){e.$set(e.queryItems,"leafTypeCode",t)},expression:"queryItems.leafTypeCode"}},e._l(e.leafTypeList,(function(t){return a("a-select-option",{key:t.leafTypeCode},[e._v(" "+e._s(t.leafTypeName)+" ")])})),1)],1),a("ec-query-item",{attrs:{label:"烟叶形态"}},[a("ec-select",{attrs:{showSearch:"",allowClear:"",placeholder:"请选择"},model:{value:e.queryItems.leafFormCode,callback:function(t){e.$set(e.queryItems,"leafFormCode",t)},expression:"queryItems.leafFormCode"}},e._l(e.leafFormList,(function(t){return a("a-select-option",{key:t.leafFormCode,attrs:{value:t.leafFormCode}},[e._v(e._s(t.leafFormName))])})),1)],1)],1),a("ec-divider")],1),a("ec-panel-body",{attrs:{height:"100%"}},[a("ec-v-layout",[a("ec-v-item",[a("ec-panel-item",[a("ec-panel-item-left",[a("a-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("新增")]),a("a-button",{on:{click:e.onDelete}},[e._v("删除")]),a("a-button",{on:{click:e.onConfirm}},[e._v("确认")])],1),a("ec-panel-item-right",[a("a-space",{attrs:{size:15}},[a("span",[e._v("重量单位："),a("ec-select",{staticStyle:{width:"150px"},attrs:{showSearch:"",allowClear:"",placeholder:"请选择"},model:{value:e.weightUnit,callback:function(t){e.weightUnit=t},expression:"weightUnit"}},e._l(e.weightUnitList,(function(t){return a("a-select-option",{key:t.weightUnitCd},[e._v(" "+e._s(t.weightUnitName)+" ")])})),1)],1)])],1)],1)],1),a("ec-v-item"),a("ec-v-item",[a("ec-table",{ref:"table",attrs:{border:"",pagination:Object.keys(e.orgInfo).length?e.pagination:{},data:e.tableData.rows,loading:e.loading,"highlight-current-row":""},on:{"page-action":e.handlePagination,"checkbox-all":e.selectAllEvent,"checkbox-change":e.selectRowChange}},[a("ec-table-col",{attrs:{type:"checkbox",width:"50",align:"center"}}),a("ec-table-col",{attrs:{title:"序号",type:"seq",width:"70",align:"center"}}),a("ec-table-col",{attrs:{field:"applyDate",title:"申请日期",align:"center",width:"200"}}),a("ec-table-col",{attrs:{field:"applyOrgName",title:"申请单位",align:"left","min-width":"150"}}),a("ec-table-col",{attrs:{field:"leafTypeName",title:"烟叶类型",align:"left","min-width":"150"}}),a("ec-table-col",{attrs:{field:"packType",title:"包装类型",align:"left","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(" "+e._s(e.getLabelName(r.packType,e.enumMap["PC_PACK_TYPE"],"enumKey","name")))])]}}])}),a("ec-table-col",{attrs:{field:"spec",title:"规格（KG/件）",align:"right","min-width":"150"}}),a("ec-table-col",{attrs:{field:"applyNum",title:"申请码包数量",align:"right","min-width":"150"}}),a("ec-table-col",{attrs:{field:"applyWeight",title:"申请量",align:"right","min-width":"150"}}),a("ec-table-col",{attrs:{field:"applyState",title:"状态",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return["1"===r.applyState?a("div",[a("span",[e._v("已确认")])]):a("div",[a("span",[e._v("未确认")])])]}}])}),a("ec-table-col",{attrs:{title:"操作",align:"center",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("a-button",{attrs:{type:"link"},on:{click:function(t){return e.onEdit(r)}}},[e._v("编辑")])]}}])})],1)],1)],1)],1)],1)],1)],1),e.showEdit?a("edit",{ref:"BuyApplyEdit",attrs:{showEdit:e.showEdit,storeList:e.curOrgStores},on:{"update:showEdit":function(t){e.showEdit=t},"update:show-edit":function(t){e.showEdit=t},onQuery:e.onQuery}}):e._e()],1)],1)},o=[],n=a("5530"),s=a("c7eb"),i=a("1da1"),l=(a("e906"),a("dd14")),c=a.n(l),p=(a("7db0"),a("d3b7"),a("a15b"),a("a434"),a("e9c4"),a("99af"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ec-modal",{staticClass:"ec-draw-form",attrs:{visible:e.visible,title:e.title,size:"large","is-confirm":!0},on:{cancel:e.onclose},scopedSlots:e._u([{key:"footer",fn:function(){return[a("a-button",{attrs:{type:"primary",loading:e.saving},on:{click:e.onSave}},[e._v("保存")]),a("a-button",{on:{click:e.onclose}},[e._v("取消")])]},proxy:!0}])},[a("ec-form",{ref:"modelRef",attrs:{model:e.formData,rules:e.rules}},[a("a-row",{attrs:{type:"flex",gutter:12}},[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{ref:"orgCodeList",attrs:{label:"申请单位",prop:"applyOrgCodes"}},[a("org-picker",{attrs:{placeholder:"请选择"},model:{value:e.formData.applyOrgCodes,callback:function(t){e.$set(e.formData,"applyOrgCodes",t)},expression:"formData.applyOrgCodes"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"storeCode",label:"仓库"}},[a("a-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.formData.storeCode,callback:function(t){e.$set(e.formData,"storeCode",t)},expression:"formData.storeCode"}},e._l(e.storeList,(function(t){return a("a-select-option",{key:t.storeCode,attrs:{value:t.storeCode}},[e._v(e._s(t.storeName))])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{ref:"leafTypeCode",attrs:{prop:"leafTypeCode",label:"烟叶类型"}},[a("ec-select",{attrs:{placeholder:"请选择"},on:{select:e.leafTypeChange},model:{value:e.formData.leafTypeCode,callback:function(t){e.$set(e.formData,"leafTypeCode",t)},expression:"formData.leafTypeCode"}},e._l(e.leafTypeList,(function(t){return a("a-select-option",{key:t.leafTypeCode},[e._v(" "+e._s(t.leafTypeName)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{prop:"leafFormCode",label:"烟叶类型"}},[a("ec-select",{attrs:{placeholder:"请选择"},on:{select:e.handleSpec},model:{value:e.formData.leafFormCode,callback:function(t){e.$set(e.formData,"leafFormCode",t)},expression:"formData.leafFormCode"}},e._l(e.leafFormList,(function(t){return a("a-select-option",{key:t.leafFormCode},[e._v(" "+e._s(t.leafFormName)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{ref:"packType",attrs:{prop:"materialCode",label:"物料"}},[a("ec-select",{attrs:{placeholder:"请选择"},model:{value:e.formData.materialCode,callback:function(t){e.$set(e.formData,"materialCode",t)},expression:"formData.materialCode"}},e._l(e.packTypeList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{ref:"packType",attrs:{prop:"packType",label:"包装类型"}},[a("ec-select",{attrs:{placeholder:"请选择"},model:{value:e.formData.packType,callback:function(t){e.$set(e.formData,"packType",t)},expression:"formData.packType"}},e._l(e.packTypeList,(function(t){return a("a-select-option",{key:t.enumKey},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{ref:"spec",attrs:{prop:"spec",label:"规格"}},[a("ec-select",{attrs:{placeholder:"请选择"},on:{select:e.applyNumChange},model:{value:e.formData.spec,callback:function(t){e.$set(e.formData,"spec",t)},expression:"formData.spec"}},e._l(e.specList,(function(t){return a("a-select-option",{key:t.enumKey,attrs:{value:t.enumKey}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"申请码包数量",prop:"applyNum"}},[a("a-input-number",{attrs:{placeholder:"请输入",min:0},on:{change:e.applyNumChange},model:{value:e.formData.applyNum,callback:function(t){e.$set(e.formData,"applyNum",t)},expression:"formData.applyNum"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"申请量（KG）",prop:"applyWeight"}},[a("a-input-number",{attrs:{disabled:!0},model:{value:e.formData.applyWeight,callback:function(t){e.$set(e.formData,"applyWeight",t)},expression:"formData.applyWeight"}})],1)],1)],1)],1)],1)}),u=[],f=(a("a9e3"),a("b0c0"),a("b680"),{name:"batchManageForm",components:{OrgPicker:c.a},props:{showEdit:{type:Boolean,default:!1},storeList:{type:[Array,String],default:function(){return[]}}},computed:{_api:function(){return this.$apis.pcm.penatly.apply}},data:function(){return{leafFormList:[],packTypeList:[],storesList:[],visible:!1,formData:{storeCode:""},isEditor:!1,saving:!1,isDisableYear:!0,busiYear:"",title:"",leafTypeList:[],orgCodeList:[],specList:[],applyOrgCode:"",applyOrgName:"",rules:{materialCode:[{message:"请选择物料",required:!0,trigger:"change"}],applyOrgCodes:[{message:"请选择申请单位",required:!0,trigger:"change"}],leafTypeCode:{required:!0,message:"请选择烟叶类型",trigger:"change"},packType:{required:!0,message:"请选择包装类型",trigger:"change"},spec:{required:!0,message:"请选择规格",trigger:"change"},applyNum:{required:!0,message:"请选择规格和输入申请码包量",trigger:"blur"}}}},methods:{applyNumChange:function(){this.formData.applyNum&&this.formData.spec?this.formData.applyWeight=this.formData.applyNum*Number(this.formData.spec):this.formData.applyWeight=0},getLeafTypeList:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a,r,o;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==(a=e.leafTypeList)&&void 0!==a&&a.length){t.next=8;break}return t.next=3,e.$apis.bpm.executionEnter.queryLeafType({});case 3:r=t.sent,o=(null===r||void 0===r?void 0:r.rows)||[],o&&o.length>0&&o.unshift({leafTypeName:"全部",leafTypeCode:""}),e.leafTypeList=o,e.leafTypeList.some((function(t){return"烤烟"===t.leafTypeName&&(e.formData.leafTypeCode=t.leafTypeCode,!0)}));case 8:case"end":return t.stop()}}),t)})))()},leafTypeChange:function(e){var t=this;return Object(i["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t._api.spinnerLeafForm({leafTypeCodes:[e]}).then((function(e){t.leafFormList=null===e||void 0===e?void 0:e.rows,t.leafFormList.some((function(e){return"片烟"===e.leafFormName&&(t.$set(t.formData,"leafFormCode",e.leafFormCode),!0)}))}));case 2:case"end":return a.stop()}}),a)})))()},show:function(e){this.visible=!0;var t=e.type||"",a=(null===e||void 0===e?void 0:e.orgCodeList)||[];this.orgCodeList=a;var r=e.orgInfo||{},o=(null===e||void 0===e?void 0:e.selectedRow)||{};"editor"===t?(this.isEditor=!0,this.title="编辑",this.formData=o,this.formData.tranYear=e.tranYear,this.formData.applyOrgCodes=[o.applyOrgCode]):(this.isEditor=!1,this.title="新增",this.formData.tranYear=e.tranYear,this.formData.applyOrgCode=e.orgCode,this.formData.applyType="INVENTORY_CP",this.$set(this.formData,"applyOrgCodes",[e.orgInfo.provUniqueCode])),this.busiYear=e.busiYear,this.formData.applyOrgName=r.orgName,console.log(this.formData);var n=(null===e||void 0===e?void 0:e.enumMap)||{},s=(null===n||void 0===n?void 0:n.PC_APPLY_STATE)||[];this.applyStateList=s,this.leafTypeList=(null===e||void 0===e?void 0:e.oldLeafTypeList)||[];var i=(null===n||void 0===n?void 0:n.PC_PACK_TYPE)||[];this.packTypeList=i,this.specList=(null===n||void 0===n?void 0:n.PC_RT_SPEC)||[];var l=i.find((function(e){return"烟箱"===e.name}));this.formData.packType=l?l.enumKey:"",console.log(this.specList)},handleApplyNum:function(){var e=this.formData.spec,t=Number(e)||0,a=this.formData.applyWeight,r=Number(a)||0,o=0===t?0:(r/t).toFixed(2);this.formData.applyNum=Math.ceil(o)||0},handleSpec:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a,r,o,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.orgCodeList,r=a.length>0?a[0]:"",o={applyOrgCd:r,leafTypeCd:e.formData.leafTypeCode,packType:e.formData.packType,specState:"1"},console.log("包装规格参数2：".concat(JSON.stringify(o))),t.next=6,e.$apis.pcm.buy.packApply.querySpec(o);case 6:n=t.sent,e.specList=(null===n||void 0===n?void 0:n.rows)||[];case 8:case"end":return t.stop()}}),t)})))()},onSave:function(){var e=this;this.$refs.modelRef.validate(function(){var t=Object(i["a"])(Object(s["a"])().mark((function t(a){var r,o,n,i,l;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:e.saving=!0,r=e.formData,o=r.leafTypeCode,n=r.leafFormCode,i=e.leafTypeList.find((function(e){return e.leafTypeCode===o})),l=e.leafFormList.find((function(e){return e.leafFormCode===n})),r.leafTypeName=null===i||void 0===i?void 0:i.leafTypeName,r.leafFormName=null===l||void 0===l?void 0:l.leafFormName,r.applyOrgCode=r.applyOrgCodes.length?r.applyOrgCodes.join(""):"",console.log(r),e.isEditor?e._api.updatePcTCpApply(r).then((function(t){console.log(t),e.onclose(),e.$emit("onQuery"),e.$message.success("操作成功")})).catch((function(t){console.log(t),e.saving=!1})):e._api.createPcTCpApply(r).then((function(t){console.log(t),e.onclose(),e.$emit("onQuery"),e.$message.success("操作成功")})).catch((function(t){console.log(t),e.saving=!1}));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},onclose:function(){this.saving=!1,this.formData={},this.$emit("update:showEdit",!1),this.visible=!1,this.$refs.modelRef.resetFields()}},created:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getLeafTypeList();case 2:return t.next=4,e.leafTypeChange(e.formData.leafTypeCode);case 4:console.log("created");case 5:case"end":return t.stop()}}),t)})))()}}),d=f,m=a("2877"),y=Object(m["a"])(d,p,u,!1,null,null,null),h=y.exports,g=a("2ef0"),b=a.n(g),v={name:"inventoryApply",components:{edit:h,OrgPicker:c.a},data:function(){return{showEdit:!1,storesList:[],curOrgStores:[],leafFormList:[],objectData:{},busiYear:"",orgInfo:{},queryItems:{leafFormCode:"",storeCode:"",applyOrgCodes:[],leafTypeCode:"",packType:"",spec:"",applyState:""},defaultPackType:"",weightUnit:1,areaUnit:1e4,nowYear:"",loading:!1,leafTypeCd:"",leafTypeList:[],oldLeafTypeList:[],oldDataRow:[],oldTotalData:[],totalData:{},isNullData:[],leafTypeName:"",beforeLeafTypeName:"",weightUnitList:[{weightUnitCd:1,weightUnitName:"公斤",isSelected:!1},{weightUnitCd:50,weightUnitName:"担",isSelected:!1},{weightUnitCd:5e5,weightUnitName:"万担",isSelected:!1}],applyStateList:[],packTypeList:[],specList:[],orgCodeList:[],enumMap:{},pagination:{pageNumber:1,pageSize:10,total:0},tableData:{rows:[]}}},computed:{_api:function(){return this.$apis.pcm.penatly.apply}},created:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a,r,o,n,i,l;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$router.history.current.query.appCode,e.appCode=a||"CM",r=["PC_PACK_TYPE","PC_APPLY_STATE","PC_RT_SPEC"],o={enumTypeCodes:r},t.next=6,e.$apis.enum.index.getEnumType(o);case 6:return n=t.sent,console.log(n),i=(null===n||void 0===n?void 0:n.enumMap)||{},e.enumMap=b.a.cloneDeep(n.enumMap||{}),l=(null===i||void 0===i?void 0:i.PC_APPLY_STATE)||[],l&&l.length>0&&(l.unshift({enumKey:"",enumTypeCode:"PC_APPLY_STATE",name:"全部"}),e.queryItems.applyState=l[0].enumKey),e.applyStateList=l,e.$set(e.queryItems,"tranYear",(new Date).getFullYear()),t.next=16,e.getCurrentUserOrg();case 16:return t.next=18,e.handleGetLeafTypeList();case 18:return t.next=20,e.leafTypeChange(e.queryItems.leafTypeCode);case 20:return t.next=22,e.onQuery();case 22:case"end":return t.stop()}}),t)})))()},methods:{getLabelName:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!e||!t.length)return"";var o=t.find((function(t){return t[a]===e}));return o[r]||""},getCurrentUserOrg:function(){var e=this;this._api.getCurrentUserOrg({dataState:1}).then(function(){var t=Object(i["a"])(Object(s["a"])().mark((function t(a){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.orgInfo=a||{},e.queryItems.applyOrgCodes=a?[a.orgUniqueCode]:void 0,console.log(e.queryItems.applyOrgCodes),e.queryItems.applyOrgCode=e.queryItems.applyOrgCodes.length?e.queryItems.applyOrgCodes.join(""):"",t.next=6,e.getCmTStoreByOrgCode(e.queryItems.applyOrgCode);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getCmTStoreByOrgCode:function(){var e=arguments,t=this;return Object(i["a"])(Object(s["a"])().mark((function a(){var r;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:void 0,a.next=3,t._api.getCmTStoreByOrgCode({dataState:1,orgCode:r}).then((function(e){t.storesList=e.rows||[],t.curOrgStores=b.a.cloneDeep(e.rows),t.curOrgStores.unshift({storeName:"全部",storeCode:""})})).finally((function(){t.storesList.unshift({storeName:"全部",storeCode:""}),t.queryItems.storeCode=""}));case 3:case"end":return a.stop()}}),a)})))()},leafTypeChange:function(e){var t=this;return Object(i["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(e),a.next=3,t._api.spinnerLeafForm({leafTypeCodes:[e]}).then((function(e){t.leafFormList=null===e||void 0===e?void 0:e.rows,t.leafFormList.splice(0,1),t.leafFormList.some((function(e){return"101"===e.leafFormCode&&(t.queryItems.leafFormCode=e.leafFormCode,console.log(t.queryItems.leafFormCode),!0)}))}));case 3:case"end":return a.stop()}}),a)})))()},handlePagination:function(e,t){var a=this;return Object(i["a"])(Object(s["a"])().mark((function r(){return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:a.pagination.pageNumber=e,a.pagination.pageSize=t,a.onQuery();case 3:case"end":return r.stop()}}),r)})))()},handleGetLeafTypeList:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a,r,o,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==(a=e.leafTypeList)&&void 0!==a&&a.length){t.next=9;break}return t.next=3,e.$apis.bpm.executionEnter.queryLeafType({});case 3:r=t.sent,o=(null===r||void 0===r?void 0:r.rows)||[],e.oldLeafTypeList=b.a.cloneDeep(o),o&&o.length>0&&o.unshift({leafTypeName:"全部",leafTypeCode:""}),e.leafTypeList=o,e.leafTypeList.some((function(t){return"烤烟"===t.leafTypeName&&(e.leafTypeCd=t.leafTypeCode,e.queryItems.leafTypeCode=t.leafTypeCode,e.leafTypeName="烤烟",!0)}));case 9:e.queryItems.leafTypeCode||(n=e.leafTypeList[0].leafTypeCode,e.leafTypeCd=n,e.queryItems.leafTypeCode=n,e.leafTypeName=e.leafTypeList[0].leafTypeName);case 10:case"end":return t.stop()}}),t)})))()},onQuery:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a,r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.queryItems.applyOrgCode=e.queryItems.applyOrgCodes.length?e.queryItems.applyOrgCodes.join(""):"",a=Object(n["a"])({applyType:"INVENTORY_CP",pageNo:e.pagination.pageNumber,pageSize:e.pagination.pageSize,applyOrgCode:e.queryItems.applyOrgCodes.length?e.queryItems.applyOrgCodes.join(""):""},e.queryItems),t.next=5,e._api.pageQueryPcTCpApply(a).then((function(t){var a=t.rows||[];e.pagination.total=t.totalRows,e.oldDataRow=JSON.parse(JSON.stringify(a)),e.tableData.rows=a})).catch((function(e){console.log(e)})).finally((function(){e.loading=!1,e.selectedRows=[]}));case 5:return t.next=7,e.$apis.pcm.buy.packApply.queryTotalData(a);case 7:r=t.sent,e.oldTotalData=JSON.parse(JSON.stringify(r));case 9:case"end":return t.stop()}}),t)})))()},onConfirm:function(){var e=this,t=this.$createElement;if(!this.selectedRows||this.selectedRows.length<=0)this.$message.error("请选择一条数据再同意");else{var a=this.selectedRows.find((function(e){return"1"===e.applyState}));a?this.$message.error("存在已确认数据，不能重复确认！"):this.$confirm({title:"是否执行该操作?",content:function(){return t("div",{style:"color:red;"},["是否确认提交选中的数据，确认请点击'确认'按钮，取消点击'取消'按钮。"])},onOk:function(){e.loading=!0;for(var t=[],a=0;a<e.selectedRows.length;a++)t.push(e.selectedRows[a].barcodeApplyId);e.$apis.pcm.buy.packApply.confirm({barcodeApplyIds:t}).then((function(t){console.log(JSON.stringify(t)),t.result?(e.loading=!1,e.$message.success("操作成功"),e.onQuery()):(e.loading=!1,e.$message.error("操作失败"))})).catch((function(t){console.log(t),e.loading=!1}))}})}},onDelete:function(){var e=this,t=this.$createElement;if(!this.selectedRows||this.selectedRows.length<=0)this.$message.error("请选择一条数据再同意");else{var a=this.selectedRows.find((function(e){return"1"===e.applyState}));a?this.$message.error("存在已确认数据，不能删除！"):this.$confirm({title:"是否执行该操作?",content:function(){return t("div",{style:"color:red;"},["是否确认提交选中的数据，确认请点击'确认'按钮，取消点击'取消'按钮。"])},onOk:function(){e.loading=!0;for(var t=[],a=0;a<e.selectedRows.length;a++)t.push(e.selectedRows[a].barcodeApplyId);e._api.deletePcTCpApply({barcodeApplyIds:t}).then((function(t){t.result?(e.loading=!1,e.$message.success("操作成功"),e.onQuery()):(e.loading=!1,e.$message.error("操作失败"))})).catch((function(t){console.log(t),e.loading=!1}))}})}},onAdd:function(){var e=this,t=this.queryItems.tranYear,a={type:"create",tranYear:t,enumMap:this.enumMap,orgInfo:this.orgInfo,oldLeafTypeList:this.oldLeafTypeList,orgCodeList:this.orgCodeList,orgCode:this.orgCode,orgName:this.orgName};this.showEdit=!0,console.log(a),this.$nextTick((function(){e.$refs.BuyApplyEdit.show(a)}))},onEdit:function(e){var t=this,a=this.queryItems.tranYear,r=JSON.parse(JSON.stringify(e)),o={selectedRow:r,tranYear:a,enumMap:this.enumMap,oldLeafTypeList:this.oldLeafTypeList,applyOrgCodes:this.applyOrgCodes,orgCodeList:this.orgCodeList,type:"editor"};console.log(o),this.showEdit=!0,this.$nextTick((function(){t.$refs.BuyApplyEdit.show(o)}))},onReset:function(){this.queryItems.leafTypeCode=this.leafTypeCd,this.queryItems.packType=this.defaultPackType,this.queryItems.storeCode="",this.queryItems.tranYear=(new Date).getFullYear(),this.beforeLeafTypeName=this.handleLeafTypeName(this.leafTypeCd),this.$refs.table.pageAction(1)},handleLeafTypeName:function(e){var t=this.leafTypeList.find((function(t){return t.leafTypeCode===e}));return null===t||void 0===t?void 0:t.leafTypeName},selectAllEvent:function(e){var t=e.checked,a=e.records;console.log("".concat(t,"-选中所有records包含选中的所以对象----").concat(JSON.stringify(a))),this.selectedRows=a},selectRowChange:function(e){var t=e.checked,a=e.records;console.log("".concat(t,"-选择改变时会把records包含选中的所以对象----").concat(JSON.stringify(a))),this.selectedRows=a}}},C=v,w=(a("55b1"),Object(m["a"])(C,r,o,!1,null,"55f0ef40",null));t["default"]=w.exports},"86a2":function(e,t,a){},9523:function(e,t){function a(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}e.exports=a,e.exports.__esModule=!0,e.exports["default"]=e.exports},"9b42":function(e,t,a){function r(e,t){var a=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var r,o,n=[],s=!0,i=!1;try{for(a=a.call(e);!(s=(r=a.next()).done);s=!0)if(n.push(r.value),t&&n.length===t)break}catch(l){i=!0,o=l}finally{try{s||null==a["return"]||a["return"]()}finally{if(i)throw o}}return n}}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports},c135:function(e,t){function a(e){if(Array.isArray(e))return e}e.exports=a,e.exports.__esModule=!0,e.exports["default"]=e.exports},c240:function(e,t,a){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}a("d9e2"),e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports},c973:function(e,t,a){function r(e,t,a,r,o,n,s){try{var i=e[n](s),l=i.value}catch(c){return void a(c)}i.done?t(l):Promise.resolve(l).then(r,o)}function o(e){return function(){var t=this,a=arguments;return new Promise((function(o,n){var s=e.apply(t,a);function i(e){r(s,o,n,i,l,"next",e)}function l(e){r(s,o,n,i,l,"throw",e)}i(void 0)}))}}a("d3b7"),e.exports=o,e.exports.__esModule=!0,e.exports["default"]=e.exports},ded3:function(e,t,a){a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("159b"),a("dbb4");var r=a("9523");function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports}}]);
//# sourceMappingURL=chunk-6aa884f6.ea398f02.js.map