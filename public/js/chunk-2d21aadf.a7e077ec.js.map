{"version":3,"sources":["webpack:///./src/views/apm/base/setting/Index.vue?b8c6","webpack:///src/views/apm/base/setting/Index.vue","webpack:///./src/views/apm/base/setting/Index.vue?7180","webpack:///./src/views/apm/base/setting/Index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","on","$event","$refs","xTable","pageAction","resetHandle","model","value","query","callback","$$v","$set","trim","expression","_l","item","key","id","_v","_s","name","sendHandle","ref","loading","tableData","trigger","mode","checkMethod","checCheckboxkMethod","onQuery","selectAllEvent","selectRowChange","scopedSlots","_u","fn","row","issuedState","onSave","handleRest","staticRenderFns","data","busiYear","orgTypeEk","companyList","appCode","computed","appConfig","created","methods","then","catch","handleGetYear","orgObj","bizCode","yearTypeCode","busiYearObj","bmUnitPlanIds","saveUnitList","component"],"mappings":"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","file":"js/chunk-2d21aadf.a7e077ec.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ec-container',{attrs:{\"height\":\"100%\",\"color-code\":\"001\",\"title\":\"基地单元数量设置\",\"show-title\":\"\",\"icon\":\"com-zhifuguanli\"}},[_c('ec-container-body',[_c('ec-panel',{attrs:{\"auto\":false}},[_c('ec-panel-toolbar',[_c('ec-query-panel',{attrs:{\"defaultFold\":true},on:{\"query\":function($event){return _vm.$refs.xTable.pageAction(1)},\"reset\":_vm.resetHandle}},[_c('ec-query-item',{attrs:{\"label\":\"工/商业\"}},[_c('ec-select',{attrs:{\"showSearch\":\"\",\"allowClear\":\"\",\"placeholder\":\"商业公司\"},model:{value:(_vm.query.orgTypeEk),callback:function ($$v) {_vm.$set(_vm.query, \"orgTypeEk\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"query.orgTypeEk\"}},_vm._l((_vm.companyList),function(item){return _c('a-select-option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(\" \"+_vm._s(item.name)+\" \")])}),1)],1),_c('ec-query-item',{attrs:{\"label\":\"集中交易年度\"}},[_c('a-input-number',{attrs:{\"disabled\":\"\"},on:{\"change\":function($event){return _vm.$refs.xTable.pageAction(1)}},model:{value:(_vm.query.busiYear),callback:function ($$v) {_vm.$set(_vm.query, \"busiYear\", $$v)},expression:\"query.busiYear\"}})],1)],1),_c('ec-divider')],1),_c('ec-panel-body',[_c('ec-v-layout',{attrs:{\"auto\":false}},[_c('ec-v-item',{attrs:{\"height\":\"auto\"}},[_c('ec-panel-toolbar',[_c('ec-panel-item-left',[_c('a-button',{attrs:{\"type\":\"primary\",\"ghost\":\"\"},on:{\"click\":_vm.sendHandle}},[_vm._v(\"下发\")])],1)],1)],1),_c('ec-v-item',[_c('ec-table',{ref:\"xTable\",attrs:{\"height\":\"100%\",\"show-overflow\":\"\",\"auto\":false,\"loading\":_vm.loading,\"data\":_vm.tableData,\"edit-config\":{ trigger: 'click', mode: 'row' },\"checkbox-config\":{ checkMethod: _vm.checCheckboxkMethod },\"row-select\":\"\"},on:{\"page-action\":_vm.onQuery,\"checkbox-all\":_vm.selectAllEvent,\"checkbox-change\":_vm.selectRowChange}},[_c('ec-table-col',{attrs:{\"type\":\"checkbox\",\"width\":\"60\",\"align\":\"center\"}}),_c('ec-table-col',{attrs:{\"type\":\"seq\",\"title\":\"序号\",\"width\":\"50\",\"align\":\"center\"}}),_c('ec-table-col',{attrs:{\"field\":\"orgName\",\"title\":\"单位名称\",\"align\":\"center\"}}),_c('ec-table-col',{attrs:{\"field\":\"baseUnitCnt\",\"title\":\"新建单元数量\",\"align\":\"center\",\"edit-render\":{}},scopedSlots:_vm._u([{key:\"edit\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('a-input',{model:{value:(row.baseUnitCnt),callback:function ($$v) {_vm.$set(row, \"baseUnitCnt\", $$v)},expression:\"row.baseUnitCnt\"}})]}}])}),_c('ec-table-col',{attrs:{\"field\":\"remark\",\"title\":\"办理依据\",\"align\":\"center\",\"edit-render\":{}},scopedSlots:_vm._u([{key:\"edit\",fn:function(ref){\nvar row = ref.row;\nreturn [_c('a-input',{model:{value:(row.remark),callback:function ($$v) {_vm.$set(row, \"remark\", $$v)},expression:\"row.remark\"}})]}}])}),_c('ec-table-col',{attrs:{\"field\":\"issuedState\",\"title\":\"下发状态\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar row = ref.row;\nreturn [_vm._v(\" \"+_vm._s(row.issuedState == 0 ? '未下发' : '已下发')+\" \")]}}])})],1)],1)],1)],1)],1)],1),_c('ec-container-footer',[_c('a-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSave}},[_vm._v(\"保存\")]),_c('a-button',{on:{\"click\":_vm.handleRest}},[_vm._v(\"重置\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <ec-container\r\n    height=\"100%\"\r\n    color-code=\"001\"\r\n    title=\"基地单元数量设置\"\r\n    show-title\r\n    icon=\"com-zhifuguanli\"\r\n  >\r\n    <ec-container-body>\r\n      <ec-panel :auto=\"false\">\r\n        <ec-panel-toolbar>\r\n          <ec-query-panel\r\n            :defaultFold=\"true\"\r\n            @query=\"$refs.xTable.pageAction(1)\"\r\n            @reset=\"resetHandle\"\r\n          >\r\n            <ec-query-item label=\"工/商业\">\r\n              <ec-select\r\n                showSearch\r\n                allowClear\r\n                placeholder=\"商业公司\"\r\n                v-model.trim=\"query.orgTypeEk\"\r\n              >\r\n                <a-select-option v-for=\"item in companyList\" :key=\"item.id\" :value=\"item.id\">\r\n                  {{ item.name }}\r\n                </a-select-option>\r\n              </ec-select>\r\n            </ec-query-item>\r\n            <ec-query-item label=\"集中交易年度\">\r\n              <a-input-number\r\n                v-model=\"query.busiYear\"\r\n                @change=\"$refs.xTable.pageAction(1)\"\r\n                disabled\r\n              />\r\n            </ec-query-item>\r\n          </ec-query-panel>\r\n          <ec-divider />\r\n        </ec-panel-toolbar>\r\n        <ec-panel-body>\r\n          <ec-v-layout :auto=\"false\">\r\n            <!-- 表格工具栏 -->\r\n            <ec-v-item height=\"auto\">\r\n              <ec-panel-toolbar>\r\n                <ec-panel-item-left>\r\n                  <a-button type=\"primary\" ghost @click=\"sendHandle\">下发</a-button>\r\n                </ec-panel-item-left>\r\n              </ec-panel-toolbar>\r\n            </ec-v-item>\r\n            <!-- 列表 -->\r\n            <ec-v-item>\r\n              <ec-table\r\n                ref=\"xTable\"\r\n                height=\"100%\"\r\n                show-overflow\r\n                :auto=\"false\"\r\n                :loading=\"loading\"\r\n                :data=\"tableData\"\r\n                @page-action=\"onQuery\"\r\n                :edit-config=\"{ trigger: 'click', mode: 'row' }\"\r\n                :checkbox-config=\"{ checkMethod: checCheckboxkMethod }\"\r\n                @checkbox-all=\"selectAllEvent\"\r\n                @checkbox-change=\"selectRowChange\"\r\n                row-select\r\n              >\r\n                <ec-table-col type=\"checkbox\" width=\"60\" align=\"center\"></ec-table-col>\r\n                <!-- width 设置当前列的宽度 sortable 是否可排序 -->\r\n                <ec-table-col type=\"seq\" title=\"序号\" width=\"50\" align=\"center\" />\r\n                <ec-table-col field=\"orgName\" title=\"单位名称\" align=\"center\" />\r\n                <ec-table-col\r\n                  field=\"baseUnitCnt\"\r\n                  title=\"新建单元数量\"\r\n                  align=\"center\"\r\n                  :edit-render=\"{}\"\r\n                >\r\n                  <template #edit=\"{ row }\">\r\n                    <a-input v-model=\"row.baseUnitCnt\"></a-input>\r\n                  </template>\r\n                </ec-table-col>\r\n                <ec-table-col field=\"remark\" title=\"办理依据\" align=\"center\" :edit-render=\"{}\">\r\n                  <template #edit=\"{ row }\">\r\n                    <a-input v-model=\"row.remark\"></a-input>\r\n                  </template>\r\n                </ec-table-col>\r\n                <ec-table-col field=\"issuedState\" title=\"下发状态\" align=\"center\">\r\n                  <template #default=\"{ row }\">\r\n                    {{ row.issuedState == 0 ? '未下发' : '已下发' }}\r\n                  </template>\r\n                </ec-table-col>\r\n              </ec-table>\r\n            </ec-v-item>\r\n          </ec-v-layout>\r\n        </ec-panel-body>\r\n      </ec-panel>\r\n    </ec-container-body>\r\n    <ec-container-footer>\r\n      <a-button type=\"primary\" @click=\"onSave\">保存</a-button>\r\n      <a-button @click=\"handleRest\">重置</a-button>\r\n    </ec-container-footer>\r\n  </ec-container>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'PanelSupple',\r\n  data() {\r\n    return {\r\n      query: {\r\n        busiYear: '',\r\n        orgTypeEk: 'TOBACCO',\r\n      }, // 查询数据\r\n      // 工/商业\r\n      companyList: [\r\n        { name: '商业公司', id: 'TOBACCO' },\r\n        { name: '工业公司', id: 'INDUSTRY' },\r\n      ],\r\n      tableData: [], // 表格数据\r\n      loading: false,\r\n      // 应用编码\r\n      appCode: undefined,\r\n      // 集中交易年度\r\n      busiYear: 0,\r\n    };\r\n  },\r\n  computed: {\r\n    // 应用配置\r\n    appConfig() {\r\n      return this.$store.getters.getAppConfig;\r\n    },\r\n  },\r\n\r\n  async created() {\r\n    // 通过路由获取appCode\r\n    const { appCode } = this.$router.history.current.query;\r\n    this.appCode = appCode || 'CM';\r\n\r\n    await this.handleGetYear();\r\n  },\r\n  methods: {\r\n    // 数据初始化/查询\r\n    onQuery() {\r\n      this.loading = true;\r\n      this.$apis.apm.baseSetting\r\n        .query(this.query)\r\n        .then((res) => {\r\n          this.tableData = res.rows;\r\n          this.loading = false;\r\n        })\r\n        .catch(() => {\r\n          this.loading = false;\r\n        });\r\n    },\r\n\r\n    // 获取业务年度\r\n    async handleGetYear() {\r\n      const orgObj = await this.$apis.common.user.get({});\r\n      // 获取年度\r\n      const data = {\r\n        bizCode: orgObj.orgCode,\r\n        yearTypeCode: 'CENTER_YEAR',\r\n        appCode: this.appCode,\r\n      };\r\n      const busiYearObj = await this.$apis.apm.baseSetting.getBuYear(data);\r\n      this.query.busiYear = busiYearObj.yearValue;\r\n      this.busiYear = busiYearObj.yearValue;\r\n      this.$refs.xTable.pageAction(1);\r\n    },\r\n\r\n    // 重置\r\n    resetHandle() {\r\n      this.query.orgTypeEk = 'TOBACCO';\r\n      this.$refs.xTable.pageAction(1);\r\n    },\r\n    // 下发\r\n    sendHandle() {\r\n      if (!this.selectedRows || this.selectedRows.length <= 0) {\r\n        this.$message.error('请选择一条数据再下发');\r\n        return;\r\n      }\r\n      const selectList = this.selectedRows.map((item) => {\r\n        return item.bmUnitPlanId;\r\n      });\r\n      if (selectList.some((item) => item === '')) {\r\n        this.$message.warning('暂无符合下发条件！');\r\n      } else {\r\n        const params = {\r\n          bmUnitPlanIds: selectList,\r\n        };\r\n        this.$apis.apm.baseSetting.send(params).then((res) => {\r\n          if (res.result === true) {\r\n            this.$message.success('下发成功！');\r\n            this.$refs.xTable.pageAction(1);\r\n          }\r\n        });\r\n      }\r\n    },\r\n    checCheckboxkMethod({ row }) {\r\n      return row.issuedState === '0';\r\n    },\r\n    // 保存\r\n    onSave() {\r\n      const params = {\r\n        busiYear: this.busiYear,\r\n        saveUnitList: this.tableData,\r\n      };\r\n      this.$apis.apm.baseSetting.save(params).then((res) => {\r\n        if (res.result === true) {\r\n          this.$message.success('保存成功！');\r\n          this.$refs.xTable.pageAction(1);\r\n        }\r\n      });\r\n    },\r\n    // 取消\r\n    handleRest() {\r\n      this.$refs.xTable.pageAction(1);\r\n    },\r\n    // 选中所有列表\r\n    selectAllEvent({ records }) {\r\n      this.selectedRows = records;\r\n    },\r\n    // 选中列表\r\n    selectRowChange({ records }) {\r\n      this.selectedRows = records;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped></style>\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=4fb4b90e&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4fb4b90e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}