(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e9134f2"],{5530:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("b64b"),a("a4d3"),a("4de4"),a("d3b7"),a("e439"),a("159b"),a("dbb4");function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}},f7c1:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ec-container",{attrs:{height:"100%",title:"审核流程配置",icon:"onetomany","color-code":"001"}},[a("ec-container-body",[a("ec-panel",{attrs:{auto:!1}},[a("ec-panel-toolbar",[a("ec-panel-item",[a("ec-query-panel",{attrs:{defaultFold:""},on:{query:e.getTableData,reset:e.onReset},scopedSlots:e._u([{key:"inner",fn:function(){return[a("ec-query-item",{attrs:{label:"状态"}},[a("ec-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.queryItems.specState,callback:function(t){e.$set(e.queryItems,"specState",t)},expression:"queryItems.specState"}},e._l(e.statusList,(function(t){return a("a-select-option",{key:t.value},[e._v(e._s(t.label))])})),1)],1)]},proxy:!0}])},[a("ec-query-item",{attrs:{label:"业务类型"}},[a("a-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.queryItems.busiTypeCode,callback:function(t){e.$set(e.queryItems,"busiTypeCode",t)},expression:"queryItems.busiTypeCode"}},e._l(e.busiTypeCodeList,(function(t){return a("a-select-option",{key:t.id},[e._v(e._s(t.label))])})),1)],1),a("ec-query-item",{attrs:{label:"流程类型"}},[a("a-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.queryItems.processType,callback:function(t){e.$set(e.queryItems,"processType",t)},expression:"queryItems.processType"}},e._l(e.ProcessTypeList,(function(t){return a("a-select-option",{key:t.id},[e._v(e._s(t.label))])})),1)],1),a("ec-query-item",{attrs:{label:"角色名称"}},[a("ec-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.queryItems.roleName,callback:function(t){e.$set(e.queryItems,"roleName",t)},expression:"queryItems.roleName"}},e._l(e.packagesTypes,(function(t){return a("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1)],1)],1),a("ec-panel-toolbar",[a("ec-panel-item-left",[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleOpen("add",{})}}},[e._v("新增")]),a("a-button",{attrs:{loading:e.appearLoading},on:{click:function(t){return e.handleUpdateStatus(1)}}},[e._v("启用")]),a("a-button",{attrs:{loading:e.appearLoading},on:{click:function(t){return e.handleUpdateStatus(0)}}},[e._v("停用")])],1)],1),a("ec-panel-body",[a("ec-table",{ref:"table",attrs:{height:"100%","show-overflow":"","header-align":"center",align:"center","cell-style":e.cellStyle,auto:!1,loading:e.loading,data:e.tableData,pagination:e.queryItems},on:{"page-action":e.handlePagination,"checkbox-all":e.onSelTableData,"checkbox-change":e.onSelTableData}},[a("ec-table-col",{attrs:{width:"80",type:"checkbox",align:"center"}}),a("ec-table-col",{attrs:{title:"序号",width:"80",type:"seq",align:"center"}}),a("ec-table-col",{attrs:{title:"流程编码",field:"processCode"}}),a("ec-table-col",{attrs:{title:"角色代码",field:"roleCode"}}),a("ec-table-col",{attrs:{title:"角色名称",field:"roleName"}}),a("ec-table-col",{attrs:{title:"流程状态值",field:"processStateCode"}}),a("ec-table-col",{attrs:{title:"流程类型",field:"processType"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getbusiTypeCodeLabel(e.ProcessTypeList,a.processType))+" ")]}}])}),a("ec-table-col",{attrs:{title:"业务类型",field:"busiTypeCode"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getbusiTypeCodeLabel(e.busiTypeCodeList,a.busiTypeCode))+" ")]}}])}),a("ec-table-col",{attrs:{title:"下一个流程编码",field:"nextProcessCode"}}),a("ec-table-col",{attrs:{title:"结束状态值",field:"endStateCode"}}),a("ec-table-col",{attrs:{title:"启用状态",field:"enableFlag"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s("1"===a.enableFlag?"已启用":"0"===a.enableFlag?"未启用":"")+" ")]}}])}),a("ec-table-col",{attrs:{title:"操作",field:"priceTagName",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("a-button",{attrs:{disabled:"1"===o.enableFlag,type:"link"},on:{click:function(t){return e.handleOpen("edit",o)}}},[e._v("编辑")]),a("a-button",{attrs:{type:"link"},on:{click:function(t){return e.handleOpen("view",o)}}},[e._v("详细")])]}}])})],1)],1)],1),a("FormModel",{ref:"formRef",attrs:{busiYear:e.busiYear},on:{submitOK:e.getTableData}})],1)],1)},l=[],r=(a("d3b7"),a("a15b"),a("d81d"),a("7db0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ec-drawer",{attrs:{visible:e.visible,size:"large",title:"add"===e.curType?"新增":"edit"===e.curType?"编辑":"详情","is-confirm":!0},on:{close:e.onClose}},[a("ec-container",{attrs:{height:"auto",fixed:"top bottom","color-code":"007"}},[a("ec-container-body",[a("ec-panel",{attrs:{"color-code":"001"}},[a("ec-panel-item",[a("ec-form",{ref:"formRef",attrs:{model:e.formData,rules:e.formRules}},[a("a-row",{attrs:{type:"flex",gutter:12}},[a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"业务类型",prop:"busiTypeCode"}},[a("a-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.formData.busiTypeCode,callback:function(t){e.$set(e.formData,"busiTypeCode",t)},expression:"formData.busiTypeCode"}},e._l(e.busiTypeCodeList,(function(t){return a("a-select-option",{key:t.id},[e._v(e._s(t.label))])})),1)],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"流程编码",prop:"processCode"}},[a("a-input",{model:{value:e.formData.processCode,callback:function(t){e.$set(e.formData,"processCode",t)},expression:"formData.processCode"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"角色编码",prop:"roleCode"}},[a("a-input",{model:{value:e.formData.roleCode,callback:function(t){e.$set(e.formData,"roleCode",t)},expression:"formData.roleCode"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("a-input",{model:{value:e.formData.roleName,callback:function(t){e.$set(e.formData,"roleName",t)},expression:"formData.roleName"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"流程类型",prop:"processType"}},[a("a-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.formData.processType,callback:function(t){e.$set(e.formData,"processType",t)},expression:"formData.processType"}},e._l(e.ProcessTypeList,(function(t){return a("a-select-option",{key:t.id},[e._v(e._s(t.label))])})),1)],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"流程状态值",prop:"processStateCode"}},[a("a-input",{model:{value:e.formData.processStateCode,callback:function(t){e.$set(e.formData,"processStateCode",t)},expression:"formData.processStateCode"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"下个流程",prop:"nextProcessCode"}},[a("a-input",{model:{value:e.formData.nextProcessCode,callback:function(t){e.$set(e.formData,"nextProcessCode",t)},expression:"formData.nextProcessCode"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"结束状态值",prop:"endStateCode"}},[a("a-input",{model:{value:e.formData.endStateCode,callback:function(t){e.$set(e.formData,"endStateCode",t)},expression:"formData.endStateCode"}})],1)],1),a("a-col",{attrs:{span:8}},[a("a-form-model-item",{attrs:{label:"流程顺序",prop:"dispNo"}},[a("a-input",{model:{value:e.formData.dispNo,callback:function(t){e.$set(e.formData,"dispNo",t)},expression:"formData.dispNo"}})],1)],1)],1)],1)],1)],1)],1),a("ec-container-footer",{attrs:{fixed:""}},[a("a-space",["view"!==e.curType?a("a-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.handleSumbit}},[e._v("保存")]):e._e(),a("a-button",{on:{click:e.onClose}},[e._v("关闭")])],1)],1)],1)],1)],1)}),s=[],n=a("5530"),i=(a("a9e3"),a("4de4"),{name:"formmodel",props:{busiYear:{type:Number,default:2022}},data:function(){return{curType:null,visible:!1,saveLoading:!1,formData:{processType:"",busiTypeCode:"",processCode:"",roleCode:"",roleName:"",processStateCode:"",nextProcessCode:"",endStateCode:"",dispNo:""},formRules:{processCode:{required:!0,message:"请输入流程编码"},roleCode:{required:!0,message:"请输入角色编码"},roleName:{required:!0,message:"请输入角色名称"},processType:{required:!0,message:"请选择流程类型"},processStateCode:{required:!0,message:"请输入流程状态值"},busiTypeCode:{required:!0,message:"请选择业务类型"}},ProcessTypeList:[{id:"1",label:"开始节点"},{id:"-1",label:"结束节点"},{id:"2",label:"过程节点"}],busiTypeCodeList:[{id:"1",label:"日常交易省级审核流程"},{id:"2",label:"日常交易国家局审核流程"}]}},computed:{_api:function(){return this.$apis.apm.dailyFlowSetting}},methods:{show:function(e,t){"add"!==e&&Object.assign(this.formData,t),this.curType=e,this.visible=!0},handleSumbit:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){e.saveLoading=!0,$ec.showLoading();var a=Object(n["a"])({},e.formData);a.busiYear=e.busiYear,e._api.Add(a).then((function(t){var a=t.result,o="add"===e.curType?"新增成功":"编辑成功";a?(e.$message.success("".concat(o,"成功")),e.$emit("submitOK"),e.onClose()):e.$message.error("操作失败")})).finally((function(){e.saveLoading=!1,$ec.hideLoading()}))}}))},orgChange:function(e){var t=e.selectOption.title;this.formData.applyOrgName=t},onClose:function(){this.formData={},this.$refs.formRef.resetFields(),this.visible=!1},querygetBusinessType:function(){var e=this;this.$apis.common.index.queryContType({contTypeCode:"2"}).then((function(t){var a=t.rows;e.apprTypeCodeListed=a,e.apprTypeCodeList=e.getTree(a,"higherContTypeCode","contTypeCode","contTypeName","children","0")}))},getTree:function(e,t,a,o,l,r){console.time();var s=function e(r,s){return r.filter((function(n){return n[t]===s&&((n.value=n[a])(n.label=n[o])(n[l]=e(r,n[a])),!0)}))},n=s(e,r);return console.timeEnd(),n}}}),c=i,d=a("2877"),u=Object(d["a"])(c,r,s,!1,null,"e3741332",null),p=u.exports,f={name:"MaterialApply",components:{FormModel:p},data:function(){return{selectData:[],ProcessTypeList:[{id:"1",label:"开始节点"},{id:"-1",label:"结束节点"},{id:"2",label:"过程节点"}],busiTypeCodeList:[{id:"1",label:"日常交易省级审核流程"},{id:"2",label:"日常交易国家局审核流程"}],packagesTypes:[{label:"省经办人",value:"1"},{label:"省业务复核",value:"2"},{label:"省业务主管",value:"3"},{label:"省分管副总",value:"4"},{label:"省总经理",value:"5"},{label:"中国烟叶公司经办人",value:"6"},{label:"中国烟叶公司业务复核",value:"7"},{label:"中国烟叶公司业务主管",value:"8"},{label:"中国烟叶公司分管副总",value:"9"},{label:"中国烟叶公司总经理",value:"10"}],statusList:[{label:"已上报",value:"1"},{label:"已退回",value:"2"},{label:"未上报",value:"0"}],mouldTypeList:[{name:"模板类型1",id:"1"},{name:"模板类型2",id:"2"}],appearLoading:!1,saveLoading:!1,deleteLoading:!1,usingLoading:!1,visible:!1,loading:!1,formData:{},tableData:[],total:0,queryItems:{total:0,applyOrgCd:void 0,mouldName:void 0,mouldType:void 0,pageSize:10,pageNo:1}}},computed:{bizCode:function(){return this.$store.getters.getAppConfig.bizCode},busiYear:function(){var e,t;return null===(e=this.$store.getters.getAppConfig)||void 0===e||null===(t=e.yearValueMap)||void 0===t?void 0:t.DAILY_YEAR},_api:function(){return this.$apis.apm.dailyFlowSetting}},methods:{handlePagination:function(e,t){this.queryItems.pageNo=e,this.queryItems.pageSize=t,this.getTableData()},onReset:function(){this.selectData=[],this.queryItems={total:0,pageNo:1,pageSize:10,busiTypeCode:void 0,processType:void 0,roleName:void 0,specState:void 0},this.handlePagination()},getTableData:function(){var e=this;this.selectData=[],this.loading=!0;var t=Object.assign({},this.queryItems);this._api.query(t).then((function(t){e.tableData=null===t||void 0===t?void 0:t.rows,e.queryItems.total=null===t||void 0===t?void 0:t.totalRows})).finally((function(){e.loading=!1}))},handleUpdateStatus:function(e){var t=this,a=this.$createElement;if(!this.selectData.length)return this.$message.error("请先选择数据");var o=1===e?"启用":"停用";this.$confirm({title:"是否执行该操作?",content:function(){return a("div",{style:"color:red;"},["是否确认",o,"选中的数据，确认请点击'确认'按钮，取消点击'取消'按钮。"])},onOk:function(){var a;t.appearLoading=!0,$ec.showLoading();var o=null===(a=t.selectData)||void 0===a?void 0:a.map((function(e){return e.dtAuditProcessId})).join(""),l={dtAuditProcessIds:o,enableFlag:e};t._api.UpdateStatus(l).then((function(e){var a=e.result;a?(t.$message.error("操作成功"),t.selectData=[],t.handlePagination()):t.$message.error("操作失败")})).finally((function(){t.appearLoading=!1,$ec.hideLoading()}))}})},handleOpen:function(e,t){var a=this,o=t.dtAuditProcessId;"add"!==e?this._api.queryAlone({dtAuditProcessId:o}).then((function(t){a.$refs.formRef.show(e,t)})):this.$refs.formRef.show(e,{})},onSelTableData:function(e){var t=e.records;this.selectData=t},getbusiTypeCodeLabel:function(e,t){var a;return(null===e||void 0===e||null===(a=e.find((function(e){return e.id===t})))||void 0===a?void 0:a.label)||""},cellStyle:function(e){var t=e.$columnIndex;if(2===t||3===t||4===t||7===t)return{textAlign:"left"}}}},b=f,m=Object(d["a"])(b,o,l,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-5e9134f2.3ebcd698.js.map